{"remainingRequest":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/cf_web/src/views/data-base/purchaseWarehousingTable/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/cf_web/src/views/data-base/purchaseWarehousingTable/index.vue","mtime":1600927611461},{"path":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport * as api from \"@/api/data-base/purchaseWarehousingTable\";\nimport Pagination from \"@/components/Pagination\";\nimport { mapState } from \"vuex\";\nimport mobileTypeSelection from \"./mobileTypeSelection\";\nexport default {\n    name: \"purchaseWarehousingTable\",\n    components: { Pagination, mobileTypeSelection },\n    data () {\n        return {\n            list: null,\n            total: 0,\n            theight: 0,//表格高度\n            listQuery: {\n                page: true,\n                currentPage: 1,\n                pageSize: 15,\n                qcType: undefined\n            },\n            temp: {\n                qcClass: undefined,\n                qcType: undefined,\n                qcClassName: undefined,\n                qcTypeName: undefined,\n                qualified: undefined,\n                fixQualified: undefined,\n                unqualifiedReturn: undefined,\n                compromiseRetain: undefined,\n                downgradeRetain: undefined\n            },\n            isEaid: false,\n            mtsDialogFormVisible: false,\n            mtsDialogFormVisible1: false,\n            mtsDialogFormVisible2: false,\n            mtsDialogFormVisible3: false,\n            mtsDialogFormVisible4: false,\n            dialogFormVisible: false,\n            dialogStatus: \"\",\n            tableKey: 0,\n            rules: {\n                qcClass: [{ required: true, message: \"质检类型不能为空\", trigger: \"blur\" }],\n                qcType: [{ required: true, message: \"质检类型不能为空\", trigger: \"blur\" }],\n                qualified: [{ required: true, message: \"质检类型不能为空\", trigger: \"blur\" }],\n                fixQualified: [{ required: true, message: \"质检类型不能为空\", trigger: \"blur\" }],\n                unqualifiedReturn: [{ required: true, message: \"质检类型不能为空\", trigger: \"blur\" }],\n                compromiseRetain: [{ required: true, message: \"质检类型不能为空\", trigger: \"blur\" }],\n                downgradeRetain: [{ required: true, message: \"质检类型不能为空\", trigger: \"blur\" }]\n            }\n        };\n    },\n    computed: {\n        ...mapState({\n            dt_quality_inspection_type: state => state.dict.dt_quality_inspection_type,\n            dt_quality_nspection_category: state => state.dict.dt_quality_nspection_category\n        })\n    },\n    mounted () {\n        this.$store.dispatch(\"dict/getDicData\", [\"dt_quality_inspection_type\", \"dt_quality_nspection_category\"]);\n        this.setTableHeight();\n        //表格高度自适应\n        window.onresize = () => {\n            this.setTableHeight()\n        };\n        this.getList();\n    },\n    methods: {\n        getList () {\n            api.queryRecords(this.listQuery).then(res => {\n                this.list = res.data.list;\n                this.total = res.data.pages.count;\n            });\n        },\n        //表格高度计算\n        setTableHeight () {\n            this.theight = this.$myFun.getSingleTbHeight();\n        },\n        handleQuery () {//查询\n            this.listQuery.currentPage = 1;\n            this.getList();\n        },\n        handleCreate () {//新增\n            this.resetTemp();\n            this.dialogStatus = \"create\";\n            this.dialogFormVisible = true;\n        },\n        selectRow (val) {\n            this.selectlistRow = val;\n        },\n        handleClickmts () {\n            this.mtsDialogFormVisible = true;\n        },\n        handleClickmts1 () {\n            this.mtsDialogFormVisible1 = true;\n        },\n        handleClickmts2 () {\n            this.mtsDialogFormVisible2 = true;\n        },\n        handleClickmts3 () {\n            this.mtsDialogFormVisible3 = true;\n        },\n        handleClickmts4 () {\n            this.mtsDialogFormVisible4 = true;\n        },\n        handleDblclickmts (row) {\n            this.parentsRows = row;\n\n        },\n\n\n        //合格弹窗确认\n        update () {\n            if (this.parentsRows.length && this.parentsRows.length == 1) {\n                this.temp.qualifiedName = this.parentsRows[0].wareRuleName;\n                this.temp.qualified = this.parentsRows[0].wareRuleCode;\n                this.mtsDialogFormVisible = false;\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        //返修合格确认\n        update1 () {\n            if (this.parentsRows.length && this.parentsRows.length == 1) {\n                this.temp.fixQualifiedName = this.parentsRows[0].wareRuleName;\n                this.temp.fixQualified = this.parentsRows[0].wareRuleCode;\n                this.mtsDialogFormVisible1 = false;\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        //不合格退回确认\n        update2 () {\n            if (this.parentsRows.length && this.parentsRows.length == 1) {\n                this.temp.unqualifiedReturnName = this.parentsRows[0].wareRuleName;\n                this.temp.unqualifiedReturn = this.parentsRows[0].wareRuleCode;\n                this.mtsDialogFormVisible2 = false;\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        //让步留用确认\n        update3 () {\n            if (this.parentsRows.length && this.parentsRows.length == 1) {\n                this.temp.compromiseRetainName = this.parentsRows[0].wareRuleName;\n                this.temp.compromiseRetain = this.parentsRows[0].wareRuleCode;\n                this.mtsDialogFormVisible3 = false;\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        //降级留用确认\n        update4 () {\n            if (this.parentsRows.length && this.parentsRows.length == 1) {\n                this.temp.downgradeRetainName = this.parentsRows[0].wareRuleName;\n                this.temp.downgradeRetain = this.parentsRows[0].wareRuleCode;\n                this.mtsDialogFormVisible4 = false;\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        //修改确认\n        handleModify () {\n            if (this.selectlistRow && this.selectlistRow.length == 1) {\n                this.isEaid = true;\n                this.temp = this.selectlistRow[0];\n                this.dialogStatus = \"modify\";\n                this.dialogFormVisible = true;\n                this.$nextTick(() => {\n                    this.$refs[\"temp\"].clearValidate();\n                });\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n\n        },\n        //修改确认按钮\n        modify () {\n            this.$refs[\"temp\"].validate(valid => {\n                if (valid) {\n                    api.updateRecord(this.temp).then(() => {\n                        this.getList();\n                        this.dialogFormVisible = false;\n                        this.$message({\n                            title: \"成功\",\n                            message: \"更新成功\",\n                            type: \"success\",\n                            duration: 2000\n                        });\n                    });\n                }\n            });\n\n        },\n        handleDelete () { //删除列表\n            if (this.selectlistRow && this.selectlistRow.length == 1) {\n                this.$confirm(\"此操作将删除所选中数据, 是否继续?\", \"提示\", {\n                    confirmButtonText: \"确定\",\n                    cancelButtonText: \"取消\",\n                    type: \"warning\"\n                }).then(() => {\n                    let ids = [];\n                    this.selectlistRow.forEach((val, index) => {\n                        ids[index] = val.rowId;\n                    });\n                    api.deleteRecord(ids).then(() => {\n                        this.getList(),\n                            this.$message({\n                                title: \"成功\",\n                                message: \"删除成功\",\n                                type: \"success\",\n                                duration: 2000\n                            });\n                    });\n                }).catch(() => {\n                    this.$message({\n                        type: \"info\",\n                        message: \"已取消删除\"\n                    });\n                });\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        //新增确认按钮\n        create () {\n            this.$refs.temp.validate(valid => {\n                if (valid) {\n                    api.addRecord(this.temp).then(() => {\n                        this.getList();\n                        this.dialogFormVisible = false;\n                        this.$message({\n                            title: \"成功\",\n                            message: \"新增成功\",\n                            type: \"success\",\n                            duration: 2000\n                        });\n                    });\n                } else {\n                    return false;\n                }\n            });\n\n        },\n        cancel () {//取消弹窗按钮\n            this.dialogFormVisible = false;\n        },\n        resetTemp () {\n            this.temp = {\n                qcClass: undefined,\n                qcType: undefined,\n                qcClassName: undefined,\n                qcTypeName: undefined,\n                qualified: undefined,\n                fixQualified: undefined,\n                unqualifiedReturn: undefined,\n                compromiseRetain: undefined,\n                downgradeRetain: undefined\n            };\n        },\n        handleClose () {\n            this.resetTemp();\n            this.$refs.temp.resetFields();\n        }\n    }\n};\n",null]}