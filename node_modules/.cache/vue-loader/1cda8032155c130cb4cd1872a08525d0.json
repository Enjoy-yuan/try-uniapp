{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/WMS/purchaseStorage/noIndicatorStorage/content/contentProof.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/WMS/purchaseStorage/noIndicatorStorage/content/contentProof.vue","mtime":1596610934166},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport * as api from '@/api/project/wms/purchaseStorage/purchaseReceiving'\nimport { mapState } from 'vuex'\nimport caiGou from '@/components/Select/caigou.vue'//下拉组件\nimport Pagination from \"@/components/Pagination\"\nimport warehouseSelect from '@/components/Select/warehouse-select.vue'//下拉组件\nimport { DT_ORG_TYPE } from '@/utils/constant'\nimport { selectlists } from '@/api/system/organization'\n\nexport default {\n    name: \"Hand_pulled_material\",\n    components: { Pagination, warehouseSelect, caiGou },\n    data () {\n        return {\n            theight: 0,\n            sheight: 0,\n            tableKey: 0,\n            isSingle: true,//表格是否单选 点击各按钮根据流程逻辑控制单多选\n            list_b: [],\n            total_b: 0,\n            releaseDateStart: [this.timeFormat(), this.timeFormat()],\n            listQuery_b: {\n                currentPage: 1,\n                pageSize: 1000,\n\n            },\n            list_b_1: [],\n            total_b_1: 0,\n            listQuery_b_1: {\n                currentPage: 1,\n                pageSize: 15,\n            },\n            parentsRows: undefined,\n            DT_ORG_TYPE: DT_ORG_TYPE,\n        }\n    },\n    computed: {\n        ...mapState({\n            dt_materiel_transfer_type_screenGroupNum_SH2: state => state.businessComponent.dt_materiel_transfer_type_screenGroupNum_SH2,\n        })\n    },\n    mounted () {\n        this.setTableHeight()\n        //表格高度自适应\n        window.onresize = () => {\n            this.setTableHeight()\n        }\n        this.$store.dispatch('businessComponent/getBusinessComponentData', ['dt_materiel_transfer_type_screenGroupNum'])\n    },\n    methods: {\n        //表格高度计算\n        setTableHeight () {\n            this.theight = this.$myFun.getSingleTbHeight()\n            this.sheight = this.$myFun.getSingleTbHeight() - 65\n        },\n        timeFormat () {\n            var d = new Date()\n            var year = d.getFullYear()       //年  \n            var month = d.getMonth() + 1     //月  \n            var day = d.getDate()            //日  \n\n            var clock = year + \"-\"\n            if (month < 10)\n                clock += \"0\"\n            clock += month + \"-\"\n\n            if (day < 10)\n                clock += \"0\"\n            clock += day\n            return (clock)\n        },\n        handleQuery () {\n            this.$emit('getData')\n        },\n        getList_b (row) {//收货凭证主表查询\n            this.listQuery_b.orgCode = row.orgCode\n            this.listQuery_b.warehouseCode = row.warehouseCode\n            this.listQuery_b.businessType = row.businessType\n            if (this.releaseDateStart) {\n                this.listQuery_b.createDateStart = this.releaseDateStart[0]\n                this.listQuery_b.createDateEnd = this.releaseDateStart[1]\n            } else {\n                this.listQuery_b.createDateStart = \"\"\n                this.listQuery_b.createDateEnd = \"\"\n            }\n            api.getData_b(this.listQuery_b).then(res => {\n                this.list_b = res.data.list\n                this.total_b = res.data.pages.count\n            })\n        },\n        getList_b_1 (val) {//收货凭证从表查询\n            this.listQuery_b_1.receiveOrderNumber = val.receiveOrderNumber\n            this.listQuery_b_1.businessType = val.businessType\n            selectlists().then(response => {\n                api.getData_b_1(this.listQuery_b_1).then(res => {\n                    res.data.list.forEach((item, index) => {\n                        response.data.forEach((option) => {\n                            if (option.organizationCode == item['orgCode']) {\n                                res.data.list[index]['orgName'] = option.organizationName\n                            }\n                        })\n                    })\n                    this.list_b_1 = res.data.list.map(v => {\n                        for (const key in val) {\n                            if (val.hasOwnProperty(key)) {\n                                v[key] = val[key]\n                            }\n                        }\n                        return v\n                    })\n                    this.total_b_1 = res.data.pages.count\n                })\n            })\n        },\n        exportData () {//导出\n            this.downloadLoading = true\n            import('@/vendor/Export2Excel').then(excel => {\n                const tHeader = ['凭证号', '业务类型', '物料编码', '物料名称', '交货数量', '供应商编码',\n                    '供应商名称', '组织编码', '到货单位', '库区', '库位', '记账日期', '创建时间',\n                    '记账人', '订单号', '采购订单号', '交货单号', '交货单行号'\n                ]\n                const filterVal = ['receiveOrderNumber', 'businessType', 'materielCode', 'materielName',\n                    'deliveredQuantity', 'supplierCode', 'supplierName', 'orgCode', 'warehouseCode',\n                    'wareAreaCode', 'wareLocationCode', 'accountDate', 'createTime', 'creator',\n                    'orderNumber', 'purchaseRowNo', 'deliverNo', 'deliveryRowNo'\n                ]\n                const data = this.formatJson(filterVal, this.list_b_1)\n                excel.export_json_to_excel({\n                    header: tHeader,\n                    data,\n                    filename: 'table-list'\n                })\n                this.downloadLoading = false\n            })\n        },\n        formatJson (filterVal, jsonData) {\n            return jsonData.map(v => filterVal.map(j => {\n                if (j === 'timestamp') {\n                    return\n                } else {\n                    return v[j]\n                }\n            }))\n        },\n        selectRow_b (row) {//收货凭证主表\n            this.getList_b_1(row)\n        },\n        selectRow_b_1 () {//收货凭证从表\n        },\n\n        handleClickgysxz_a () {//供应商弹窗\n            this.gysxzDialogFormVisible = true\n            this.GYS = true\n\n        },\n        showGys () {\n            this.$emit('showGys', 'proof')\n        },\n        setGys (rows) {\n            this.parentsRows = rows\n            if (!this.parentsRows[0]) {\n                this.$set(this.listQuery_b, \"supplierCode\", \"\")\n                this.$set(this.listQuery_b, \"supplierName\", \"\")\n            } else {\n                this.$set(this.listQuery_b, \"supplierCode\", this.parentsRows[0].supplierCode)\n                this.$set(this.listQuery_b, \"supplierName\", this.parentsRows[0].supplierName)\n            }\n        }\n    }\n}\n",null]}