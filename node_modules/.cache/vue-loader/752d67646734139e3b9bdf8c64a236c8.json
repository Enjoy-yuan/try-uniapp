{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/system/processManage/processConfiguration/diaLog/dialog2.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/system/processManage/processConfiguration/diaLog/dialog2.vue","mtime":1596610934247},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\nimport * as api from '@/api/system/process/processConfiguration'\nimport contentBaisc from '../tab/tabBasic'\nimport contentPerson from '../tab/tabPerson'\nimport contentRule from '../tab/tabRule'\n\nexport default {\n    name: 'dict',\n    components: { contentBaisc, contentPerson, contentRule },\n    data () {\n        return {\n            src: null,\n            activeContent: 'content1',\n            showPersonc: false,\n            showRulesc: false,\n            type: null,\n            infoList: {\n\n            },\n            dialogVisible: false,\n            nodeQuery: {\n                prodefId: null,\n                activityid: null,\n                type: 'userTask'\n            },\n            nodeConfigList: null,\n            formData: { activityUpdateDTO: {}, taskUpdateDTO: {}, taskRuleUpdateDTOS: [] },\n            activityUpdateDTO: {\n                actcompleted: null,\n                actstarted: null,\n                beftasking: null,//任务分配前事件\n                datastate: null,//数据状态\n                flowstate: null,//流程状态\n                servicename: null,//活动名称\n                servicetype: null,\n                taskcompleted: null,//任务转向后事件\n                taskcreated: null,//任务转向前事件\n            },\n            taskUpdateDTO: {\n                assignee: null,\n                assigneename: null,\n                assigneetype: null,//类型配置\n                autonode: null,\n                autoreminder: null,//循环间隔(时)\n                carboncopy: null,\n                claim: null,\n                countersign: null,\n                defroleNames: null,\n                defuserNames: null,\n                defusers: null,\n                desctype: null,\n                discusstag: null,\n                exclusivetype: null,\n                messagetype: null,//消息类型\n                percent: null,//百分比配置\n                role: null,\n                rolename: null,\n                rolebackhi: null,\n                rollbacknode: null,\n                rollbacktype: null,//驳回配置\n                samepauto: null,//\n                secretary: null,\n                seq: null,\n                timeauto: null,\n                variable: null,\n                webroot: null//业务页面配置\n            },\n            taskRuleUpdateDTOS: []\n        }\n    },\n    computed: {},\n    mounted () {\n\n    },\n    methods: {\n        initData () {\n            this.src = null\n            this.activeContent = 'content1'\n            this.showPersonc = false\n            this.showRulesc = false\n            if (typeof (this.$refs.cbasic) !== 'undefined') {\n                if (this.$refs.cbasic.showAll) {\n                    this.$refs.cbasic.showAll = false\n                }\n            }\n            this.formData = { activityUpdateDTO: {}, taskUpdateDTO: {}, taskRuleUpdateDTOS: [] }\n        },\n        //保存节点配置\n        handleSave () {\n            this.$refs.cbasic.setCheckVal()\n            this.setFormData()\n            console.log('保存当前节点配置', this.formData)\n            api.updateConfig(this.nodeQuery, this.formData).then(() => {\n                this.dialogVisible = false\n                this.$emit('refresh')\n            })\n        },\n        setFormData () {\n            for (let key in this.activityUpdateDTO) {\n                for (let keyf in this.$refs.cbasic.formList) {\n                    if (keyf === key) {\n                        this.activityUpdateDTO[key] = this.$refs.cbasic.formList[key]\n                    }\n                }\n                for (let keyf in this.$refs.cperson.formList) {\n                    if (keyf === key) {\n                        this.activityUpdateDTO[key] = this.$refs.cperson.formList[key]\n                    }\n                }\n            }\n            for (let key in this.taskUpdateDTO) {\n                for (let keyf in this.$refs.cbasic.formList) {\n                    if (keyf === key) {\n                        this.taskUpdateDTO[key] = this.$refs.cbasic.formList[key]\n                    }\n                }\n                for (let keyf in this.$refs.cperson.formList) {\n                    if (keyf === key) {\n                        this.taskUpdateDTO[key] = this.$refs.cperson.formList[key]\n                    }\n                }\n            }\n            this.taskRuleUpdateDTOS = this.$refs.crule.tableList\n\n            this.formData.activityUpdateDTO = this.activityUpdateDTO\n            this.formData.taskUpdateDTO = this.taskUpdateDTO\n            this.formData.taskRuleUpdateDTOS = this.taskRuleUpdateDTOS\n        },\n        //点击节点后触发\n        nodeClick (data) {\n            this.activeContent = \"content1\"\n            this.type = data.params.data.type\n            this.nodeQuery.prodefId = this.infoList.id\n            this.nodeQuery.activityid = data.params.data.activityId\n            if (this.type.toUpperCase() === 'USERTASK') {\n                this.showPersonc = true\n                this.showRulesc = true\n                this.$refs.cbasic.showAll = true\n                this.getNodeList(data.params.data, this.nodeQuery)\n                this.getNodeConfig(this.nodeQuery)\n            } else if (this.type.toUpperCase() === 'EXCLUSIVEGATEWAY') {\n                this.showRulesc = true\n                this.showPersonc = false\n                this.$refs.cbasic.showAll = true\n                this.getNodeList(data.params.data, this.nodeQuery)\n                this.getNodeConfig(this.nodeQuery)\n            } else {\n                this.showPersonc = false\n                this.showRulesc = false\n                this.$refs.cbasic.showAll = false\n            }\n        },\n        selectClick (i) {\n            this.$emit('selectClick', i)\n        },\n        setPerson (val) {\n            this.$refs.cperson.setPerson(val)\n        },\n        //初始化所有tab的值\n        initTab (data) {\n            this.infoList = data\n        },\n        changeTab (val) {\n            if (val.name === 'content3') {\n                this.$refs.crule.initForm(this.nodeConfigList.taskRuleDTOS)\n                this.$refs.crule.varNameList = this.infoList.variableList\n                this.$refs.crule.getNodeDir({ prodefId: this.infoList.id })\n            } else if (val.name === 'content2') {\n                this.$refs.cperson.initForm(this.nodeConfigList)\n            }\n        },\n        //获取指定节点下拉框内容\n        getNodeList (data, query) {\n            api.getActivity(query).then(res => {\n                this.$refs.cbasic.getNodeList(data, res.data)\n            })\n        },\n        //获取节点配置\n        getNodeConfig (query) {\n            api.getActivityConfig(query).then(res => {\n                this.nodeConfigList = res.data\n                this.$refs.cbasic.initForm(this.nodeConfigList)\n                this.$emit('setTabSelect', this.nodeConfigList.taskDTO.assigneetype)\n                console.log(this.nodeConfigList.taskDTO.assigneetype === \"0\", 8888888)\n            })\n        },\n        changeAssigneetype (val) {\n            this.$emit('setTabSelect', val)\n            this.$refs.cperson.setDisabled(val)\n        }\n    }\n}\n",null]}