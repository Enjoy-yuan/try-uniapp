{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/WMS/purchaseStorage/storageCheck/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/WMS/purchaseStorage/storageCheck/index.vue","mtime":1596610934184},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport * as api from '@/api/project/wms/purchaseStorage/storageCheck'\nimport caiGou from '@/components/Select/caigou'//下拉组件\nimport warehouseSelect from '@/components/Select/warehouse-select'//下拉组件\n\nimport Pagination from \"@/components/Pagination\";\nimport { DT_ORG_TYPE } from '@/utils/constant'\nimport { mapState } from 'vuex';\nimport purchasingPersonnel from '@/components/Select/personSelect'//员工组件\n\nexport default {\n    name: \"storageCheck\",\n    components: { caiGou, warehouseSelect, Pagination, purchasingPersonnel },\n    data () {\n        return {\n            theight: 0,//表格高度\n            isSingle: true,//表格是否单选 点击各按钮根据流程逻辑控制单多选\n            list_a: [],\n            total_a: 0,\n            listQuery_a: {\n                currentPage: 1,\n                pageSize: 1000,\n                state: 'iqc1'\n            },\n            list_a_1: [],\n            total_a_1: 0,\n            listQuery_a_1: {\n                currentPage: 1,\n                pageSize: 15,\n            },\n            DT_ORG_TYPE: DT_ORG_TYPE,\n            dialogFormVisible: false,\n            purchasingPersonnelDialogFormVisible: false,\n            temp: {},\n            rules: {\n                businessType: [\n                    { required: true, message: this.$t('validate.required'), trigger: 'blur' },\n                ],\n            },\n            dto: {},\n            parentsRows3: null,\n        };\n    },\n    computed: {\n        ...mapState({\n            dt_band_type: state => state.dict.dt_band_type,\n            dt_iqc_type: state => state.dict.dt_iqc_type,\n            dt_iqc_state: state => state.dict.dt_iqc_state,\n        })\n    },\n    mounted () {\n        this.setTableHeight();\n        this.$store.dispatch('dict/getDicData', ['dt_band_type', 'dt_iqc_type', 'dt_iqc_state']);\n        this.getList_a();\n        //表格高度自适应\n        window.onresize = () => {\n            this.setTableHeight()\n        };\n    },\n    methods: {\n        //表格高度计算\n        setTableHeight () {\n            this.theight = this.$myFun.getSingleTbHeight();\n        },\n        getList_a () {//获取质检单主表\n            api.getData_a(this.listQuery_a).then(res => {\n                res = res.data;\n                this.list_a = res.list;\n                this.total_a = res.pages.count;\n\n            })\n        },\n        getList_a_1 () {//获取质检单从表\n            this.listQuery_a_1.iqcOrderNumber = this.selectlistRow_a.iqcOrderNumber || this.selectlistRow_a.iqcOrderNumber\n            api.getData_a_1(this.listQuery_a_1).then(res => {\n                res = res.data;\n                this.list_a_1 = res.list.map(v => {\n                    for (const key in this.selectlistRow_a) {\n                        if (!v.hasOwnProperty(key)) {\n                            v[key] = this.selectlistRow_a[key]\n                        }\n                    }\n                    return v\n                })\n                this.total_a_1 = res.pages.count;\n            })\n        },\n        selectRow_a (val) {//质检单主表选中事件\n            this.selectlistRow_a = val[val.length - 1]\n            if (val.length > 1) {\n                this.$refs.dt_a.clearSelection()\n                this.$refs.dt_a.toggleRowSelection(val.pop())\n            }\n            if (this.selectlistRow_a) {\n                this.getList_a_1()\n            } else {\n                this.list_a_1 = []\n                this.total_a_1 = 0\n            }\n        },\n        clickRow_a (val) {//质检主表点击事件\n            this.selectlistRow_a = val\n            this.$refs.dt_a.clearSelection()//清除其他行的选中\n            this.$refs.dt_a.toggleRowSelection(val)//单击行绑定点击事件\n        },\n        selectRow_a_1 () {\n\n        },\n        handlegPersonnel () {//业务人员\n            this.purchasingPersonnelDialogFormVisible = true;\n        },\n        purchasingPersonnels (row) {\n            this.parentsRows3 = row\n        },\n        update3 () {//采购计划员中弹窗确认按钮\n            if (this.parentsRows3.length && this.parentsRows3.length == 1) {\n                // this.temp.supplierCode = this.parentsRows3[0].employeeCode;\n                this.temp.iqcEmpName = this.parentsRows3[0].employeeName;\n                this.purchasingPersonnelDialogFormVisible = false;\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        qualityConfirmation () {//明细质检更新\n            api.update_a_1(this.dto, this.temp).then(() => {\n                this.$message({\n                    title: \"成功\",\n                    message: \"明细质检更新成功\",\n                    type: \"success\"\n                });\n                this.getList_a_1()\n            })\n            this.dialogFormVisible = false\n\n        },\n        handleEdit (index, row) {//明细质检按钮\n            this.dto = {\n                iqcOrderNumber: this.selectlistRow_a.iqcOrderNumber,\n                iqcRowNo: row.iqcRowNo\n            }\n\n            this.dialogFormVisible = true\n            api.getData_a_2(this.dto).then(res => {\n                res = res.data;\n                for (const key in this.selectlistRow_a) {\n                    if (this.selectlistRow_a.hasOwnProperty(key)) {\n                        res[key] = this.selectlistRow_a[key];\n                    }\n                }\n                this.temp = res;\n            })\n        },\n        qualityCommit () {//质检确认\n            if (this.selectlistRow_a) {\n                this.dto = {\n                    iqcOrderNumber: this.selectlistRow_a.iqcOrderNumber,\n                    method: 'COMMIT',\n                }\n                api.update_a(this.dto).then(() => {\n                    this.$message({\n                        title: \"成功\",\n                        message: \"质检确认成功\",\n                        type: \"success\"\n                    });\n                    this.getList_a()\n                })\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条数据\",\n                    type: \"warning\"\n                });\n            }\n\n\n        }\n\n    }\n};\n",null]}