{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/EAS/EL/equipmentArchives/tab5.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/EAS/EL/equipmentArchives/tab5.vue","mtime":1596610933378},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport *  as api from '@/api/project/eas/el/equipmentArchives'\nimport Pagination from '@/components/Pagination'\nimport { mapState } from \"vuex\"\nimport { parseTime } from '@/utils'\n\n\nexport default {\n    name: 'sbll',\n    components: { Pagination },\n    props: ['deviceCode'],\n    data () {\n        return {\n            list: null,\n            total: 0,\n            subList: [],\n            value: '',\n            theight: 0, //表格高度\n            listQuery: {\n                page: true,\n                currentPage: 1,\n                pageSize: 15,\n                deviceCode: undefined\n            },\n            listQuery1: {\n                page: true,\n                currentPage: 1,\n                pageSize: 15,\n                type_: undefined,\n                startTime: undefined,\n                endTime: undefined,\n                deviceCode: undefined\n            },\n            tableKey: [0],\n        }\n    },\n    created () {\n    },\n    computed: {\n        ...mapState({\n            dt_device_record_type: state => state.eamDict.dt_device_record_type,\n        })\n    },\n    watch: {\n        deviceCode () {\n            this.getList()\n        },\n        dt_device_record_type () {\n            if (this.list && this.list.length) {\n                let options = [this.dt_device_record_type]\n                this.list = this.$myFun.srmCodeToName(\n                    this.list,\n                    options,\n                    ['type']\n                )\n            }\n\n        }\n    },\n    mounted () {\n        this.setTableHeight()\n        //表格高度自适应\n        window.onresize = () => {\n            this.setTableHeight()\n        }\n        this.$store.dispatch(\"eamDict/getDicData\", [\"dt_device_record_type\"])\n    },\n    methods: {\n        //表格高度计算\n        setTableHeight () {\n            this.theight = this.$myFun.getSingleTbHeight() - 185\n        },\n        getList () {\n            if (this.deviceCode) {\n                this.listQuery.deviceCode = this.deviceCode\n            }\n            api.queryll(this.listQuery).then(res => {\n                this.list = res.data.list\n                let options = [this.dt_device_record_type]\n                this.list = this.$myFun.srmCodeToName(\n                    res.data.list,\n                    options,\n                    ['type']\n                )\n                this.total = res.data.pages.count\n            })\n        },\n\n        handleQuery () {\n            if (this.value) {\n                var d1 = this.value[0]\n                var d2 = this.value[1]\n                this.listQuery1.startTime = d1\n                this.listQuery1.endTime = d2\n            } else {\n                this.listQuery1.startTime = \"\"\n                this.listQuery1.endTime = \"\"\n            }\n            this.listQuery1.deviceCode = this.deviceCode\n            api.queryll(this.listQuery1).then(res => {\n                this.list = res.data.list\n                let options = [this.dt_device_record_type]\n                this.list = this.$myFun.srmCodeToName(\n                    this.list,\n                    options,\n                    ['type']\n                )\n                this.total = res.data.pages.count\n            })\n        },\n        handleDownload () {\n            this.downloadLoading = true\n            import('@/vendor/Export2Excel').then(excel => {\n                const tHeader = [\n                    '日期',\n                    '类型',\n                    '单据号',\n                    '处理人',\n                    '备注'\n                ]\n                const filterVal = [\n                    'time',\n                    'typeName',\n                    'orderNumber',\n                    'disposerName',\n                    'remark'\n                ]\n                const data = this.formatJson(filterVal, this.list)\n                excel.export_json_to_excel({\n                    header: tHeader,\n                    data,\n                    filename: 'table-list'\n                })\n                this.downloadLoading = false\n            })\n        },\n        formatJson (filterVal, jsonData) {\n            return jsonData.map(v =>\n                filterVal.map(j => {\n                    if (j === 'timestamp') {\n                        return parseTime(v[j])\n                    } else {\n                        return v[j]\n                    }\n                })\n            )\n        }\n    }\n}\n",null]}