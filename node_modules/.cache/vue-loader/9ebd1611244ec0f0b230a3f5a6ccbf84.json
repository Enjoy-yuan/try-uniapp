{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/data-base/storageMaterialClassification/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/data-base/storageMaterialClassification/index.vue","mtime":1596610933351},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport * as api1 from \"@/api/data-base/warehouse\";\nimport * as api from \"@/api/data-base/warehouse-distribute\";\nimport Pagination from \"@/components/Pagination\";\nimport { DT_ORG_TYPE } from \"@/utils/constant\";\nimport materielTable from \"./materielTable\";\nimport personSelect from \"@/components/Select/personSelect\"; //物料信息模块\nimport ckbm from \"./ckbm\";\n\nexport default {\n    name: \"storage_material_classification\",\n    components: {\n        Pagination,\n        materielTable,\n        personSelect,\n        ckbm,\n    },\n    data () {\n        return {\n            list: null,\n            list1: null,\n            tableKey: [0, 1],//表格索引，虚拟dom渲染表格时使用\n            theight: 0,\n            stheight: 0,//右子表高度\n            total: 0,\n            total1: 0,\n            listQuery: {\n                currentPage: 1,\n                pageSize: 15,\n                orgCode: undefined,\n                warehouseCode: undefined\n            },\n            listQuery1: {\n                currentPage: 1,\n                pageSize: 15,\n                locationCode: undefined,\n                warehouseCode: undefined,\n                areaCode: undefined\n            },\n            parentsRows: null,\n            parentsRows2: null,\n            parentsRows3: null,\n            temp: {\n                warehouseCode: undefined,\n                warehouseName: undefined,\n                materielCode: undefined,\n                materielName: undefined,\n                locationCode: undefined,\n                locationName: undefined,\n                areaCode: undefined,\n                areaName: undefined,\n                stockEmp: undefined,\n                stockEmpName: undefined,\n                goodsReadyEmp: undefined,\n                goodsReadyEmpName: undefined,\n                materialputEmp: undefined,\n                materialputEmpName: undefined,\n                state: 1,\n                orgName: undefined,\n                orgCode: undefined\n            },\n            dtos: {\n                warehouseCode: undefined,\n                warehouseName: undefined,\n                materielCode: undefined,\n                materielName: undefined,\n                locationCode: undefined,\n                locationName: undefined,\n                areaCode: undefined,\n                areaName: undefined,\n                stockEmp: undefined,\n                stockEmpName: undefined,\n                goodsReadyEmp: undefined,\n                goodsReadyEmpName: undefined,\n                materialputEmp: undefined,\n                materialputEmpName: undefined,\n                state: 1,\n                orgName: undefined,\n                orgCode: undefined\n            },\n            dtos1: {\n                warehouseCode: undefined,\n                warehouseName: undefined,\n                materielCode: undefined,\n                materielName: undefined,\n                locationCode: undefined,\n                locationName: undefined,\n                areaCode: undefined,\n                areaName: undefined,\n                stockEmp: undefined,\n                stockEmpName: undefined,\n                goodsReadyEmp: undefined,\n                goodsReadyEmpName: undefined,\n                materialputEmp: undefined,\n                materialputEmpName: undefined,\n                state: 1,\n                orgName: undefined,\n                orgCode: undefined\n            },\n            dtoscssz: {\n                stockEmp: undefined,\n                stockEmpName: undefined,\n                goodsReadyEmp: undefined,\n                goodsReadyEmpName: undefined,\n                materialputEmp: undefined,\n                materialputEmpName: undefined,\n                rowIds: [],\n                warehouseCode: undefined\n            },\n            warehouseCode: undefined,\n            warehouseName: undefined,\n            areaCode: undefined,\n            materielCode: undefined,\n            materielName: undefined,\n            stockEmpName: undefined,\n            state: 1,\n            ckbmDialogFormVisible: false,\n            locationDialogVisible: false,\n            dialogFormVisible: false,\n            dialogFormVisible1: false,\n            dialogFormVisible2: false,\n            gysxzDialogFormVisible: false,\n            materielDialogFormVisible: false,\n            purchasingPersonnelDialogFormVisible: false,\n            dialogStatus: \"\",\n            DT_ORG_TYPE: DT_ORG_TYPE,\n            rules: {}\n        };\n    },\n    created () {\n        // this.getList()\n    },\n    mounted () {\n        this.setTableHeight();\n        //表格高度自适应\n        window.onresize = () => {\n            this.setTableHeight()\n        };\n    },\n    methods: {\n        getList () {\n            api1.queryLocation(this.listQuery.warehouseCode, this.listQuery).then(res => {\n                this.list = res.data.list;\n                this.total = res.data.pages.count;\n            });\n        },\n        //表格高度计算\n        setTableHeight () {\n            this.theight = this.$myFun.getSingleTbHeight() + 52;\n            this.stheight = this.theight;\n        },\n        getList1 () {\n            this.listQuery1.rule = 'Classified'\n            api.queryRecords(this.listQuery1).then(res => {\n                this.list1 = res.data.list;\n                this.total1 = res.data.pages.count;\n            });\n        },\n        selectRow (val) {//表一复选框选中方法\n            this.selectlistRow = val[val.length - 1];\n            this.getList1();\n        },\n        selectRow1 (val) {//表一单击行选中方法\n            this.selectlistRow1 = val;\n            this.listQuery1.warehouseCode = this.selectlistRow1.warehouseCode;\n            this.listQuery1.areaCode = this.selectlistRow1.areaCode;\n            this.getList1();\n        },\n        selectRow2 (val) {//表二复选框选中方法\n            this.selectlistRow2 = val[val.length - 1];\n            if (val.length > 1) {\n                this.$refs.mx.clearSelection();\n                this.$refs.mx.toggleRowSelection(val.pop());\n            }\n\n        },\n        handleClickckbm () {//打开仓库弹窗\n            this.ckbmDialogFormVisible = true;\n        },\n        handleDblclickckbm (row) {//仓库弹窗父子传值\n            this.parentsRows = row;\n        },\n        selectTypeRow (row) {//物料信息选中行\n            this.parentsRows2 = row;\n        },\n        handleCreatewl () {//新增物料弹窗\n            if (this.selectlistRow1) {\n                this.dialogStatus = \"update2\";\n                this.gysxzDialogFormVisible = true;\n\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        update2 () {//新增物料确认按钮\n            this.dtos = [];\n            this.parentsRows2.forEach((item, index) => {\n                let obj = {\n                    areaCode: this.selectlistRow1.areaCode,\n                    locationCode: this.selectlistRow1.locationCode,\n                    warehouseCode: this.selectlistRow1.warehouseCode,\n                    orgCode: this.parentsRows.orgCode,\n                    orgName: this.parentsRows.orgName,\n                    locationMaterielRule: 'Classified',\n                };\n                this.dtos.push(obj)\n                this.dtos[index].materielCode = item.dictItemKey\n                this.dtos[index].materielName = item.dictItemValue\n            });\n            api.addRecord1(this.dtos).then(() => {\n                this.getList1();\n                this.gysxzDialogFormVisible = false;\n                this.$notify({\n                    title: \"成功\",\n                    message: \"新增成功\",\n                    type: \"success\",\n                    duration: 2000\n                });\n            });\n\n        },\n        update3 () {//新增物料编码弹窗确认按钮\n            if (this.parentsRows2 && this.parentsRows2.length == 1) {\n                this.temp.materielCode = this.parentsRows2[0].dictItemKey;\n                this.temp.materielName = this.parentsRows2[0].dictItemValue;\n                this.gysxzDialogFormVisible = false;\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        update4 () {//保管员中弹窗确认按钮\n            if (this.parentsRows3) {\n                this.temp.stockEmpName = this.parentsRows3[0].employeeName;\n                this.purchasingPersonnelDialogFormVisible = false;\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        handleSet () {//参数设置弹窗\n            if (this.selectlistRow2) {\n                this.dialogStatus = \"createcssz\";\n                this.dialogFormVisible1 = true;\n                this.temp.stockEmpName = this.selectlistRow2.stockEmpName\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        createcssz () {//参数设置确认\n            let rowIdsArry = [];\n            rowIdsArry.push(this.selectlistRow2.rowId);\n            this.dtoscssz.rowIds = rowIdsArry;\n            this.dtoscssz.stockEmp = this.temp.stockEmp;\n            this.dtoscssz.stockEmpName = this.temp.stockEmpName;\n            api.updateRecordcssz(this.dtoscssz).then(() => {\n                this.getList1();\n                this.dialogFormVisible1 = false;\n                this.$notify({\n                    title: \"成功\",\n                    message: \"编辑成功\",\n                    type: \"success\",\n                    duration: 2000\n                });\n            });\n        },\n        handleDelete () {//删除方法\n            if (this.selectlistRow2) {\n                this.$confirm(this.$t('message.isDeleteContinue'), this.$t('message.prompt'), {\n                    confirmButtonText: this.$t('message.yes'),\n                    cancelButtonText: this.$t('message.no'),\n                    type: 'warning'\n                }).then(() => {\n                    api.deleteRecord(this.selectlistRow2.rowId).then(() => {\n                        this.getList1();\n                        this.$notify({\n                            title: \"成功\",\n                            message: \"删除成功\",\n                            type: \"success\",\n                            duration: 2000\n                        });\n                    });\n                });\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n\n        handleCreate () {//新增方法\n            this.resetTemp();\n            if (this.selectlistRow1) {\n                this.dialogStatus = \"create\";\n                this.temp.warehouseCode = this.selectlistRow1.warehouseCode;\n                this.temp.locationCode = this.selectlistRow1.locationCode;\n                this.temp.areaCode = this.selectlistRow1.areaCode;\n                this.temp.warehouseName = this.parentsRows.warehouseName;\n                this.temp.locationName = this.selectlistRow1.locationName;\n                this.temp.areaName = this.selectlistRow1.areaName;\n                this.dialogFormVisible = true;\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        handleUpdate () {//编辑方法\n            if (this.selectlistRow2) {\n                this.dialogStatus = \"update\";\n                this.temp.warehouseCode = this.selectlistRow1.warehouseCode;\n                this.temp.warehouseName = this.parentsRows.warehouseName;\n                this.temp.locationCode = this.selectlistRow1.locationCode;\n                this.temp.locationName = this.selectlistRow1.locationName;\n                this.temp.areaCode = this.selectlistRow1.areaCode;\n                this.temp.areaName = this.selectlistRow1.areaName;\n                this.temp.materielCode = this.selectlistRow2.materielCode;\n                this.temp.materielName = this.selectlistRow2.materielName;\n                this.temp.stockEmp = this.selectlistRow2.stockEmp;\n                this.temp.stockEmpName = this.selectlistRow2.stockEmpName;\n                this.temp.goodsReadyEmpName = this.selectlistRow2.goodsReadyEmpName;\n                this.temp.materialputEmpName = this.selectlistRow2.materialputEmpName;\n                this.temp.goodsReadyEmp = this.selectlistRow2.goodsReadyEmp;\n                this.temp.materialputEmpName = this.selectlistRow2.materialputEmpName;\n                this.dialogFormVisible = true;\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        handleLead () { },\n        handlegPersonnel () {//业务人员\n            this.purchasingPersonnelDialogFormVisible = true;\n        },\n        purchasingPersonnels (row) {//保管员父子传值\n            this.parentsRows3 = row;\n        },\n        handleClickMateriel () {//物料分类编码弹窗\n            this.gysxzDialogFormVisible = true;\n        },\n        create () {\n            this.dtos.warehouseCode = this.temp.warehouseCode;\n            this.dtos.warehouseName = this.temp.warehouseName;\n            this.dtos.materielCode = this.temp.materielCode;\n            this.dtos.materielName = this.temp.materielName;\n            this.dtos.locationCode = this.temp.locationCode;\n            this.dtos.locationName = this.temp.locationName;\n            this.dtos.goodsReadyEmp = this.temp.goodsReadyEmp;\n            this.dtos.goodsReadyEmpName = this.temp.goodsReadyEmpName;\n            this.dtos.materialputEmp = this.temp.materialputEmp;\n            this.dtos.materialputEmpName = this.temp.materialputEmpName;\n            this.dtos.locationMaterielRule = \"Classified\";\n            this.dtos.areaCode = this.temp.areaCode;\n            this.dtos.areaName = this.temp.areaName;\n            this.dtos.stockEmp = this.temp.stockEmp;\n            this.dtos.stockEmpName = this.temp.stockEmpName;\n            this.dtos.state = this.temp.state;\n            this.dtos.orgName = this.parentsRows.orgCode;\n            this.dtos.orgCode = this.parentsRows.orgName;\n            api.addRecord(this.dtos).then(() => {\n                this.getList1();\n                this.dialogFormVisible = false;\n                this.$notify({\n                    title: \"成功\",\n                    message: \"新增成功\",\n                    type: \"success\",\n                    duration: 2000\n                });\n            });\n        },\n        update () {//编辑方法\n            this.dtos1.warehouseCode = this.temp.warehouseCode;\n            this.dtos1.warehouseName = this.temp.warehouseName;\n            this.dtos1.materielCode = this.temp.materielCode;\n            this.dtos1.materielName = this.temp.materielName;\n            this.dtos1.locationCode = this.temp.locationCode;\n            this.dtos1.locationName = this.temp.locationName;\n            this.dtos1.areaCode = this.temp.areaCode;\n            this.dtos1.areaName = this.temp.areaName;\n            this.dtos1.stockEmp = this.selectlistRow2.stockEmp;\n            this.dtos1.stockEmpName = this.temp.stockEmpName;\n            this.dtos1.goodsReadyEmp = this.selectlistRow2.goodsReadyEmp;\n            this.dtos1.goodsReadyEmpName = this.temp.goodsReadyEmpName;\n            this.dtos1.materialputEmp = this.selectlistRow2.materialputEmp;\n            this.dtos1.materialputEmpName = this.temp.materialputEmpName;\n            this.dtos1.state = this.temp.state;\n            this.dtos1.orgCode = this.selectlistRow2.orgCode;\n            this.dtos1.orgName = this.selectlistRow2.orgName;\n            api.updateRecord(this.selectlistRow2.rowId, this.dtos1).then(() => {\n                this.getList1();\n                this.dialogFormVisible = false;\n                this.$notify({\n                    title: \"成功\",\n                    message: \"编辑成功\",\n                    type: \"success\",\n                    duration: 2000\n                });\n            });\n        },\n        update1 () {\n            if (this.parentsRows) {\n                this.listQuery.warehouseCode = this.parentsRows.warehouseCode;\n                this.ckbmDialogFormVisible = false;\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        handleQuery () {\n            this.listQuery.currentPage = 1;\n            this.getList();\n        },\n        handleClose () {\n            this.resetTemp();\n            this.$refs.temp.resetFields();\n        },\n        resetTemp () {\n            this.temp = {\n                warehouseCode: undefined,\n                warehouseName: undefined,\n                materielCode: undefined,\n                materielName: undefined,\n                locationCode: undefined,\n                locationName: undefined,\n                areaCode: undefined,\n                areaName: undefined,\n                stockEmp: undefined,\n                stockEmpName: undefined,\n                goodsReadyEmp: undefined,\n                goodsReadyEmpName: undefined,\n                materialputEmp: undefined,\n                materialputEmpName: undefined,\n                state: 1,\n                orgName: undefined,\n                orgCode: undefined\n            };\n        }\n    }\n};\n",null]}