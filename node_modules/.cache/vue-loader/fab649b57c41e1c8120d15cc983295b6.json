{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/components/srmSupplierTab/Tab/tab3.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/components/srmSupplierTab/Tab/tab3.vue","mtime":1596610933188},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport dialogscyjMain from \"./dialog/dialogscyjMain\"\nimport dialogscyjSub from \"./dialog/dialogscyjSub\"\nimport * as api from \"@/api/project/srm/supplierManagement/supplierRegister\"\nimport { mapState } from \"vuex\"\nexport default {\n    name: \"delivery_Publish\",\n    components: { dialogscyjMain, dialogscyjSub },\n    data () {\n        return {\n            theight: 0,//表格高度\n            isSingle: true,//表格是否单选 点击各按钮根据流程逻辑控制单多选\n            currentSelectedRow: null,//当前选中的行\n            selectedRows: null,//多选时选中的所有行\n            list: null,\n            listSub: null,\n            rowId: null,\n            selectedrow: null,//主表选中行\n            listQuery: {\n                page: true,\n                currentPage: 1,\n                pageSize: 10\n            },\n            sublistQuery: {\n                page: true,\n                currentPage: 1,\n                pageSize: 10\n            },\n            tableKey: [0, 1]//表格索引，虚拟dom渲染表格时使用\n\n        }\n    },\n    computed: {\n        ...mapState({\n            dt_srm_pdq: state => state.dict.dt_srm_pdq,\n        })\n    },\n    mounted () {\n        this.$store.dispatch(\"dict/getDicData\", [\"dt_srm_pdq\"])\n        this.setTableHeight()\n        //表格高度自适应\n        window.onresize = () => {\n            this.setTableHeight()\n        }\n    },\n    methods: {\n        //表格高度计算\n        setTableHeight () {\n            this.theight = this.$myFun.getSingleTbHeight() / 2\n        },\n        setTabData (val) {\n            this.list = val\n        },\n        setTabDataSub (val) {\n            this.listSub = val\n        },\n        //新增编辑删除成功之后刷新表格数据\n        getFreshList () {\n            let b = {\n                rowId: this.rowId\n            }\n            api.updateRecords(b).then(res => {\n                this.list = res.data.achievementInfoDTOList\n                let options = [this.dt_srm_pdq]\n                res.data.productInfoDTOList = this.$myFun.srmCodeToName(res.data.productInfoDTOList, options, ['level'])\n                this.listSub = res.data.productInfoDTOList\n            })\n        },\n        //显示主表\n        getList (row) {\n            this.$refs.nnzcl.temp.supplierId = row.rowId\n            this.$refs.cpqd.temp.supplierId = row.rowId\n            this.rowId = row.rowId\n            let a = {\n                rowId: row.rowId\n            }\n            api.updateRecords(a).then(res => {\n                this.list = res.data.achievementInfoDTOList\n                let options = [this.dt_srm_pdq]\n                res.data.productInfoDTOList = this.$myFun.srmCodeToName(res.data.productInfoDTOList, options, ['level'])\n                this.listSub = res.data.productInfoDTOList\n            })\n        },\n        //年度总产量新增按钮单击事件\n        handleCreate () {\n            this.$refs.nnzcl.resetTemp()\n            this.$nextTick(() => {\n                this.$refs.nnzcl.$refs['dataForm'].clearValidate()\n            })\n            this.$refs.nnzcl.dialogStatus = 'create'\n            this.$refs.nnzcl.dialogVisible = true\n        },\n        //年度总产量行内编辑按钮单击事件\n        handleUpdate (index, val) {\n            this.$refs.nnzcl.dialogStatus = 'update'\n            this.$refs.nnzcl.dialogVisible = true\n            this.$refs.nnzcl.temp = val\n\n        },\n        //年度总产量行内删除按钮单击事件\n        handleDelete (index, val) {\n            api.deleteRecordachieve(this.$refs.nnzcl.temp.supplierId, val.rowId).then(() => {\n                this.$message({\n                    title: '成功',\n                    message: '删除成功',\n                    type: 'success',\n                    duration: 2000\n                })\n                this.getFreshList()\n            })\n        },\n        //产品清单新增按钮单击事件\n        handleCreateSub () {\n            this.$refs.cpqd.resetTemp()\n            this.$nextTick(() => {\n                this.$refs.cpqd.$refs['dataForm'].clearValidate()\n            })\n            this.$refs.cpqd.dialogStatus = 'create'\n            this.$refs.cpqd.dialogVisible = true\n        },\n        //产品清单行内编辑按钮单击事件\n        handleUpdateSub (index, val) {\n            this.$refs.cpqd.dialogStatus = 'update'\n            this.$refs.cpqd.dialogVisible = true\n            this.$refs.cpqd.temp = val\n        },\n        //产品清单行内删除按钮单击事件\n        handleDeleteSub (index, val) {\n            api.deleteRecordproduct(this.$refs.cpqd.temp.supplierId, val.rowId).then(() => {\n                this.$message({\n                    title: '成功',\n                    message: '删除成功',\n                    type: 'success',\n                    duration: 2000\n                })\n                this.getFreshList()\n            })\n        }\n    }\n};\n",null]}