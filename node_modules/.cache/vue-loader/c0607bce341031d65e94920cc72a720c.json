{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/contractManage/supplierPerformance/dailyEvaluation/evaluationFormat/dialog/addMainSub.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/contractManage/supplierPerformance/dailyEvaluation/evaluationFormat/dialog/addMainSub.vue","mtime":1597995949088},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport evaPerson from \"@/components/Dialog/dialogPersonSelect\"\nimport * as api from \"@/api/project/srm/contractManage/evaluationModel\"\nimport { mapState } from 'vuex'\nexport default {\n    components: { evaPerson },\n    data () {\n        return {\n            dialogVisible: false,\n            tableKey: 0,\n            list: [],\n            listQuery: {},\n            selectedRows: null,\n            currentSelectedRow: null\n        }\n    },\n    computed: {\n        ...mapState({\n            dt_srm_pb4: state => state.dict.dt_srm_pb4   // 评价项 \n        })\n    },\n    mounted () {\n        this.$store.dispatch('dict/getDicData', [\n            'dt_srm_pb4'\n        ])\n        if (this.dt_srm_pb4) {\n            this.getList()\n        }\n    },\n    methods: {\n        handleQuery () {\n\n        },\n        getList () {\n            let dto = {\n                page: true,\n                currentPage: 1,\n                pageSize: 15,\n                parentCode: 'root',\n                method: 'configure'\n            }\n            api.queryRecordTree(dto).then(res => {\n                // console.log(res)\n                setTimeout(() => {\n                    // console.log(this.dt_srm_pb4)\n                    this.$nextTick(() => {\n                        this.dt_srm_pb4.forEach((item, index) => {\n                            let obj = {\n                                num: '',\n                                evaluationItem: '',\n                                evaluationModel: ''\n                            }\n                            obj.num = index + 1\n                            obj.evaluationItem = item.dictItemKey\n\n                            res.data.list.forEach((val) => {\n                                if (val.evaluationItem == item.dictItemKey) {\n                                    obj.evaluationModel = val.classificationCode\n                                }\n                            })\n                            this.list.push(obj)\n                            this.list = this.$myFun.srmCodeToName(this.list, [this.dt_srm_pb4], ['evaluationItem'])\n                        })\n                    })\n                }, 100)\n            })\n        },\n        // 评价人选择\n        showPJPS (index) {\n            this.index = index\n            this.$refs.selectPerson.selectedRows = null\n            this.$refs.selectPerson.dialogVisible = true\n        },\n        // 评价人选择确定\n        personConfirm (selectedRow) {\n            this.$nextTick(() => {\n                this.$set(this.list[this.index], 'evaluationUser', selectedRow[0].employeeCode)\n                this.$set(this.list[this.index], 'evaluationUserName', selectedRow[0].employeeName)\n            })\n        },\n        // 设置评价模型页确定\n        handleModel () {\n            if (!this.selectedRow.length) {\n                this.$message({\n                    type: 'warning',\n                    message: '请选择一条或者几条！'\n                })\n            } else {\n                this.dialogVisible = false\n                this.$emit('modelList', this.selectedRow)\n                // console.log(this.selectedRow)\n            }\n        },\n        // 表格选择框选中 注:参数为选中的所有行的数组\n        selectChange (val) {\n            if (this.isSingle) {\n                if (val.length > 1) {\n                    this.$refs.tb.clearSelection() //清除其他行的选中\n                    this.$refs.tb.toggleRowSelection(val[val.length - 1], \"selected\") //单击行绑定点击事件\n                } else if (val.length === 1) {\n                    this.selectedRows = val\n                    this.currentSelectedRow = val[val.length - 1]\n                }\n            } else {\n                this.selectedRows = val\n                this.currentSelectedRow = val[val.length - 1]\n            }\n        },\n        //点击表格某一行\n        rowClick (val) {\n            if (this.isSingle) {\n                this.$refs.tb.clearSelection() //清除其他行的选中\n            }\n            this.$refs.tb.toggleRowSelection(val, \"selected\") //单击行绑定点击事件\n        },\n    }\n}\n",null]}