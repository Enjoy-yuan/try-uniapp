{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/OA/purchase/purchasingOrderQuery/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/OA/purchase/purchasingOrderQuery/index.vue","mtime":1596610933593},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\nimport * as api from '@/api/project/oa/purchase/purchasing_Order_Formulation'\nimport Pagination from '@/components/Pagination' // 分页组件\nimport { DT_ORG_TYPE, DICT_CODE } from '@/utils/constant'\nimport warehouseSelect from '@/components/Select/warehouse-select.vue'//下拉组件\nimport caiGou from '@/components/Select/xtpt/caigou'//下拉组件\nimport gysxz from \"@/components/Select/xtpt/gysxz\"; //供应商选择\nimport { mapState } from 'vuex';\n\nexport default {\n    name: 'deliveryOrder',\n    components: { Pagination, caiGou, gysxz, warehouseSelect },\n    data () {\n        return {\n            modalnum: null,//模板编号\n            theight: 0,\n            tableKey: [0, 1],//表格索引，虚拟dom渲染表格时使用\n            isSingle: true,//表格是否单选 点击各按钮根据流程逻辑控制单多选\n            currentSelectedRow: null,//当前选中的行\n            selectedRows: null,//多选时选中的所有行\n            isGysRequired: false,//供应商非必选\n            gysMutiple: true,//供应商单选\n            list: [],\n            total: 0,\n            listQuery: {\n                currentPage: 1,\n                pageSize: 10,\n                businessType: undefined,\n                arrivalCompany: undefined,\n                arrivalRepository: undefined,\n                supplierName: undefined,\n                state: undefined,\n            },\n            parentsRows: [],\n            parentsRows1: null,\n            parentsRows3: null,\n            list1: [],\n            total1: 0,\n            listQuery1: {\n                currentPage: 1,\n                pageSize: 10,\n                orderNumber: undefined\n            },\n            isEdit: true,\n            listLoading: true,\n            showReviewer: false,\n            temp: {\n                supplierCode: '',\n                materielselect: 0\n            },\n            dialogFormVisible: false,\n            gysxzDialogFormVisible: false,\n            wlxzDialogFormVisible: false,\n            purchasingPersonnelDialogFormVisible: false,\n            dialogStatus: '',\n            DT_ORG_TYPE: DT_ORG_TYPE,\n            DICT_CODE: DICT_CODE,\n            rules: {\n                businessType: [\n                    { required: true, message: this.$t('validate.required'), trigger: 'blur' },\n                ],\n                purchaseClassify: [\n                    { required: true, message: this.$t('validate.required'), trigger: 'blur' },\n                ],\n                arrivalCompany: [\n                    { required: true, message: this.$t('validate.required'), trigger: 'blur' },\n                ],\n                orgCode: [\n                    { required: true, message: this.$t('validate.required'), trigger: 'blur' },\n                ],\n                groupCode: [\n                    { required: true, message: this.$t('validate.required'), trigger: 'blur' }\n                ],\n                supplierName: [\n                    { required: true, message: this.$t('validate.required'), trigger: 'blur' }\n                ],\n                purchaseEmp: [\n                    { required: true, message: this.$t('validate.required'), trigger: 'blur' }\n                ],\n            }\n        };\n\n    },\n    computed: {\n        ...mapState({\n            dt_dd_state: state => state.dict.dt_dd_state,\n            dt_ckyw_tpye: state => state.dict.dt_ckyw_tpye,\n            dt_purchase_class: state => state.dict.dt_purchase_class\n        })\n    },\n    mounted () {\n        this.setTableHeight();\n        //表格高度自适应\n        window.onresize = () => {\n            this.setTableHeight()\n        };\n        this.$store.dispatch(\"dict/getDicData\", ['dt_dd_state', 'dt_ckyw_tpye', 'dt_purchase_class']);\n        this.getList();\n    },\n    watch: {\n        tb () {\n            this.$nextTick(() => {\n                this.$refs.tb.toggleRowSelection(this.tb[0], true);\n            })\n        },\n    },\n    methods: {\n        //表格高度计算\n        setTableHeight () {\n            this.theight = this.$myFun.getSingleTbHeight() - 185;\n        },\n        showGysxz () {\n            this.$refs.dialogRefgys.dialogVisible = !this.$refs.dialogRefgys.dialogVisible;\n        },\n        //供应商确认\n        handleGysClick (gysRows) {\n            this.parentsRows = gysRows;\n            if (!this.parentsRows[0]) {\n                this.listQuery.supplierCode = \"\";\n                this.listQuery.supplierName = \"\";\n                this.gysxzDialogFormVisible = false;\n            } else if (this.parentsRows.length === 1) {\n                this.listQuery.supplierCode = this.parentsRows[0].supplierCode;\n                this.listQuery.supplierName = this.parentsRows[0].supplierName;\n                this.gysxzDialogFormVisible = false;\n            }\n        },\n        getSubList () {\n            if (this.selectListRow) {\n                this.listQuery1.orderNumber = this.selectListRow.orderNumber//总是获取当前数组最后一个值\n            }\n\n            api.selectListItems(this.listQuery1).then(res => {\n                this.list1 = res.data.list\n                this.total1 = res.data.pages.count\n            })\n        },\n        getList () {//查询\n            this.listLoading = true\n\n            api.selectList(this.listQuery).then(response => {\n                response = response.data;\n                let options = [this.dt_dd_state, this.dt_ckyw_tpye, this.dt_purchase_class];\n                response = this.$myFun.codeToName(response, options, ['state', 'businessType', 'purchaseClassify']);\n\n                this.list = response.list\n                this.total = response.pages.count\n                this.$nextTick(function () {\n                    this.checked()\n                })\n                // Just to simulate the time of the request\n                setTimeout(() => {\n                    this.listLoading = false\n                }, 1.5 * 100)\n            })\n\n            this.listLoading = false\n        },\n        checked () {\n            this.$refs.tb.toggleRowSelection(this.list[0], true);//官网方法，重点\n        },\n        resetTemp () {//重置temp\n            this.temp = {\n                materielselect: 1,\n                supplierCode: ''\n            }\n        },\n        selectRow1 (val) {//获取关联选中信息\n            this.selectListRow1 = val\n        },\n        selectRow (val) {//获取表一选中信息\n            this.selectListRow = val[val.length - 1]\n            if (val.length > 1) {\n                this.$refs.tb.clearSelection()//清除其他行的选中\n                this.$refs.tb.toggleRowSelection(val[val.length - 1], 'selected')//单击行绑定点击事件\n            }\n            this.$refs.tb.setCurrentRow(this.selectListRow);\n            if (this.selectListRow) {\n                this.listQuery1.orderNumber = this.selectListRow.orderNumber//总是获取当前数组最后一个值\n                api.selectListItems(this.listQuery1).then(res => {\n                    this.list1 = res.data.list\n                    this.total1 = res.data.pages.count\n                })\n            } else {\n                this.list1 = []\n            }\n        },\n        openDetails (val) {//表一行点击，拉去表二信息\n            this.$refs.tb.clearSelection()//清除其他行的选中\n            this.$refs.tb.toggleRowSelection(val)//单击行绑定点击事件\n            if (this.selectListRow) {\n                this.listQuery1.orderNumber = this.selectListRow.orderNumber//总是获取当前数组最后一个值\n            }\n\n            api.selectListItems(this.listQuery1).then(res => {\n                this.list1 = res.data.list\n                this.total1 = res.data.pages.count\n            })\n\n        },\n        handleFilter () {//查询\n            this.getList()\n        },\n\n        purchasingPersonnels (row) {\n            this.parentsRows3 = row\n        },\n\n\n        open () {\n            this.dialogStatus = 'create'\n            this.dialogFormVisible = true\n        }\n    }\n};\n",null]}