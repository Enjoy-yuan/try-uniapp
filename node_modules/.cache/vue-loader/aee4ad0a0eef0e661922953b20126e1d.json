{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/contractManage/supplierPerformance/dailyEvaluation/evaluationFormat/content/batchAdding.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/contractManage/supplierPerformance/dailyEvaluation/evaluationFormat/content/batchAdding.vue","mtime":1597628790261},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport * as api from \"@/api/project/srm/contractManage/evaluationFormat\"\nimport { DICT_CODE } from '@/utils/constant'\nimport caiGou from '@/components/Select/xtpt/caigou'//下拉组件\nimport { mapState } from \"vuex\"\nimport addMainSub from '../dialog/addMainSub'//下拉组件\nimport setModel from '../dialog/setModel'//下拉组件\nimport search from '../dialog/search'//下拉组件\nimport dialogGysxz from '@/components/Dialog/dialogsGysxz'//供应商选择\nimport evaluatePlan from '@/components/Dialog/evaluatePlan.vue'//主数据物料选择\nexport default {\n    components: { addMainSub, setModel, search, caiGou, dialogGysxz, evaluatePlan },\n    data () {\n        return {\n            Edit: false,\n            status: null,\n            selectStatus: false,\n            type: null,\n            DICT_CODE: DICT_CODE,\n            temp: {\n                rowId: undefined,\n                orgCode: undefined,\n                orgName: undefined,\n                evaluationPlanNo: undefined,\n                supplierCode: undefined,\n                supplierName: undefined,\n                years: undefined,\n                settlementMethod: undefined,\n                remark: undefined\n            },\n            list: [],\n            listSub: [],\n            rules: {\n                orgCode: [{ required: true, message: '组织编码不能为空', trigger: 'blur' }],\n                approvalType: [{ required: true, message: '审批类型不能为空', trigger: 'blur' }],\n                supplierCode: [{ required: true, message: '供应商编码不能为空', trigger: 'blur' }],\n                years: [{ required: true, message: '年度不能为空', trigger: 'blur' }],\n            }\n        }\n    },\n    computed: {\n        ...mapState({\n            dt_srm_pak: state => state.dict.dt_srm_pak,\n            dt_srm_pb1: state => state.dict.dt_srm_pb1,\n        })\n    },\n    mounted () {\n        this.$store.dispatch(\"dict/getDicData\", ['dt_srm_pak', 'dt_srm_pb1'])\n    },\n    methods: {\n        initForm (status, val) {\n            this.$refs['dataForm'].resetFields()\n            this.$refs['dataForm'].clearValidate()\n            this.status = status\n            if (status == 'update') {\n                // this.temp = val\n                for (let key in this.temp) {\n                    for (let par in val) {\n                        if (key === par) {\n                            this.$set(this.temp, key, val[key])\n                        }\n                    }\n                }\n                let options = [this.dt_srm_pc6]\n                val.approvalItemDTOS = this.$myFun.srmCodeToName(val.approvalItemDTOS, options, ['dataSource'])\n                this.list = val.approvalItemDTOS\n                console.log(this.list, 'this.list')\n                this.Edit = true //编辑得时候置灰\n            } else {\n                this.Edit = false\n                // this.list = []\n            }\n        },\n        //获取组织编码名称\n        selectName (val) {\n            this.temp.orgName = val\n        },\n        //批量新增\n        handleCreate () {\n            this.$refs.refGys.dialogVisible = true\n            this.$refs.refGys.getList()\n            this.$refs.refGys.listSelected = [...this.list]\n        },\n        //批量设置评价模型\n        handleSetmodel () {\n            this.$refs.setModel.dialogVisible = true\n            this.$refs.setModel.listSelected = [...this.listSub]\n            this.$refs.setModel.getList()\n        },\n        handleConfirm (val) {\n            if (this.selectStatus == true) {\n                this.listSub.push(JSON.parse(JSON.stringify(val)))\n            } else {\n                this.listSub = val\n            }\n        },\n        //供应商确定\n        handleGysClick (val) {\n            this.list = val\n        },\n        //评价计划号选择\n        showPlanCode () {\n            if (this.temp.orgCode) {\n                this.$refs.refPlan.dialogVisible = true\n                this.$refs.refPlan.getList()\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请先选择组织编码\",\n                    type: \"warning\"\n                })\n            }\n        },\n        handlePlanClick (val) {\n            console.log(val, 'val')\n            this.$set(this.temp, 'evaluationPlanNo', val[0].evaluationPlanNo)\n            this.$set(this.temp, 'evaluationStageCN', val[0].evaluationStageCN)\n            this.$set(this.temp, 'evaluationStage', val[0].evaluationStage)\n\n        },\n        handleClose () {\n            this.$emit('changeState', 'manage')\n        },\n        //保存按钮单击事件\n        handleSave () {\n            this.$refs.dataForm.validate(valid => {\n                if (valid) {\n                    let dto = {\n\n                    }\n                    api.addRecord(dto).then(() => {\n                        this.$message({\n                            title: '成功',\n                            message: '新增成功',\n                            type: 'success',\n                            duration: 2000\n                        })\n                        this.dialogVisible = false\n                        this.$emit('refresh')\n                    })\n                } else {\n                    return false\n                }\n            })\n        },\n        //表格操作删除\n        handleDelete (index, row) {\n            console.log('删除', index, row)\n            this.$confirm('确认要删除该数据项吗?', '提示', {\n                confirmButtonText: '确定',\n                cancelButtonText: '取消',\n                type: 'warning'\n            }).then(() => {\n                this.list = this.list.filter(item => {\n                    let isD = true\n                    if (row.rowId === item.rowId) {\n                        isD = false\n                    }\n                    return isD\n                })\n\n                this.$message({\n                    type: 'success',\n                    message: '删除成功'\n                })\n            }).catch(() => {\n                this.$message({\n                    type: 'info',\n                    message: '已取消'\n                })\n            })\n        },\n        handleDeleteModel (index, row) {\n            this.$confirm('确认要删除该数据项吗?', '提示', {\n                confirmButtonText: '确定',\n                cancelButtonText: '取消',\n                type: 'warning'\n            }).then(() => {\n                this.listSub = this.listSub.filter(item => {\n                    let isD = true\n                    if (row.dictItemKey === item.dictItemKey) {\n                        isD = false\n                    }\n                    return isD\n                })\n                this.$message({\n                    type: 'success',\n                    message: '删除成功'\n                })\n            }).catch(() => {\n                this.$message({\n                    type: 'info',\n                    message: '已取消'\n                })\n            })\n        }\n    }\n}\n",null]}