{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/contractManage/contractTemplate/supplierFeedback/dialog/addMain.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/contractManage/contractTemplate/supplierFeedback/dialog/addMain.vue","mtime":1596610933614},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport * as api from \"@/api/project/srm/contractManage/specialPaymentMethod\"\nimport { mapState } from \"vuex\"\nimport dialogGysxz from '@/components/Dialog/dialogsGysxz'//供应商选择\nexport default {\n    components: { dialogGysxz },\n    data () {\n        return {\n            dialogStatus: '',\n            dialogVisible: false,\n            temp: {\n                rowId: undefined,\n                feedbackPaymentType: undefined,\n                feedbackPaymentPeriod: undefined,\n                feedbackSettlementType: undefined\n            },\n            showIsItem: false,\n            rules: {\n                feedbackSettlementType: [{ required: true, message: '结算方式不能为空', trigger: 'blur' }],\n                feedbackPaymentType: [{ required: true, message: '付款方式不能为空', trigger: 'blur' }],\n                feedbackPaymentPeriod: [{ required: true, message: '付款周期不能为空', trigger: 'blur' }],\n            }\n        }\n    },\n    computed: {\n        ...mapState({\n            dt_srm_pdr: state => state.dict.dt_srm_pdr,\n            dt_srm_pdt: state => state.dict.dt_srm_pdt,\n            dt_srm_pdu: state => state.dict.dt_srm_pdu,\n            dt_srm_pan: state => state.dict.dt_srm_pan,\n        })\n    },\n    mounted () {\n        this.$store.dispatch(\"dict/getDicData\", [\"dt_srm_pdr\", 'dt_srm_pdt', 'dt_srm_pdu', 'dt_srm_pan'])\n    },\n    methods: {\n        handleSupplier () {\n            this.$refs.refGys.dialogVisible = true\n        },\n        //供应商选择确定\n        handleGysClick (val) {\n            this.$set(this.temp, 'supplierCode', val[0].supplierCode)\n            this.$set(this.temp, 'supplierName', val[0].supplierName)\n        },\n        //付款方式项是否展示\n        showItem () {\n            if (this.temp.feedbackResult === '1') {\n                this.showIsItem = false\n            } else {\n                this.showIsItem = true\n            }\n            if (this.showIsItem === true) {\n                delete this.temp.feedbackSettlementType\n                delete this.temp.feedbackPaymentType\n                delete this.temp.feedbackPaymentPeriod\n            }\n        },\n        //结算方式\n        getSettlementType (val) {\n            let dictList = this.dt_srm_pdt.filter(v => {\n                return v.dictItemKey === val\n            })\n            this.temp.feedbackSettlementTypeCN = dictList[0].dictItemValue\n        },\n        //付款方式\n        getPaymentType (val) {\n            let dictList = this.dt_srm_pdr.filter(v => {\n                return v.dictItemKey === val\n            })\n            this.temp.feedbackPaymentTypeCN = dictList[0].dictItemValue\n        },\n        //付款周期\n        getPaymentPeriod (val) {\n            let dictList = this.dt_srm_pdu.filter(v => {\n                return v.dictItemKey === val\n            })\n            this.temp.feedbackPaymentPeriodCN = dictList[0].dictItemValue\n        },\n        //编辑弹框确定事件\n        updateData () {\n            if (this.showIsItem === true) {\n                this.$refs.dataForm.validate(valid => {\n                    if (valid) {\n                        let a = this.temp.feedbackPaymentTypeCN + '/' + this.temp.feedbackPaymentPeriodCN + '/' + this.temp.feedbackSettlementTypeCN\n                        if (a !== this.temp.regularPayment) {\n                            let dto = {\n                                feedbackExplain: this.temp.feedbackExplain,\n                                feedbackPaymentPeriod: this.temp.feedbackPaymentPeriod,\n                                feedbackPaymentType: this.temp.feedbackPaymentType,\n                                feedbackResult: this.temp.feedbackResult,\n                                feedbackSettlementType: this.temp.feedbackSettlementType\n                            }\n                            api.updateRecord(this.temp.rowId, dto).then(() => {\n                                this.$message({\n                                    title: '成功',\n                                    message: '编辑成功',\n                                    type: 'success',\n                                    duration: 2000\n                                })\n                                this.dialogVisible = false\n                                this.$emit('refresh')\n                            })\n                        } else {\n                            this.$message({\n                                title: '警告',\n                                message: '付款方式内容相同请重输',\n                                type: 'warning',\n                                duration: 2000\n                            })\n                        }\n                    } else {\n                        return false\n                    }\n                })\n            } else {\n                let dto = {\n                    feedbackExplain: this.temp.feedbackExplain,\n                    feedbackPaymentPeriod: this.temp.feedbackPaymentPeriod,\n                    feedbackPaymentType: this.temp.feedbackPaymentType,\n                    feedbackResult: this.temp.feedbackResult,\n                    feedbackSettlementType: this.temp.feedbackSettlementType\n                }\n                console.log(dto, 'kkk')\n                api.updateRecord(this.temp.rowId, dto).then(() => {\n                    this.$message({\n                        title: '成功',\n                        message: '新增成功',\n                        type: 'success',\n                        duration: 2000\n                    })\n                    this.dialogVisible = false\n                    this.$emit('refresh')\n                })\n            }\n\n        },\n    }\n}\n",null]}