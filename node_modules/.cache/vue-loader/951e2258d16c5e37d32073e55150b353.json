{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/supplierManagement/supplierChange/supplierModification/Tab/tab1.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/supplierManagement/supplierChange/supplierModification/Tab/tab1.vue","mtime":1596610933959},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport * as api from \"@/api/project/srm/supplierManagement/supplierRegister\"\nimport * as api1 from '@/api/project/srm/supplierManage/supplierConfigure'\nimport { mapState } from \"vuex\"\n\nexport default {\n    data () {\n        let validatePhoneTwo = (rule, value, callback) => {\n            const reg = /^\\d{6}$/\n            if (value == '' || value == undefined || value == null) {\n                callback()\n            } else {\n                if ((!reg.test(value)) && value != '') {\n                    callback(new Error('请输入正确的邮编'))\n                } else {\n                    callback()\n                }\n            }\n        }\n        let validateMoney = (rule, value, callback) => {\n            const reg = /(^[1-9]\\d{0,7}$)/\n            if (value == '' || value == undefined || value == null) {\n                callback()\n            } else {\n                if ((!reg.test(value)) && value != '') {\n                    callback(new Error('请输入正确的金额'))\n                } else {\n                    callback()\n                }\n            }\n        }\n        let validatePercentage = (rule, value, callback) => {\n            const reg = /^(100|[1-9]?\\d(\\.\\d\\d?\\d?)?)%$|0$/\n            if (value == '' || value == undefined || value == null) {\n                callback()\n            } else {\n                if ((!reg.test(value)) && value != '') {\n                    callback(new Error('请输入正确的百分比'))\n                } else {\n                    callback()\n                }\n            }\n        }\n        let validatePerson = (rule, value, callback) => {\n            const reg = /(^[1-9]\\d{0,7}$)/\n            if (value == '' || value == undefined || value == null) {\n                callback()\n            } else {\n                if ((!reg.test(value)) && value != '') {\n                    callback(new Error('请输入首位不为0的1-8位数'))\n                } else {\n                    callback()\n                }\n            }\n        }\n        let validateArea = (rule, value, callback) => {\n            const reg = /(^[1-9]\\d{0,9}$)/\n            if (value == '' || value == undefined || value == null) {\n                callback()\n            } else {\n                if ((!reg.test(value)) && value != '') {\n                    callback(new Error('请输入首位不为0的1-10位数'))\n                } else {\n                    callback()\n                }\n            }\n        }\n        return {\n            rowId: null,\n            edit: false,\n            mainFactory: [],\n            country: [],\n            province: [],\n            city: [],\n            mainList: {\n                supplierCode: undefined,\n                supplierName: undefined,\n                supplierShortName: undefined,\n                legalPerson: undefined,\n                registeredAddress: undefined,\n                enterpriseCode: undefined,\n                specialPermit: undefined,\n                businessLicense: undefined,\n                taxRegistrationCertificate: undefined,\n                specialTaxPolicy: undefined,\n                bank: undefined,\n\n            },\n            obj: {\n                supplierCode: 'no',\n                supplierName: 'no',\n                supplierShortName: 'no',\n                legalPerson: 'no',\n                registeredAddress: 'no',\n                enterpriseCode: 'no',\n                specialPermit: 'no',\n                businessLicense: 'no',\n                taxRegistrationCertificate: 'no',\n                specialTaxPolicy: 'no',\n                bank: 'no',\n                account: 'no',\n                paymentWay: 'no',\n                settlementPeriod: 'no',\n                enterpriseType: 'no',\n                classification: 'no',\n                supplyClassification: 'no',\n                supplierType: 'no',\n                frozenState: 'no',\n                cooperationType: 'no',\n                country: 'no',\n                province: 'no',\n                city: 'no',\n                grade: 'no',\n                mainFactory: 'no',\n                contacts: 'no',\n                telephone: 'no',\n                email: 'no',\n                fax: 'no',\n                postalCode: 'no',\n                contactAddress: 'no',\n                registeredCapital: 'no',\n                fixedAssets: 'no',\n                mainVenture: 'no',\n                shareRatio: 'no',\n                area: 'no',\n                website: 'no',\n                workerNumber: 'no',\n                enterpriseNumber: 'no',\n                manageNumber: 'no',\n                technologyNumber: 'no',\n                establishmentTime: 'no',\n                recommendedUnit: 'no',\n                profile: 'no',\n\n            },\n            activeCollNames: ['1', '2', '3'],\n            rules: {\n                supplierName: [{ required: true, message: '供应商名称不能为空', trigger: 'blur' }],\n                supplierShortName: [{ required: true, message: '供应商简称不能为空', trigger: 'blur' }],\n                legalPerson: [{ required: true, message: '法人代表不能为空', trigger: 'blur' }],\n                registeredAddress: [{ required: true, message: '注册地址不能为空', trigger: 'blur' }],\n                enterpriseCode: [{ required: true, message: '企业代码不能为空', trigger: 'blur' }],\n                businessLicense: [{ required: true, message: '营业执照不能为空', trigger: 'blur' }],\n                specialPermit: [{ required: true, message: '特殊许可证不能为空', trigger: 'blur' }],\n                email: [\n                    { required: false, message: '请输入邮箱地址', trigger: 'blur' },\n                    { type: 'email', message: '请输入正确的邮箱地址', trigger: ['blur', 'change'] }\n                ],\n                postalCode: [\n                    { required: false, message: \"请输入邮编\", trigger: \"blur\" },\n                    { validator: validatePhoneTwo, trigger: \"blur\" }\n                ],\n                registeredCapital: [\n                    { validator: validateMoney, trigger: \"blur\", message: \"请输入首位不为0的1-8位数\" }\n                ],\n                fixedAssets: [\n                    { validator: validateMoney, trigger: \"blur\", message: \"请输入首位不为0的1-8位数\", }\n                ],\n                shareRatio: [\n                    { validator: validatePercentage, trigger: \"blur\" }\n                ],\n                workerNumber: [\n                    { validator: validatePerson, trigger: \"blur\" }\n                ],\n                enterpriseNumber: [\n                    { validator: validatePerson, trigger: \"blur\" }\n                ],\n                manageNumber: [\n                    { validator: validatePerson, trigger: \"blur\" }\n                ],\n                technologyNumber: [\n                    { validator: validatePerson, trigger: \"blur\" }\n                ],\n                area: [\n                    { validator: validateArea, trigger: \"blur\" }\n                ]\n            }\n\n        }\n    },\n    computed: {\n        ...mapState({\n            dt_srm_pa2: state => state.dict.dt_srm_pa2,\n            dt_srm_pa3: state => state.dict.dt_srm_pa3,\n            dt_srm_pa1: state => state.dict.dt_srm_pa1,\n            dt_srm_pa5: state => state.dict.dt_srm_pa5,\n            dt_srm_pa6: state => state.dict.dt_srm_pa6,\n            dt_srm_pay: state => state.dict.dt_srm_pay,\n            dt_srm_pax: state => state.dict.dt_srm_pax,\n        })\n    },\n    mounted () {\n        this.$store.dispatch(\"dict/getDicData\", [\"dt_srm_pa2\", \"dt_srm_pa3\", \"dt_srm_pa1\", \"dt_srm_pa5\", \"dt_srm_pa6\", \"dt_srm_pay\", \"dt_srm_pax\"])\n    },\n    methods: {\n        setTabData (val) {\n            this.mainList = val\n            console.log(this.mainList, val, 56789)\n        },\n        getList (row) {\n            let a = {\n                rowId: row.rowId\n            }\n            api.updateRecords(a).then(res => {\n                this.mainList = res.data.baseInfoDTO\n            })\n        },\n        getListCompare () {\n            let a = {\n                state: 'P002',\n                changeMode: 'PAR0'\n            }\n            api1.queryRecords(a).then(res => {\n                this.rowId = res.data.map(v => {\n                    return v.rowId\n                })\n                let saveData = new Promise((resolve, reject) => {\n                    console.log(reject)\n                    let saveList = []\n                    this.rowId.forEach(v => {\n                        api1.queryRecordItem(v).then(res => {\n                            saveList.push(res.data)\n                            if (this.rowId.length == saveList.length) {\n                                resolve(saveList)\n                            }\n                        })\n                    })\n                })\n                saveData.then(res => {\n                    res.forEach(item => {\n                        item.forEach(v => {\n                            Object.keys(this.mainList).forEach(n => {\n                                if (v.fieldCode !== n) {\n                                    this.obj[v.fieldCode] = 'yes'\n                                } else {\n                                    this.obj[v.fieldCode] = 'no'\n                                }\n                            })\n\n\n                        })\n                    })\n                })\n            })\n        },\n        //获取国家下拉列表方法\n        getCountry () {\n            let a = {\n                areatype: 'country'\n            }\n            api.queryRecordArea(a).then(res => {\n                this.country = res.data\n            })\n        },\n        //获取省份下拉列表方法\n        getProvince () {\n            if (this.mainList.country) {\n                let a = {\n                    areatype: 'province',\n                    equalcode: this.mainList.country\n                }\n                api.queryRecordArea(a).then(res => {\n                    this.province = res.data\n                    console.log(res.data, '777')\n                    this.$set(this.mainList, 'province')\n                })\n            } else {\n                this.province = []\n                this.mainList.province = undefined\n            }\n\n        },\n        //获取城市下拉列表方法\n        getCity () {\n            if (this.mainList.province && this.mainList.country) {\n                let a = {\n                    areatype: 'city',\n                    equalcode: this.mainList.province\n                }\n                api.queryRecordArea(a).then(res => {\n                    this.city = res.data\n                    this.$set(this.mainList, 'city')\n                })\n            } else {\n                this.city = []\n                this.mainList.city = undefined\n            }\n\n        },\n        //获取工厂下拉列表方法\n        getFactory (row) {\n            api.queryRecordFactory(row.rowId).then(res => {\n                this.mainFactory = res.data\n            })\n        },\n        resetTemp () {\n            this.mainList = {\n                supplierCode: undefined,\n                supplierName: undefined,\n                supplierShortName: undefined,\n                legalPerson: undefined,\n                registeredAddress: undefined,\n                enterpriseCode: undefined,\n                specialPermit: undefined,\n                businessLicense: undefined,\n                taxRegistrationCertificate: undefined,\n                specialTaxPolicy: undefined,\n                bank: undefined,\n                account: undefined,\n                paymentWay: undefined,\n                settlementPeriod: undefined,\n                enterpriseType: undefined,\n                classification: undefined,\n                supplyClassification: undefined,\n                supplierType: undefined,\n                frozenState: undefined,\n                cooperationType: undefined,\n                country: undefined,\n                province: undefined,\n                city: undefined,\n                grade: undefined,\n                mainFactory: undefined,\n                contacts: undefined,\n                telephone: undefined,\n                email: undefined,\n                fax: undefined,\n                postalCode: undefined,\n                contactAddress: undefined,\n                registeredCapital: undefined,\n                fixedAssets: undefined,\n                mainVenture: undefined,\n                shareRatio: undefined,\n                area: undefined,\n                website: undefined,\n                workerNumber: undefined,\n                enterpriseNumber: undefined,\n                manageNumber: undefined,\n                technologyNumber: undefined,\n                establishmentTime: undefined,\n                recommendedUnit: undefined,\n                profile: undefined,\n            }\n        }\n    }\n\n}\n",null]}