{"remainingRequest":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/cf_web/src/views/system/taskConfiguration/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/cf_web/src/views/system/taskConfiguration/index.vue","mtime":1600927611550},{"path":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport * as api from \"@/api/system/task_configuration\";\nimport Pagination from \"@/components/Pagination\";\nimport explain from \"./explain\"; //cron说明\nimport logView from \"./logView\"; //日志查看\nimport { mapState } from 'vuex';\nimport { getDomainId } from \"@/utils/auth\";\nimport { TWO_isAsync_OPTIONS } from \"@/utils/constant\";\n\n\nexport default {\n    name: \"taskConfiguration\",\n    components: { Pagination, explain, logView },\n    data () {\n        let validatePhoneTwo = (rule, value, callback) => {\n            const reg = /^(|(1[34578]\\d{9}))$/;\n            if (value == '' || value == undefined || value == null) {\n                callback();\n            } else {\n                if ((!reg.test(value)) && value != '') {\n                    callback(new Error('请输入正确的电话号码'));\n                } else {\n                    callback();\n                }\n            }\n        };\n        return {\n            list: null,\n            total: 0,\n            flag: false,\n            theight: 0,//表格高度\n            listQuery: {\n                currentPage: 1,\n                pageSize: 15,\n            },\n            taskUpdateStatusDTO: {\n                jobGroup: undefined,\n                jobName: undefined,\n                rowId: undefined,\n                status: undefined\n            },\n            TWO_isAsync_OPTIONS: TWO_isAsync_OPTIONS,\n            temp: {\n                status: 1,\n                remark: undefined,\n                creator: getDomainId()\n            },\n            colorCode: undefined,\n            selectCode: [],\n            dialogFormVisible: false,\n            explainDialogFormVisible: false,\n            logDialogFormVisible: false,\n            dialogStatus: \"\",\n            tableKey: 0,\n            rules: {\n                email: [\n                    { required: true, message: '请输入邮箱地址', trigger: 'blur' },\n                    { type: 'email', message: '请输入正确的邮箱地址', trigger: ['blur', 'change'] }\n                ],\n                telephone: [\n                    { required: true, message: \"电话不能为空\", trigger: \"blur\" },\n                    { validator: validatePhoneTwo, trigger: \"blur\" }\n                ]\n            }\n        };\n    },\n    computed: {\n        ...mapState({\n            dt_implement_type: state => state.dict.dt_implement_type\n        })\n\n    },\n    mounted () {\n        this.$store.dispatch(\"dict/getDicData\", [\n            \"dt_implement_type\"\n        ]);\n        this.setTableHeight();\n        //表格高度自适应\n        window.onresize = () => {\n            this.setTableHeight()\n        };\n        this.getList();\n    },\n    created () {\n        this.getList();\n    },\n    filters: {\n        statusFilter: function (a) {\n            if (a === 1) {\n                return \"有效\"\n            } else {\n                return \"无效\"\n            }\n        },\n        isAsyncFilter: function (b) {\n            if (b === 1) {\n                return \"同步\"\n            } else {\n                return \"异步\"\n            }\n        },\n        typeFilter: function (c) {\n            if (c === \"it1\") {\n                return \"Spring服务\"\n            }\n        }\n    },\n    methods: {\n        getList () {\n            api.queryRecords(this.listQuery).then(res => {\n                this.list = res.data.list;\n                this.total = res.data.pages.count;\n            });\n        },\n        //表格高度计算\n        setTableHeight () {\n            this.theight = this.$myFun.getSingleTbHeight();\n        },\n        handleExplain () {\n            this.explainDialogFormVisible = true\n        },\n        handleQuery () {//查询\n            this.listQuery.currentPage = 1;\n            this.getList();\n        },\n        handleCreate () {//新增\n            this.resetTemp();\n            this.flag = false\n            this.dialogStatus = \"create\";\n            this.dialogFormVisible = true;\n        },\n        create () {//新增确认按钮\n            this.$refs.temp.validate(valid => {\n                if (valid) {\n                    api.addRecord(this.temp).then(() => {\n                        this.getList();\n                        this.dialogFormVisible = false;\n                        this.$message({\n                            title: \"成功\",\n                            message: \"新增成功\",\n                            type: \"success\",\n                            duration: 2000\n                        });\n                    });\n                } else {\n                    return false;\n                }\n            });\n        },\n        // 获取表格选中时的数据\n        selectRow (val) {\n            this.selectlistRow = val[val.length - 1];\n            if (val.length > 1) {\n                this.$refs.tb.clearSelection();\n                this.$refs.tb.toggleRowSelection(val.pop());\n            }\n\n        },\n\n        handleUpdate () {//编辑弹窗\n            if (this.selectlistRow) {\n                this.temp = this.selectlistRow\n                this.flag = true\n                this.dialogStatus = \"update\";\n                this.dialogFormVisible = true;\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        update () {//编辑提交\n            this.$refs[\"temp\"].validate(valid => {\n                if (valid) {\n                    this.temp.updator = getDomainId()\n                    api.updateRecord(this.temp).then(\n                        () => {\n                            this.getList();\n                            this.dialogFormVisible = false;\n                            this.$message({\n                                title: \"成功\",\n                                message: \"更新成功\",\n                                type: \"success\",\n                                duration: 2000\n                            });\n                        }\n                    );\n                }\n            });\n        },\n\n        handleDelete () {//删除列表\n            if (this.selectlistRow) {\n                this.$confirm(\"此操作将永久删除该文件, 是否继续?\", \"提示\", {\n                    confirmButtonText: \"确定\",\n                    cancelButtonText: \"取消\",\n                    type: \"warning\"\n                }).then(() => {\n                    api.deleteRecord(this.selectlistRow.rowId, this.selectlistRow.jobGroup, this.selectlistRow.jobName).then(() => {\n                        this.getList(),\n                            this.$message({\n                                title: \"成功\",\n                                message: \"删除成功\",\n                                type: \"success\",\n                                duration: 2000\n                            });\n                    });\n                }).catch(() => {\n                    this.$message({\n                        type: \"info\",\n                        message: \"已取消删除\"\n                    });\n                });\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        handleEnforcement () { //强制执行\n            if (this.selectlistRow) {\n                this.taskUpdateStatusDTO.jobGroup = this.selectlistRow.jobGroup\n                this.taskUpdateStatusDTO.jobName = this.selectlistRow.jobName\n                this.taskUpdateStatusDTO.rowId = this.selectlistRow.rowId\n                this.taskUpdateStatusDTO.status = this.selectlistRow.status\n                api.suspendRecord(this.taskUpdateStatusDTO).then(() => {\n                    this.getList()\n                    this.$message({\n                        title: \"成功\",\n                        message: \"强制执行成功\",\n                        type: \"success\",\n                        duration: 2000\n                    });\n                })\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        handleSuspend () { //挂起激活\n            if (this.selectlistRow) {\n                this.taskUpdateStatusDTO.jobGroup = this.selectlistRow.jobGroup\n                this.taskUpdateStatusDTO.jobName = this.selectlistRow.jobName\n                this.taskUpdateStatusDTO.rowId = this.selectlistRow.rowId\n                this.taskUpdateStatusDTO.status = this.selectlistRow.status\n                api.suspendRecord(this.taskUpdateStatusDTO).then(() => {\n                    this.getList()\n                    this.$message({\n                        title: \"成功\",\n                        message: \"挂起/激活成功\",\n                        type: \"success\",\n                        duration: 2000\n                    });\n                })\n            } else {\n                this.$message({\n                    title: \"警告\",\n                    message: \"请选择一条信息\",\n                    type: \"warning\"\n                });\n            }\n        },\n        handleLog () { //日志查看\n            // this.$refs.log.listQuery.jobCoding='',\n            // this.$refs.log.listQuery.jobName='',\n            // this.$refs.log.value3='',\n            // this.$refs.log.list=[],\n            this.logDialogFormVisible = true\n        },\n        cancel () {//取消弹窗按钮\n            this.dialogFormVisible = false;\n        },\n        resetTemp () {\n            this.temp = {\n                status: 1,\n                remark: undefined,\n                flag: false,\n                creator: getDomainId()\n            };\n        },\n        handleClose () {\n            this.resetTemp();\n            this.$refs.temp.resetFields();\n        },\n\n    }\n};\n",null]}