{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/MES/productionExecution/uploadMaterial/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/MES/productionExecution/uploadMaterial/index.vue","mtime":1596610933587},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n// import Pagination from '@/components/Pagination'\nimport * as api from '@/api/project/mes/productionExecution/uploadMaterial'\n// import { mapState } from 'vuex' // 基本数据引入\nimport { getWorkstation } from '@/utils/auth'\n\nexport default {\n    name: 'uploadMaterial',\n    // components: { Pagination },\n    data () {\n        return {\n            status: undefined,\n            workOrderList: [],\n            temp: {\n                stationCode: getWorkstation(),\n                workOrderCode: undefined,\n                workOrderCodeTemp: undefined,\n                barCode: undefined,\n                materielCode: undefined,\n                materielName: undefined,\n                quantity: undefined,\n                supplierName: undefined\n            },\n            listQuery: {\n                queryStateParam: 'START'\n            }\n        }\n    },\n    created () {\n        this.getList()\n    },\n    methods: {\n        queryMaterial () {\n            if (!this.temp.workOrderCode) {\n                this.$message({\n                    title: '警告',\n                    message: '请选择随工单号',\n                    type: 'warning'\n                })\n                return\n            }\n            if (!this.temp.stationCode) {\n                this.$message({\n                    title: '警告',\n                    message: '请在登录时选择工位',\n                    type: 'warning'\n                })\n                return\n            }\n            if (!this.temp.barCode) {\n                this.$message({\n                    title: '警告',\n                    message: '请输入条码',\n                    type: 'warning'\n                })\n                return\n            }\n            api.queryRecords(this.temp.barCode, {\n                barcodeSearchEnum: 'FIVE'\n            }).then(res => {\n                this.status = res.data.materielCode\n                if (res.data.materielCode) {\n                    this.temp.materielCode = res.data.materielCode\n                    this.temp.materielName = res.data.materielName\n                    this.temp.supplierName = res.data.supplierName\n                } else {\n                    this.$message({\n                        title: '警告',\n                        message: '搜不到物料请重新输入条码查询',\n                        type: 'warning'\n                    })\n                }\n            })\n        },\n        upload () {\n            if (this.temp.barCode) {\n                if (this.status !== undefined) {\n                    this.temp.materialNo = this.temp.materielCode\n                    this.temp.materialBarCode = this.temp.barCode\n                    if (this.temp.quantity) {\n                        api.loadMaterial(this.temp).then(res => {\n                            if (res.status == 201) {\n                                this.$message({\n                                    title: '成功',\n                                    message: '上料成功',\n                                    type: 'success'\n                                })\n                                this.resetTemp()\n                            }\n                        })\n                    } else {\n                        this.$message({\n                            title: '警告',\n                            message: '数量不能为空',\n                            type: 'warning'\n                        })\n                    }\n\n                } else {\n                    this.$message({\n                        title: '警告',\n                        message: '搜不到物料请重新输入条码查询',\n                        type: 'warning'\n                    })\n                }\n\n            } else {\n                this.$message({\n                    title: '警告',\n                    message: '请输入条码',\n                    type: 'warning'\n                })\n            }\n\n        },\n        getList () {\n            //查询随工单\n            api.queryWorkOrder(this.listQuery).then(res => {\n                this.workOrderList = res.data\n            })\n        },\n        resetTemp () {\n            this.temp = {\n                stationCode: getWorkstation(),\n                workOrderCode: undefined,\n                workOrderCodeTemp: undefined,\n                barCode: undefined,\n                materielCode: undefined,\n                materielName: undefined,\n                quantity: undefined,\n                supplierName: undefined\n            }\n        },\n        confirm () {\n            this.temp.workOrderCodeTemp = this.temp.workOrderCode\n        },\n        handleClose () {\n            this.resetTemp()\n            this.$refs.temp.resetFields()\n        }\n    }\n}\n",null]}