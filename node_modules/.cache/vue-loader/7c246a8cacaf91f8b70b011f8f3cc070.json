{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/priceManage/supplierQuote/detailQuoteNote/Dialog/dialogAdd.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/priceManage/supplierQuote/detailQuoteNote/Dialog/dialogAdd.vue","mtime":1596610933725},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport * as api from \"@/api/project/srm/priceManage/detailQuoteNote\"\nimport { DICT_CODE } from '@/utils/constant'\nimport caiGou from '@/components/Select/xtpt/caigou'//下拉组件\nimport { mapState } from \"vuex\"\nimport dialogWlxzg from '@/components/Dialog/dialogGhxl'\nimport throttle from 'lodash/throttle'\n\nexport default {\n    name: 'addMain',\n    components: { caiGou, dialogWlxzg },\n    props: ['unMutiple', 'title', 'curdialogStatus'],\n    data () {\n        return {\n            DICT_CODE: DICT_CODE,\n            list: [],\n            temp: {\n                orgCode: null,\n                supplierCoode: null,\n                quoteType: null,\n                endTime: null,\n                dateRange: null,\n                mainContent: null,\n                commendInfo: null,\n            },\n            // tableDetails: [],\n            listSelected: null,//已选项\n            selectRowData: null,\n            dialogVisible: false,\n            dialogStatus: '',\n            rules: {\n                purchaseOrg: [{ required: true, message: '采购组织不能为空', trigger: 'blur' }],\n                quotationMethod: [{ required: true, message: '报价类型不能为空', trigger: 'blur' }],\n                validDateEnd: [{ required: true, message: '报价有效期止不能为空', trigger: 'blur' }],\n            }\n        }\n    },\n    computed: {\n        ...mapState({\n            dt_srm_pdi: state => state.dict.dt_srm_pdi,\n        })\n    },\n    mounted () {\n        this.$store.dispatch(\"dict/getDicData\", [\"dt_srm_pdi\"])\n    },\n    methods: {\n        //获取组织编码名称\n        selectName (val) {\n            this.temp.purchaseOrgName = val\n        },\n        handleCreate () {\n            this.$nextTick(() => {\n                this.$refs.refWlxzg.listSelected = [...this.list]\n                this.$refs.refWlxzg.getList()\n            })\n            this.$refs.refWlxzg.dialogVisible = true\n\n        },\n        handleClose () {\n            this.$refs.dataForm.resetFields()\n        },\n        //供货线路信息确认\n        confirmWlxzg (wdata) {\n            console.log('供货线路信息确认', wdata)\n            this.list = wdata\n        },\n        //新增确定按钮单击事件\n        addData: throttle(function () {\n            this.$refs.dataForm.validate(valid => {\n                if (valid) {\n                    let dto = {\n                        purchaseOrg: this.temp.purchaseOrg,\n                        purchaseOrgName: this.temp.purchaseOrgName,\n                        quotationMethod: this.temp.quotationMethod,\n                        quotationRequirements: this.temp.quotationRequirements,\n                        remark: this.temp.remark,\n                        validDateEnd: this.temp.validDateEnd,\n                        notificationItemDTOS: this.list.map(v => {\n                            v.materielCode = v.materialCode\n                            v.materielName = v.materialName\n                            return v\n                        })\n                    }\n                    api.createRecords(dto).then(() => {\n                        this.$message({\n                            title: '成功',\n                            message: '新增成功',\n                            type: 'success',\n                            duration: 2000\n                        })\n                        this.dialogVisible = false\n                        this.$emit('refresh')\n                    })\n                } else {\n                    return false\n                }\n            })\n        }, 2000,\n            {\n                leading: true,\n                trailing: false\n            }\n        ),\n        updateData () {\n\n        },\n        handleConfirm () {\n            this.$refs.formData.validate((valid) => {\n                if (valid) {\n                    this.$confirm('确认保存吗?', '提示', {\n                        confirmButtonText: '确定',\n                        cancelButtonText: '取消',\n                        type: 'warning'\n                    }).then(() => {\n                        this.$emit('handleDialogClick', this.formData)\n                        this.dialogVisible = false\n                    }).catch(() => {\n                        this.$message({\n                            type: 'info',\n                            message: '已取消'\n                        })\n                    })\n                }\n            })\n        },\n        //表格操作删除\n        handleDelete (index, row) {\n            console.log('删除', index, row)\n            this.$confirm('确认要删除该数据项吗?', '提示', {\n                confirmButtonText: '确定',\n                cancelButtonText: '取消',\n                type: 'warning'\n            }).then(() => {\n                this.list = this.list.filter(item => {\n                    let isD = true\n                    if (row.rowId === item.rowId) {\n                        isD = false\n                    }\n                    return isD\n                })\n\n                this.$message({\n                    type: 'success',\n                    message: '删除成功'\n                })\n            }).catch(() => {\n                this.$message({\n                    type: 'info',\n                    message: '已取消'\n                })\n            })\n        },\n        resetTemp () {\n            this.temp = {\n                purchaseOrg: undefined,\n                quotationMethod: undefined,\n                validDateEnd: undefined,\n                remark: undefined,\n                quotationRequirements: undefined,\n\n            }\n        }\n    }\n}\n",null]}