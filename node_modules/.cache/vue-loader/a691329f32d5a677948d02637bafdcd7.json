{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/priceManage/supplierQuote/detailQuoteNote/Dialog/dialogBjsh.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/priceManage/supplierQuote/detailQuoteNote/Dialog/dialogBjsh.vue","mtime":1596610933726},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport * as api from \"@/api/project/srm/priceManage/detailQuoteNote\"\nexport default {\n    name: 'addMain',\n    props: ['unMutiple', 'title', 'curdialogStatus'],\n    data () {\n        return {\n            formData: {\n                noticeNo: null,\n                materielCode: null,\n                materielName: null,\n                latestQuote: null,\n                supplierCode: null,\n                supplierName: null,\n                tableDetails: []\n            },\n            // tableDetails: [],\n            listSelected: null,//已选项\n            selectRowData: null,\n            dialogVisible: false,\n            formConfig: [\n                { type: 'commonInput', label: '报价通知单号', prop: 'noticeNo', width: '' },\n                { type: 'commonInput', label: '物料编码', prop: 'materielCode', width: '' },\n                { type: 'commonInput', label: '物料名称', prop: 'materielName', width: '' },\n                { type: 'commonInput', label: '当前报价', prop: 'totalPrice', width: '' },\n                { type: 'commonInput', label: '供应商编码', prop: 'supplierCode', width: '' },\n                { type: 'commonInput', label: '供应商名称', prop: 'supplierName', width: '' },\n            ],\n            tableConfig: [\n                { label: '序号', prop: 'number', align: 'center', width: 'auto' },\n                { label: '报价轮次', prop: 'quoteTimes', align: 'center', width: 'auto' },\n                { label: '价格', prop: 'price', align: 'center', width: 'auto' },\n                { label: '报价时间', prop: 'quoteTime', align: 'center', width: 'auto' },\n                { label: '报价方式', prop: 'quoteTypeName', align: 'center', width: 'auto' }\n            ],\n            row: null\n        }\n    },\n    methods: {\n        //表格操作预览\n        handlePreview (index, row) {\n            console.log('预览', index, row)\n        },\n        setFormData (row) {\n            this.row = row\n            for (let key in this.formData) {\n                for (let par in row) {\n                    if (key === par) {\n                        this.$set(this.formData, key, row[key])\n                    }\n                }\n            }\n            this.formData.totalPrice = row.totalPrice\n            this.$set(this.formData, 'validDateEnd', undefined)\n        },\n        resetTemp () {\n            this.formData = {\n                validDateEnd: undefined\n            }\n        },\n        //确认报价\n        handleConfirmQuote () {\n            this.$confirm('确认要报价该数据项吗?', '提示', {\n                confirmButtonText: '确定',\n                cancelButtonText: '取消',\n                type: 'warning'\n            }).then(() => {\n                let dto = {\n                    method: 'confirm',\n                    validDateEnd: this.formData.validDateEnd,\n                    rowIds: [this.row.rowId]\n                }\n                api.confirmRecords(dto).then(() => {\n                    this.$message({\n                        title: '成功',\n                        message: '确认报价成功',\n                        type: 'success',\n                        duration: 2000\n                    })\n                    this.dialogVisible = false\n                    this.$emit('refresh')\n                })\n            }).catch(() => {\n                this.$message({\n                    type: 'info',\n                    message: '已取消'\n                })\n            })\n        },\n        //二次报价\n        handleSecondQuote () {\n            if (this.formData.validDateEnd) {\n                this.$confirm('确认要二次报价该数据项吗?', '提示', {\n                    confirmButtonText: '确定',\n                    cancelButtonText: '取消',\n                    type: 'warning'\n                }).then(() => {\n                    let dto = {\n                        method: 'requote',\n                        validDateEnd: this.formData.validDateEnd,\n                        rowIds: [this.row.rowId]\n                    }\n                    api.confirmRecords(dto).then(() => {\n                        this.$message({\n                            title: '成功',\n                            message: '二次报价成功',\n                            type: 'success',\n                            duration: 2000\n                        })\n                        this.dialogVisible = false\n                        this.$emit('refresh')\n                    })\n                }).catch(() => {\n                    this.$message({\n                        type: 'info',\n                        message: '已取消'\n                    })\n                })\n            } else {\n                this.$message({\n                    type: 'warning',\n                    message: '请先填写报价截止日期'\n                })\n            }\n        },\n        selectChange (val) {\n            if (this.unMutiple) {\n                this.selectOneRow(val)\n            } else {\n                this.selectRows(val)\n            }\n        },\n        selectRows (val) {\n            this.selectRowData = val\n            this.listSelected = this.selectRowData\n            // this.getDetail(val[val.length - 1]);\n            // this.$emit('clickRows' ,val,this.listSub);\n        },\n        selectOneRow (val) {\n            let arr = []\n            arr.push(val[val.length - 1])\n            this.selectRowData = arr\n            // if (arr[0]) {\n            //     this.getDetail(arr[0]);\n            // }\n            if (val.length > 1) {\n                this.$refs.tbselect.clearSelection()\n                this.$refs.tbselect.toggleRowSelection(val[val.length - 1], 'selected')\n            }\n            this.listSelected = this.selectRowData\n\n        }\n\n    }\n}\n",null]}