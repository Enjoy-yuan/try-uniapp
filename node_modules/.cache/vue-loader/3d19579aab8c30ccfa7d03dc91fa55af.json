{"remainingRequest":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/cf_web/src/views/data-base/ruleAttrDefine/content/contentBatch.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/cf_web/src/views/data-base/ruleAttrDefine/content/contentBatch.vue","mtime":1600927611463},{"path":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { queryBatchRecords, addBatchRecords, deleteBatchRecords } from \"@/api/data-base/ruleAttrDefine\"\nimport Pagination from \"@/components/Pagination\"\n\nexport default {\n    name: \"contentBatch\",\n    components: { Pagination },\n    data () {\n        return {\n            list: [],\n            listAdd: {\n                rulePrepCode: '',\n                rulePrepName: ''\n            },\n            total: 0,\n            theight: 0,\n            tableKey: [0],//表格索引，虚拟dom渲染表格时使用\n            selectRows: [],\n            listQuery: {\n                page: true,\n                currentPage: 1,\n                pageSize: 10\n\n            },\n            rules: {\n\n            }\n        }\n    },\n    created () {\n        this.getList()\n    },\n    mounted () {\n        this.setTableHeight()\n        //表格高度自适应\n        window.onresize = () => {\n            this.setTableHeight()\n        }\n    },\n    methods: {\n        //显示主表\n        getList () {\n            queryBatchRecords(this.listQuery).then(res => {\n                this.list = res.data.list\n                this.total = res.data.pages.count\n            })\n        },\n        //表格高度计算\n        setTableHeight () {\n            this.theight = this.$myFun.getSingleTbHeight() - 35\n\n        },\n        //查询\n        handleQuery () {\n            this.listRow = []\n            this.listQuery.currentPage = 1\n            this.getList()\n        },\n        //每页大小变化\n        handleSizeChange (val) {\n            this.listQuery.pageSize = val\n            this.getList()\n        },\n        //当前页变化\n        handleCurrentChange (val) {\n            this.listQuery.currentPage = val\n            this.getList()\n        },\n        //主表勾选框选中\n        selectRow (val) {\n            this.selectRows = val[val.length - 1]\n            if (val.length > 1) {\n                this.$refs.tbmain.clearSelection()\n                this.$refs.tbmain.toggleRowSelection(val[val.length - 1], 'selected')\n            }\n        },\n        handleDelete () {\n            if (this.selectRows.rowId) {\n                deleteBatchRecords(this.selectRows.rulePrepCode).then(() => {\n                    this.$message({\n                        type: 'success',\n                        message: '删除成功'\n                    })\n                    this.getList()\n                })\n            } else {\n                this.$message.warning(this.$t('message.checkedplease'))\n            }\n        },\n        handleAdd () {\n            if (this.listAdd.rulePrepCode && this.listAdd.rulePrepName) {\n                addBatchRecords(this.listAdd).then(() => {\n                    this.$message({\n                        type: 'success',\n                        message: '新增成功'\n                    })\n                    this.getList()\n                })\n            } else {\n                this.$message.warning('请填写完整')\n            }\n        }\n    }\n}\n",null]}