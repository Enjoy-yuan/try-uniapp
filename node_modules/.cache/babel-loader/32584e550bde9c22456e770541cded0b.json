{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js!/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/WMS/knProcessing/knjgPlan/Dialog/DialogAddMain.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/WMS/knProcessing/knjgPlan/Dialog/DialogAddMain.vue","mtime":1596610934128},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport * as api from \"@/api/project/wms/knProcessing/knjgplan.js\";\nimport AuthoType from \"@/components/Select/AuthoType.vue\"; //权限类型下拉组件\n\nimport { DT_ORG_TYPE, DT_ORG_FUNCTION } from '@/utils/constant'; // import warehouseSelect from '@/components/Select/warehouse-select.vue'//下拉组件\n// import caiGou from '@/components/select/caigou.vue'//下拉组件\n// import orgSelect from \"@/components/select/orgSelect.vue\"\n\nexport default {\n  name: 'addMain',\n  //   warehouseSelect , caiGou, orgSelect,\n  components: {\n    AuthoType: AuthoType\n  },\n  data: function data() {\n    return {\n      dicType: '',\n      AddMainlist: {\n        dicType: '',\n        orgCode: \"\",\n        warehouseCode: \"\",\n        planDate: \"\",\n        remark: \"\",\n        planDetailCreateDTOList: []\n      },\n      planDetailCreateDTOList: [],\n      DT_ORG_TYPE: DT_ORG_TYPE,\n      DT_ORG_FUNCTION: DT_ORG_FUNCTION,\n      curdialogStatus: 0,\n      dialogFormVisible: false,\n      rules: {\n        orgCode: [{\n          required: true,\n          message: '请选择',\n          trigger: 'blur'\n        }],\n        warehouseCode: [{\n          required: true,\n          message: '请选择',\n          trigger: 'blur'\n        }],\n        planDate: [{\n          required: true,\n          message: '请选择',\n          trigger: 'blur'\n        }]\n      },\n      selectRows: [],\n      isEdit: false\n    };\n  },\n  created: function created() {},\n  methods: {\n    checkNum: function checkNum() {\n      var res = true;\n      this.planDetailCreateDTOList.forEach(function (item) {\n        if (!item.planNum) {\n          res = false;\n        }\n      });\n\n      if (!res) {\n        this.$message({\n          type: 'warning',\n          message: '数量不能为空或0'\n        });\n      }\n\n      return res;\n    },\n    addMainConfirm: function addMainConfirm() {\n      var _this = this;\n\n      this.$refs.dialogMain.validate(function (valid) {\n        if (valid) {\n          if (_this.checkNum(_this.AddMainlist)) _this.$confirm('确认保存吗?', '提示', {\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n            type: 'warning'\n          }).then(function () {\n            _this.AddMainlist.dicType = _this.dicType;\n            _this.AddMainlist.planDetailCreateDTOList = _this.planDetailCreateDTOList;\n            api.createRecords(_this.AddMainlist).then(function () {\n              _this.$emit('refresh');\n\n              _this.dialogFormVisible = false;\n\n              _this.$message({\n                type: 'success',\n                message: '保存成功'\n              });\n            });\n          });\n        }\n      });\n    },\n    updateMainConfirm: function updateMainConfirm() {\n      var _this2 = this;\n\n      this.$refs.dialogMain.validate(function (valid) {\n        if (valid) {\n          if (_this2.checkNum(_this2.AddMainlist)) _this2.$confirm('确认保存吗?', '提示', {\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n            type: 'warning'\n          }).then(function () {\n            _this2.AddMainlist.dicType = _this2.dicType;\n            _this2.AddMainlist.planDetailCreateDTOList = _this2.planDetailCreateDTOList;\n            api.updateRecords(_this2.AddMainlist.planNo, _this2.AddMainlist).then(function () {\n              _this2.$emit('refresh');\n\n              _this2.dialogFormVisible = false;\n\n              _this2.$message({\n                type: 'success',\n                message: '保存成功'\n              });\n            });\n          });\n        }\n      });\n    },\n    titleShow: function titleShow(val) {\n      this.curdialogStatus = val;\n    },\n    //添加项\n    addSub: function addSub() {\n      if (this.AddMainlist.orgCode && this.AddMainlist.warehouseCode) {\n        this.$emit('showbomwl', this.AddMainlist.orgCode);\n        this.isEdit = true;\n      } else {\n        this.$message.warning(\"请先选择组织编码和仓库编码！\");\n      }\n    },\n    //删除内容某一行\n    deleteContent: function deleteContent() {\n      var _this3 = this;\n\n      if (this.selectRows.length !== 0) {\n        this.$confirm('确认要删除该数据项吗?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(function () {\n          _this3.planDetailCreateDTOList = _this3.planDetailCreateDTOList.filter(function (item) {\n            var isD = true;\n            console.log(_this3.selectRows, 'deleteContent');\n\n            _this3.selectRows.forEach(function (itemr) {\n              if (itemr.materielCode === item.materielCode) {\n                isD = false;\n              }\n            });\n\n            return isD;\n          });\n\n          _this3.$message({\n            type: 'success',\n            message: '删除成功'\n          });\n        });\n      } else {\n        this.$message.warning(\"请勾选记录！\");\n        return;\n      }\n    },\n    addSelectChange: function addSelectChange(val) {\n      this.selectRows = val;\n    },\n    //刷新\n    refresh: function refresh() {\n      this.isEdit = false;\n      this.planDetailCreateDTOList = [];\n    },\n    setBomM: function setBomM(val) {\n      var _this4 = this;\n\n      var arrSave = JSON.parse(JSON.stringify(this.planDetailCreateDTOList));\n      val.forEach(function (item) {\n        var addAble = true;\n        arrSave.forEach(function (ip) {\n          console.log(ip.materielCode, item.materielCode, ip.materielCode === item.materielCode);\n\n          if (ip.materielCode === item.materielCode || !ip.materielCode || !item.materielCode) {\n            addAble = false;\n          }\n        });\n\n        if (addAble) {\n          _this4.planDetailCreateDTOList.push({\n            materielCode: \"\",\n            materielName: \"\",\n            measuringUnit: \"\",\n            planNum: 0,\n            specification: \"\",\n            versions: \"\"\n          });\n\n          for (var itemp in item) {\n            var indexp = _this4.planDetailCreateDTOList.length - 1;\n\n            if (itemp === 'versions' || itemp === 'materielCode' || itemp === 'materielName' || itemp === 'specification' || itemp === 'measuringUnit') {\n              _this4.planDetailCreateDTOList[indexp][itemp] = item[itemp];\n            }\n          }\n        }\n      });\n    },\n    setDictype: function setDictype(val) {\n      this.dicType = val;\n    }\n  }\n};",null]}