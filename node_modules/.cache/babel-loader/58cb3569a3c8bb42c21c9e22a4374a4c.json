{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js!/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/supplierManagement/supplierChange/supplierChangeNotice/dialog/addMain.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/supplierManagement/supplierChange/supplierChangeNotice/dialog/addMain.vue","mtime":1599136050850},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport _objectSpread from \"/Users/yuan/Documents/\\u5927\\u5510\\u5E7F\\u7535/dt-web/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport * as api from '@/api/project/srm/supplierManage/supplierChangeNotice';\nimport * as api2 from \"@/api/project/srm/supplierManagement/supplierRegister\";\nimport { queryRecords, queryRecordItem } from '@/api/project/srm/supplierManage/supplierConfigure';\nimport platSupplier from \"@/components/Select/platSupplier\"; // 分页组件\n\nimport { mapState } from 'vuex';\nimport throttle from 'lodash/throttle';\nexport default {\n  components: {\n    platSupplier: platSupplier\n  },\n  data: function data() {\n    return {\n      temp: {\n        supplierCode: undefined\n      },\n      items: {},\n      changeType: [],\n      attributeList: [],\n      tableKey: 0,\n      list: [],\n      supplierList: [],\n      value1: \"\",\n      value2: \"\",\n      dialogStatus: \"\",\n      queryState: ['PAR1', 'PAR2'],\n      dialogVisible: false,\n      dialogVisiblesx: false,\n      dialogVisibleSupplier: false,\n      edlist: [],\n      changeConfigId: null,\n      changeOrderNo: null,\n      rowId: null,\n      showForm: false //表单数据是否可编辑\n\n    };\n  },\n  computed: _objectSpread({}, mapState({\n    dt_srm_par: function dt_srm_par(state) {\n      return state.dict.dt_srm_par;\n    }\n  })),\n  mounted: function mounted() {\n    this.$store.dispatch('dict/getDicData', ['dt_srm_par']);\n  },\n  methods: {\n    handleCreate: function handleCreate() {\n      var _this = this;\n\n      if (this.temp.changeTypeCode && this.temp.supplierCode && this.temp.supplierName && this.temp.reason) {\n        if (this.temp.changeOrderNo === undefined) {\n          api.addRecord(this.temp).then(function (res) {\n            console.log(res, 'pp');\n            _this.temp = res.data;\n            _this.changeConfigId = res.data.changeConfigId;\n            _this.changeOrderNo = res.data.changeOrderNo;\n\n            _this.$message({\n              title: '成功',\n              message: '新增成功',\n              type: 'success',\n              duration: 2000\n            });\n\n            _this.$emit('refresh');\n          });\n        } else if (this.temp.changeOrderNo !== undefined) {\n          this.resetItems();\n          this.dialogVisiblesx = true;\n          console.log(this.changeConfigId, 'ppppp');\n          queryRecordItem(this.changeConfigId).then(function (res) {\n            _this.attributeList = res.data;\n          });\n          var a = {\n            currentPage: 1,\n            pageSize: 10,\n            platformState: 'PA1P',\n            supplierCode: this.temp.supplierCode\n          };\n          api2.queryRecords(a).then(function (res) {\n            res = res.data;\n            _this.supplierList = res.list;\n          });\n        }\n      } else {\n        this.$message({\n          title: '警告',\n          message: '请选择变更类型,供应商编码,供应商名称,变更原因',\n          type: 'warning',\n          duration: 2000\n        });\n      }\n    },\n    dataType: function dataType() {\n      var type = this.temp.changeTypeCode;\n\n      if (type) {\n        this.edlist = this.changeType.filter(function (item) {\n          return item.type === type;\n        });\n      }\n\n      this.temp.changeTypeName = this.edlist[0].represent;\n      this.temp.changeConfigId = this.edlist[0].rowId;\n      this.temp.changeMode = this.edlist[0].changeMode;\n\n      if (this.edlist[0].changeMode == \"PAR2\") {\n        this.temp.processNumber = this.edlist[0].processNumber; // this.temp.changeMode = this.edlist[0].changeMode\n      } else {\n        delete this.temp.processNumber;\n      }\n    },\n    getType: function getType() {\n      var _this2 = this;\n\n      var a = {\n        state: 'P002',\n        changeMode: this.queryState.join(\",\")\n      };\n      queryRecords(a).then(function (res) {\n        _this2.changeType = res.data;\n      });\n    },\n    getItemList: function getItemList() {\n      var _this3 = this;\n\n      var a = {\n        changeOrderNo: this.changeOrderNo\n      };\n      api.queryRecordsItems(a).then(function (res) {\n        _this3.list = res.data;\n      });\n    },\n    getFieldName: function getFieldName() {\n      var _this4 = this;\n\n      var getFieldName = this.attributeList.filter(function (item) {\n        return item.fieldCode === _this4.items.changeField;\n      });\n      this.items.changeFieldName = getFieldName[0].fieldName;\n      this.supplierList.forEach(function (val) {\n        var _loop = function _loop(key) {\n          getFieldName.forEach(function (item) {\n            if (item.fieldCode === key) {\n              _this4.items.beforeChange = val[key];\n            }\n          });\n        };\n\n        for (var key in val) {\n          _loop(key);\n        }\n      });\n    },\n    handleSupplier: function handleSupplier() {\n      // this.dialogVisibleSupplier = true\n      this.dialogVisibleSupplier = true;\n    },\n    handleDelete: function handleDelete(index, val) {\n      var _this5 = this;\n\n      api.deleteRecordItems(this.changeOrderNo, val.rowId).then(function () {\n        _this5.$message({\n          title: '成功',\n          message: '删除成功',\n          type: 'success',\n          duration: 2000\n        });\n\n        _this5.getItemList();\n      });\n    },\n    addConfirm: throttle(function () {\n      var _this6 = this;\n\n      api.addRecord(this.temp).then(function () {\n        _this6.$message({\n          title: '成功',\n          message: '新增成功',\n          type: 'success',\n          duration: 2000\n        });\n\n        _this6.dialogVisible = false;\n\n        _this6.$emit('refresh');\n      });\n    }, 2000, {\n      leading: true,\n      trailing: false\n    }),\n    updateConfirm: throttle(function () {\n      var _this7 = this;\n\n      api.updateRecord(this.rowId, this.temp).then(function () {\n        _this7.$message({\n          title: '成功',\n          message: '编辑成功',\n          type: 'success',\n          duration: 2000\n        });\n\n        _this7.dialogVisible = false;\n\n        _this7.$emit('refresh');\n      });\n    }, 2000, {\n      leading: true,\n      trailing: false\n    }),\n    saveAttribute: throttle(function () {\n      var _this8 = this;\n\n      this.items.changeOrderNo = this.changeOrderNo;\n      api.addRecordItems(this.changeOrderNo, this.items).then(function () {\n        _this8.$message({\n          title: '成功',\n          message: '新增成功',\n          type: 'success',\n          duration: 2000\n        });\n\n        _this8.dialogVisiblesx = false;\n\n        _this8.getItemList();\n      });\n    }, 2000, {\n      leading: true,\n      trailing: false\n    }),\n    confirm: function confirm() {\n      if (this.$refs.platSupplier.listSelected.length > 0) {\n        this.temp.supplierCode = this.$refs.platSupplier.listSelected[0].supplierCode;\n        this.temp.supplierName = this.$refs.platSupplier.listSelected[0].supplierName;\n        this.temp.contactAddress = this.$refs.platSupplier.listSelected[0].contactAddress;\n        this.temp.contacts = this.$refs.platSupplier.listSelected[0].contacts;\n        this.temp.legalPerson = this.$refs.platSupplier.listSelected[0].legalPerson;\n        this.temp.mainFactory = this.$refs.platSupplier.listSelected[0].mainFactory;\n        this.temp.purchaseOrg = this.$refs.platSupplier.listSelected[0].purchaseOrg;\n        this.temp.purchaser = this.$refs.platSupplier.listSelected[0].purchaser;\n        this.temp.supplierId = this.$refs.platSupplier.listSelected[0].rowId;\n        this.temp.supplierShortName = this.$refs.platSupplier.listSelected[0].supplierShortName;\n        this.temp.telephone = this.$refs.platSupplier.listSelected[0].telephone;\n        this.dialogVisibleSupplier = false;\n      } else {\n        this.$message({\n          title: '警告',\n          message: '请选择一条信息',\n          type: 'warning',\n          duration: 2000\n        });\n      }\n    },\n    resetTemp: function resetTemp() {\n      this.temp = {\n        changeOrderNo: undefined,\n        changeTypeCode: undefined,\n        supplierCode: undefined,\n        supplierName: undefined,\n        reason: undefined,\n        remark: undefined\n      };\n    },\n    resetItems: function resetItems() {\n      this.items = {\n        changeField: undefined,\n        beforeChange: undefined,\n        afterChange: undefined\n      };\n    }\n  }\n};",null]}