{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js!/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/system/userManagement/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/system/userManagement/index.vue","mtime":1596610934273},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.function.name\";\nimport _objectSpread from \"/Users/yuan/Documents/\\u5927\\u5510\\u5E7F\\u7535/dt-web/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Pagination from '@/components/Pagination'; // Secondary package based on el-pagination\n\nimport { selectlists, authorizationrole, relation } from '@/api/system/user';\nimport { selecttree } from '@/api/system/organization';\nimport { selectrole } from '@/api/system/role';\nimport { getDomainName } from '@/utils/auth';\nimport { mapState } from 'vuex';\nexport default {\n  name: 'userManagement',\n  components: {\n    Pagination: Pagination\n  },\n  data: function data() {\n    return {\n      data1: [],\n      tableKey: 0,\n      list: [],\n      theight: 0,\n      //表格高度\n      listunrole: [],\n      listrole: [],\n      treeData: [],\n      total: 0,\n      total1: 0,\n      total2: 0,\n      activeName2: 'first',\n      listLoading: true,\n      listQuery: {\n        orgId: '',\n        currentPage: 1,\n        pageSize: 15,\n        page: 1\n      },\n      listQuery1: {\n        currentPage: 1,\n        pageSize: 10,\n        page: 1,\n        domainScope: getDomainName().toUpperCase()\n      },\n      listQuery2: {\n        currentPage: 1,\n        pageSize: 10,\n        page: 1\n      },\n      readonly: false,\n      temp: {},\n      dialogFormVisible: false,\n      dialogFormVisible1: false,\n      dialogFormUser: false,\n      dialogStatus: '',\n      rules: {\n        realName: [{\n          required: true,\n          message: '真实姓名不能为空',\n          trigger: 'blur'\n        }, {\n          max: 100,\n          message: this.$t('validate.max32'),\n          trigger: 'blur'\n        }, {\n          type: 'string',\n          message: '请输入字符串 \"张三\" ',\n          trigger: 'blur'\n        }],\n        userName: [{\n          required: true,\n          message: '用户名称不能为空',\n          trigger: 'blur'\n        }, {\n          max: 100,\n          message: this.$t('validate.max32'),\n          trigger: 'blur'\n        }]\n      },\n      dialogPvVisible: false,\n      pvData: [],\n      defaultProps: {\n        children: 'children',\n        label: 'organizationName'\n      },\n      defaultProps1: {\n        children: 'children',\n        label: 'catalogName'\n      },\n      contentStyleObj: {\n        height: null\n      }\n    };\n  },\n  computed: _objectSpread({}, mapState({\n    dt_domainScope_type: function dt_domainScope_type(state) {\n      return state.dict.dt_domainScope_type;\n    }\n  })),\n  mounted: function mounted() {\n    var _this = this;\n\n    this.$store.dispatch('dict/getDicData', ['dt_domainScope_type']);\n    this.setTableHeight(); //表格高度自适应\n\n    window.onresize = function () {\n      _this.setTableHeight();\n\n      _this.setTreeHeight();\n    };\n\n    this.getList();\n    this.setTreeHeight();\n  },\n  created: function created() {\n    window.addEventListener('resize', this.getHeight);\n    this.getHeight();\n  },\n  methods: {\n    handleClose: function handleClose() {\n      this.resetTemp();\n    },\n    cancel: function cancel() {\n      //弹窗取消按钮\n      this.dialogFormVisible = false;\n      this.dialogFormVisible1 = false;\n    },\n    getHeight: function getHeight() {\n      this.contentStyleObj.height = document.body.scrollHeight - 110 + 'px';\n    },\n    destroyed: function destroyed() {\n      window.removeEventListener('resize', this.getHeight);\n    },\n    treeGetList: function treeGetList() {\n      var _this2 = this;\n\n      //获取树数据\n      this.listLoading = true;\n      selectlists(this.listQuery).then(function (response) {\n        _this2.list = response.data.list;\n        _this2.total = response.data.pages.count;\n        setTimeout(function () {\n          _this2.listLoading = false;\n        }, 1.5 * 100);\n      });\n    },\n    //表格高度计算\n    setTableHeight: function setTableHeight() {\n      this.theight = this.$myFun.getSingleTbHeight();\n    },\n    //树高度设置\n    setTreeHeight: function setTreeHeight() {\n      this.contentStyleObj.height = this.$myFun.getTreehHeight();\n    },\n    getList: function getList() {\n      var _this3 = this;\n\n      //查询数据\n      this.listLoading = true;\n      selectlists(this.listQuery).then(function (response) {\n        _this3.list = response.data.list;\n        _this3.total = response.data.pages.count;\n        setTimeout(function () {\n          _this3.listLoading = false;\n        }, 1.5 * 100);\n      }), selecttree().then(function (response) {\n        //获取树数据\n        _this3.treeData = _this3.$myFun.addTreeRoot(response.data);\n        setTimeout(function () {\n          _this3.listLoading = false;\n        }, 1.5 * 100);\n      });\n    },\n    getListRelation: function getListRelation() {\n      var _this4 = this;\n\n      //查询关联的数据\n      this.listQuery2.type = 1;\n      relation(this.selectlistRow[0].userName, this.listQuery2).then(function (response) {\n        _this4.listrole = response.data.list;\n        _this4.total2 = response.data.pages.count;\n      });\n    },\n    getListUnelation: function getListUnelation() {\n      var _this5 = this;\n\n      //查询未关联的数据\n      this.listQuery1.type = 2;\n      this.listQuery1.userName = this.selectlistRow[0].realName;\n      relation(this.selectlistRow[0].userName, this.listQuery1).then(function (response) {\n        _this5.listunrole = response.data.list;\n        _this5.total1 = response.data.pages.count;\n      });\n    },\n    handleTabClick: function handleTabClick(tab) {\n      //选项卡切换\n      if (tab.name == \"first\") {\n        this.getListUnelation();\n      } else {\n        this.getListRelation();\n      }\n    },\n    handleFilter: function handleFilter() {\n      var _this6 = this;\n\n      this.listQuery.page = 1;\n      this.listLoading = true; //查询组织列表\n\n      selectlists(this.listQuery).then(function (response) {\n        _this6.list = response.data.list;\n        _this6.total = response.data.pages.count;\n        setTimeout(function () {\n          _this6.listLoading = false;\n        }, 1.5 * 100);\n      });\n    },\n    resetTemp: function resetTemp() {\n      this.temp = {\n        employeeCode: undefined,\n        employeeName: undefined,\n        sex: 1,\n        organizationId: undefined,\n        state: '启用',\n        mobile: undefined,\n        email: undefined,\n        officePhone: undefined,\n        birthday: undefined,\n        hireDate: undefined,\n        idNumber: undefined,\n        address: undefined,\n        remarks: undefined,\n        isLog: '是'\n      };\n    },\n    //角色维护\n    handleUser: function handleUser() {\n      if (this.selectlistRow && this.selectlistRow.length == 1) {\n        this.getListUnelation();\n        this.dialogFormUser = true;\n      } else {\n        this.$message({\n          title: '警告',\n          message: '请选择一条用户信息',\n          type: 'warning'\n        });\n      }\n    },\n    deleRole: function deleRole() {\n      var _this7 = this;\n\n      //删除关联角色\n      var fun = 'REMOVE';\n\n      if (this.selectlistRowUser1 && this.selectlistRowUser1.length > 0) {\n        var roleCodes = [];\n\n        for (var i = 0; i < this.selectlistRowUser1.length; i++) {\n          roleCodes[i] = this.selectlistRowUser1[i].roleCode;\n        }\n\n        authorizationrole(this.selectlistRow[0].userName, roleCodes, fun).then(function () {\n          _this7.$message({\n            title: '成功',\n            message: '删除成功',\n            type: 'success'\n          });\n\n          _this7.getListRelation();\n        });\n        this.dialogFormUser = true;\n      } else {\n        this.$message({\n          title: '警告',\n          message: '请选择一条角色信息',\n          type: 'warning'\n        });\n      }\n    },\n    // handleFun() {//功能授权按钮单击事件方法\n    //   // if(this.selectlistRow && this.selectlistRow.length==1){\n    //   //   selectRecord(this.listQuery).then(res => {\n    //   //   this.dialogStatus = 'create'\n    //   //   this.dialogFormVisible1 = true\n    //   //   this.data1=this.$myFun.reDataToTree(res.data.list)\n    //   // })\n    //   // }else{\n    //   //   this.$message({\n    //   //     title: '警告',\n    //   //     message: '请选择一条信息',\n    //   //     type: 'warning'\n    //   //   })\n    //   // }\n    // },\n    handleCheckChange: function handleCheckChange() {\n      return this.$refs.tree.getCheckedNodes().concat(this.$refs.tree.getHalfCheckedNodes()); //获取选中和半选中状态下的数据\n    },\n    create1: function create1() {\n      //功能授权弹窗确定按钮单击事件方法\n      // let catalogs=this.handleCheckChange().map(function(item,index,array){ \n      //   return item.catalogCode\n      // })\n      // addMenu(this.selectlistRow[0].roleCode,{catalogCodes:catalogs}).then(res =>{\n      //   this.$notify({\n      //         title: '成功',\n      //         message: '授权成功',\n      //         type: 'success',\n      //         duration: 2000\n      //       })\n      // })\n      this.dialogFormVisible1 = false;\n    },\n    handsearchsole: function handsearchsole() {\n      var _this8 = this;\n\n      selectrole(this.listQuery1).then(function (response) {\n        if (_this8.activeName2 == \"first\") {\n          _this8.listunrole = response.data.list;\n          _this8.total = response.data.pages.count;\n        } else {\n          _this8.listrole = response.data.list;\n          _this8.total = response.data.pages.count;\n        }\n      }); // this.handleUser()\n    },\n    addrole: function addrole() {\n      var _this9 = this;\n\n      //角色授权\n      var fun = 'SAVE';\n\n      if (this.selectlistRowUser && this.selectlistRowUser.length > 0) {\n        var roleCodes = [];\n\n        for (var i = 0; i < this.selectlistRowUser.length; i++) {\n          roleCodes[i] = this.selectlistRowUser[i].roleCode;\n        }\n\n        authorizationrole(this.selectlistRow[0].userName, roleCodes, fun).then(function () {\n          _this9.$message({\n            title: '成功',\n            message: '授权成功',\n            type: 'success',\n            duration: 2000\n          });\n\n          _this9.handleUser();\n        });\n        this.dialogFormUser = true;\n      } else {\n        this.$message({\n          title: '警告',\n          message: '请选择一条角色信息',\n          type: 'warning'\n        });\n      }\n    },\n    // 获取表格选中时的数据\n    selectRow: function selectRow(val) {\n      if (val.length > 1) {\n        this.$refs.tb_a.clearSelection(); //清除其他行的选中\n\n        this.$refs.tb_a.toggleRowSelection(val[val.length - 1], 'selected'); //单击行绑定点击事件\n      } else if (val.length === 1) {\n        this.selectlistRow = val;\n      }\n    },\n    rowClick: function rowClick(val) {\n      this.$refs.tb_a.clearSelection(); //清除其他行的选中\n\n      this.$refs.tb_a.toggleRowSelection(val); //单击行绑定点击事件\n    },\n    selectRowUser: function selectRowUser(val) {\n      this.selectlistRowUser = val;\n    },\n    selectRowUser1: function selectRowUser1(val) {\n      this.selectlistRowUser1 = val;\n    },\n    handleNodeClick: function handleNodeClick(data) {\n      //点击树查询\n      this.listQuery.orgId = data.rowId;\n      this.treeGetList();\n    },\n    handleDelete: function handleDelete() {\n      //删除列表\n      if (this.selectlistRow && this.selectlistRow.length == 1) {\n        var ids = [];\n        this.selectlistRow.forEach(function (val, index) {\n          ids[index] = val.employeeCode;\n        });\n      } else {\n        this.$message({\n          title: '警告',\n          message: '请选择一条信息',\n          type: 'warning'\n        });\n      }\n    }\n  }\n};",null]}