{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js!/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/components/Select/AuthoType.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/components/Select/AuthoType.vue","mtime":1596611178172},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\nimport { AUTHO_SELECT_LIST, DT_ORG_TYPE } from '@/utils/constant';\nimport { selectlists as listOrg } from '@/api/system/organization';\nimport { getName } from '@/utils/auth';\nimport request from '@/utils/request';\nexport default {\n  name: 'AuthoType',\n  props: {\n    //下拉框类型\n    selectType: {\n      type: Number,\n      required: true\n    },\n    placeholder: {\n      type: String,\n      default: '请选择'\n    },\n    objectCode: {\n      type: String,\n      default: ''\n    },\n    disabled: {\n      type: Boolean,\n      default: false\n    },\n    cascading: {\n      type: String,\n      default: ''\n    },\n    isDefault: {\n      type: Boolean,\n      default: false\n    }\n  },\n  model: {\n    prop: 'objectCode',\n    event: 'change'\n  },\n  data: function data() {\n    return {\n      options: [],\n      AUTHO_SELECT_LIST: AUTHO_SELECT_LIST,\n      DT_ORG_TYPE: DT_ORG_TYPE,\n      itemKey: this.objectCode\n    };\n  },\n  created: function created() {\n    this.getOptions();\n  },\n  watch: {\n    objectCode: function objectCode() {\n      this.itemKey = this.objectCode;\n    },\n    cascading: function cascading() {\n      this.itemKey = '';\n      this.getOptions();\n    }\n  },\n  methods: {\n    getOptions: function getOptions() {\n      var _this = this;\n\n      if (this.selectType === 3 && this.cascading == '') {\n        this.options = [];\n      } else {\n        var listQuery = {\n          userName: getName(),\n          accessTypeCode: this.AUTHO_SELECT_LIST[this.selectType].accessTypeCode,\n          metaDataType: this.AUTHO_SELECT_LIST[this.selectType].metaDataCode,\n          currentPage: 1,\n          pageSize: 10,\n          page: 1\n        };\n        request({\n          url: \"/keyguard/users/\".concat(listQuery.userName, \"/datas/accessTypeCode=\").concat(listQuery.accessTypeCode, \"&metaDataType=\").concat(listQuery.metaDataType),\n          //数据权限元数据列表查询\n          method: 'get'\n        }).then(function (res) {\n          _this.getAllList(res.data);\n\n          _this.options = res.data;\n        });\n      }\n    },\n    changeSelect: function changeSelect(val) {\n      this.$emit('change', val);\n      var name = '';\n      var org = this.options.filter(function (v) {\n        return v.objectCode == val;\n      }).find(function (value) {\n        return value;\n      });\n\n      if (org) {\n        name = org.objectName;\n      }\n\n      this.$emit('selectName', name);\n    },\n    //默认选中\n    setDefaultVal: function setDefaultVal(i) {\n      if (this.options.length > 0) {\n        if (this.isDefault) {\n          this.itemKey = this.options[0].objectCode;\n          this.$emit('setdefault', this.itemKey, i);\n        }\n      }\n    },\n    getAllList: function getAllList(data) {\n      var _this2 = this;\n\n      switch (this.selectType) {\n        //公司权限\n        case 0:\n          {\n            break;\n          }\n        //工厂权限\n\n        case 1:\n          {\n            var listQuery = {\n              type: this.DT_ORG_TYPE.factory,\n              state: 1\n            };\n            listOrg(listQuery).then(function (res) {\n              _this2.options = data.filter(function (item) {\n                var isF = false;\n                res.data.forEach(function (itemr) {\n                  if (itemr.organizationCode === item.objectCode) {\n                    isF = true;\n                  }\n                });\n                return isF;\n              });\n\n              _this2.setDefaultVal(1);\n            });\n            break;\n          }\n        //采购组织权限\n\n        case 2:\n          {\n            var _listQuery = {\n              businessFunction: this.businessFunction,\n              state: 1\n            };\n            listOrg(_listQuery).then(function (res) {\n              _this2.options = data.filter(function (item) {\n                var isF = false;\n                res.data.forEach(function (itemr) {\n                  if (itemr.organizationCode === item.objectCode) {\n                    isF = true;\n                  }\n                });\n                return isF;\n              });\n\n              _this2.setDefaultVal(2);\n            });\n            break;\n          }\n        //仓库权限\n\n        case 3:\n          {\n            if (this.cascading) {\n              request({\n                url: '/base-modeling/warehouses',\n                method: 'get',\n                params: {\n                  orgCode: this.cascading\n                }\n              }).then(function (res) {\n                res = res.data;\n                _this2.options = data.filter(function (item) {\n                  var isF = false;\n                  res.forEach(function (itemr) {\n                    if (itemr.warehouseCode === item.objectCode) {\n                      isF = true;\n                    }\n                  });\n                  return isF;\n                });\n\n                _this2.setDefaultVal(3);\n              });\n            }\n\n            break;\n          }\n        //往来仓库权限\n\n        case 4:\n          {\n            if (this.cascading) {\n              request({\n                url: '/base-modeling/warehouses',\n                method: 'get',\n                params: {\n                  orgCode: this.cascading\n                }\n              }).then(function (res) {\n                res = res.data;\n                _this2.options = data.filter(function (item) {\n                  var isF = false;\n                  res.forEach(function (itemr) {\n                    if (itemr.warehouseCode === item.objectCode) {\n                      isF = true;\n                    }\n                  });\n                  return isF;\n                });\n\n                _this2.setDefaultVal(4);\n              });\n            }\n\n            break;\n          }\n        //车间\n\n        case 5:\n          {\n            break;\n          }\n        //生产线 工作中心\n\n        case 6:\n          {\n            break;\n          }\n        //工位\n\n        case 7:\n          {\n            break;\n          }\n        //仓储业务 业务类型\n\n        case 8:\n          {\n            break;\n          }\n      }\n    }\n  }\n};",null]}