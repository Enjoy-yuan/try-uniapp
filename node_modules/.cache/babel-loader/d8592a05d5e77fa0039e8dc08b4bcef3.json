{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js!/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/WMS/inventory/inventoryRegister/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/WMS/inventory/inventoryRegister/index.vue","mtime":1596610934121},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport _objectSpread from \"/Users/yuan/Documents/\\u5927\\u5510\\u5E7F\\u7535/dt-web/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport * as api from \"@/api/project/wms/inventory/inventoryFormation\";\nimport AuthoType from '@/components/Select/AuthoType.vue'; //权限类型下拉组件\n\nimport Pagination from \"@/components/Pagination\";\nimport { mapState } from 'vuex';\nexport default {\n  name: \"inventoryRegister\",\n  components: {\n    Pagination: Pagination,\n    AuthoType: AuthoType\n  },\n  data: function data() {\n    return {\n      modalnum: null,\n      //模板编号，非模板页面可删\n      theight: 0,\n      //表格高度\n      isSingle: true,\n      //表格是否单选 点击各按钮根据流程逻辑控制单多选\n      list: [],\n      listSub: null,\n      total: 0,\n      selectRows: [],\n      dialogGys: false,\n      dialogFormVisible: false,\n      supplierRows: [],\n      isChangeAddS: false,\n      listQuery: {\n        method: 'enter',\n        page: true,\n        currentPage: 1,\n        pageSize: 15,\n        orgCode: '',\n        //组织编码\n        warehouseCode: '',\n        //仓库编码\n        inventoryType: '',\n        //盘点方式，类型\n        actived: '',\n        //冻结方式:0锁库，1未锁库\n        inventoryDate: '' //盘点日期\n\n      },\n      sublistQuery: {\n        inventoryNo: ''\n      },\n      tableKey: 0\n    };\n  },\n  computed: _objectSpread({}, mapState({\n    dt_inventory_type: function dt_inventory_type(state) {\n      return state.dict.dt_inventory_type;\n    },\n    dt_stock_status: function dt_stock_status(state) {\n      return state.dict.dt_stock_status;\n    }\n  })),\n  mounted: function mounted() {\n    var _this = this;\n\n    this.$store.dispatch(\"dict/getDicData\", ['dt_inventory_type', 'dt_stock_status']);\n    this.setTableHeight(); //表格高度自适应\n\n    window.onresize = function () {\n      _this.setTableHeight();\n    };\n  },\n  methods: {\n    //表格高度计算\n    setTableHeight: function setTableHeight() {\n      this.theight = this.$myFun.getSingleTbHeight();\n    },\n    //主表数据获取\n    getListData: function getListData() {\n      var _this2 = this;\n\n      api.queryRecords(this.listQuery).then(function (res) {\n        res = res.data;\n        _this2.list = res.list;\n      });\n    },\n    //显示主表\n    getList: function getList() {\n      this.getListData();\n    },\n    getSubList: function getSubList() {\n      var _this3 = this;\n\n      this.sublistQuery.inventoryNo = this.selectRows.inventoryNo;\n      api.queryRowRecords(this.sublistQuery).then(function (res) {\n        res = res.data;\n        _this3.listSub = res;\n        _this3.dialogFormVisible = true;\n      });\n    },\n    //查询\n    handleQuery: function handleQuery() {\n      this.listRow = [];\n      this.listQuery.currentPage = 1;\n      this.getList();\n    },\n    //每页大小变化\n    handleSizeChange: function handleSizeChange(val) {\n      this.listQuery.pageSize = val;\n      this.getList();\n    },\n    //当前页变化\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.listQuery.currentPage = val;\n      this.getList();\n    },\n    //确认\n    handleConfirm: function handleConfirm() {\n      var _this4 = this;\n\n      if (this.selectRows) {\n        if (this.selectRows.inventoryStateName) {\n          this.$confirm('是否要确认该盘点单?', this.$t('message.prompt'), {\n            confirmButtonText: this.$t('message.yes'),\n            cancelButtonText: this.$t('message.no'),\n            type: 'warning'\n          }).then(function () {\n            var dataList = {};\n            dataList.inventoryNoList = new Array();\n            dataList.inventoryNoList.push(_this4.selectRows.inventoryNo);\n            dataList.method = \"commit\";\n            api.updateRecords(dataList).then(function () {\n              _this4.getList();\n\n              _this4.$message({\n                type: 'success',\n                message: '确认成功'\n              });\n            });\n          }).catch(function () {\n            _this4.$message({\n              type: 'info',\n              message: _this4.$t('已取消确认')\n            });\n          });\n        } else {\n          this.$message.warning(this.$t('message.checkedplease'));\n          return false;\n        }\n      } else {\n        this.$message.warning(this.$t('message.checkedplease'));\n        return false;\n      }\n    },\n    //打印\n    handlePrint: function handlePrint() {\n      if (this.selectRows) {\n        {\n          this.$message.warning(this.$t('message.checkedplease'));\n          return false;\n        }\n      } else {\n        this.$message.warning(this.$t('message.checkedplease'));\n        return false;\n      }\n    },\n    //导出\n    handleExport: function handleExport() {\n      if (this.selectRows) {\n        {\n          this.$message.warning(this.$t('message.checkedplease'));\n          return false;\n        }\n      } else {\n        this.$message.warning(this.$t('message.checkedplease'));\n        return false;\n      }\n    },\n    //编辑\n    handleEdit: function handleEdit() {\n      if (this.selectRows) {\n        console.log(this.selectRows);\n\n        if (this.selectRows.inventoryNo) {\n          this.getSubList();\n        } else {\n          this.$message.warning(this.$t('message.checkedplease'));\n          return false;\n        }\n      } else {\n        this.$message.warning(this.$t('message.checkedplease'));\n        return false;\n      }\n    },\n    selectRow: function selectRow(val) {\n      this.selectRows = val[val.length - 1];\n\n      if (val.length > 1) {\n        this.$refs.tbmain.clearSelection();\n        this.$refs.tbmain.toggleRowSelection(val[val.length - 1], 'selected');\n      }\n    },\n    //编辑保存\n    handleSave: function handleSave() {\n      var _this5 = this;\n\n      this.$confirm(this.$t('message.isSave'), this.$t('message.prompt'), {\n        confirmButtonText: this.$t('message.yes'),\n        cancelButtonText: this.$t('message.no'),\n        type: 'warning'\n      }).then(function () {\n        api.realityRecords(_this5.listSub).then(function () {\n          _this5.$message({\n            type: 'success',\n            message: '编辑成功'\n          });\n\n          _this5.getList();\n\n          _this5.dialogFormVisible = false;\n        });\n      }).catch(function () {\n        _this5.dialogFormVisible = false;\n\n        _this5.$message({\n          type: 'info',\n          message: _this5.$t('message.canceled')\n        });\n      });\n    },\n    setdefault: function setdefault(val, i) {\n      if (i === 1) {\n        this.listQuery.orgCode = val;\n      } else if (i === 3) {\n        this.listQuery.warehouseCode = val;\n        this.getList();\n      }\n    },\n    //复制\n    handleCopy: function handleCopy() {\n      var _this6 = this;\n\n      this.listSub.forEach(function (item, index) {\n        console.log(_this6.listSub, item, index);\n        _this6.listSub[index].inventoryNum = item.accountNum;\n      });\n    }\n  }\n};",null]}