{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js!/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/EAS/RF/troubleshooting/repairTime/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/EAS/RF/troubleshooting/repairTime/index.vue","mtime":1596610933427},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"/Users/yuan/Documents/\\u5927\\u5510\\u5E7F\\u7535/dt-web/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport * as api from '@/api/project/eas/rf/repairTime';\nimport deviceType from \"../../../components/deviceTypeSelect\";\nimport useDept from \"../../../components/useDeptSelect\";\nimport deviceSelect from \"../../../components/singleDeviceSelect\";\nimport Pagination from '@/components/Pagination';\nimport { mapState } from 'vuex';\nexport default {\n  name: 'repairTime',\n  components: {\n    Pagination: Pagination,\n    deviceType: deviceType,\n    useDept: useDept,\n    deviceSelect: deviceSelect\n  },\n  data: function data() {\n    return {\n      chart1: undefined,\n      chart2: undefined,\n      chart3: undefined,\n      list1: null,\n      list2: null,\n      list3: null,\n      total: 0,\n      total2: 0,\n      theight: 0,\n      //表格高度\n      timeRange: null,\n      listQuery: {\n        currentPage: 1,\n        pageSize: 15,\n        fmStatDimensionality: 'FMSD_DEVICE_TYPE',\n        deviceCode: undefined,\n        useDept: undefined,\n        deviceType: undefined\n      },\n      listQuery2: {\n        currentPage: 1,\n        pageSize: 15,\n        fmStatDimensionality: 'FMSD_DATE'\n      },\n      deviceVisible: false,\n      tableKey: 0\n    };\n  },\n  watch: {\n    timeRange: function timeRange(val) {\n      if (val) {\n        this.listQuery.startTime = val[0];\n        this.listQuery.endTime = val[1];\n      } else {\n        delete this.listQuery.startTime;\n        delete this.listQuery.endTime;\n      }\n    },\n    'listQuery.fmStatDimensionality': function listQueryFmStatDimensionality(val) {\n      this.listQuery = {\n        currentPage: 1,\n        pageSize: 15,\n        fmStatDimensionality: val,\n        deviceCode: undefined,\n        useDept: undefined,\n        deviceType: undefined\n      };\n      this.$refs.deviceType.valueTitle = '';\n    }\n  },\n  created: function created() {},\n  computed: _objectSpread({}, mapState({\n    dt_f_m_stat_dimensionality: function dt_f_m_stat_dimensionality(state) {\n      return state.eamDict.dt_f_m_stat_dimensionality.filter(function (item) {\n        return item.dictItemKey != 'FMSD_DATE';\n      });\n    },\n    dt_maintain_type: function dt_maintain_type(state) {\n      return state.eamDict.dt_maintain_type;\n    },\n    dt_maintain_grade: function dt_maintain_grade(state) {\n      return state.eamDict.dt_maintain_grade;\n    }\n  })),\n  mounted: function mounted() {\n    var _this = this;\n\n    this.$store.dispatch('eamDict/getDicData', ['dt_f_m_stat_dimensionality', 'dt_maintain_type', 'dt_maintain_grade']);\n    this.setTableHeight(); //窗口变化\n\n    this.getList();\n\n    window.onresize = function () {\n      _this.setTableHeight();\n\n      _this.chart1.resize();\n\n      _this.chart2.resize();\n\n      _this.chart3.resize();\n    };\n  },\n  methods: {\n    confirmDevice: function confirmDevice(val) {\n      this.listQuery.deviceCode = val.deviceCode;\n    },\n    handleDevice: function handleDevice() {\n      if (this.listQuery.fmStatDimensionality != 'FMSD_DEVICE') {\n        this.$message({\n          title: '警告',\n          message: '查询维度请选择设备',\n          type: 'warning'\n        });\n        return;\n      }\n\n      this.deviceVisible = true;\n    },\n    // echarts渲染方法\n    getList: function getList() {\n      var _this2 = this;\n\n      if (this.listQuery.fmStatDimensionality == 'FMSD_DEVICE' && (!this.listQuery.deviceType || !this.listQuery.useDept || !this.listQuery.deviceCode)) {\n        this.$message({\n          title: '警告',\n          message: '请输入设备，设备类型，使用部门',\n          type: 'warning'\n        });\n        return;\n      }\n\n      var tmp = JSON.parse(JSON.stringify(this.listQuery)); // 饼图和柱图数据\n\n      api.queryRecords(this.listQuery).then(function (res) {\n        _this2.list1 = res.data.list;\n        _this2.total = res.data.pages.count;\n        var options = [_this2.dt_maintain_type, _this2.dt_maintain_grade];\n        _this2.list1 = _this2.$myFun.codeToName(_this2.list1, options, ['fieldCode', 'fieldCode']); // 折线图带查询条件，单独查询日期维度\n\n        tmp.fmStatDimensionality = 'FMSD_DATE';\n        delete tmp.currentPage;\n        delete tmp.pageSize;\n        api.queryRecords(tmp).then(function (res) {\n          _this2.list3 = res.data;\n          _this2.list2 = [];\n\n          _this2.formatChartData();\n        });\n      });\n    },\n    formatChartData: function formatChartData() {\n      var _this3 = this;\n\n      // 侧边选项\n      var pielegendData = this.list1.map(function (item) {\n        return item.fieldName ? item.fieldName : item.fieldCodeCN;\n      }); // 主数据\n\n      var pieData = this.list1.map(function (item) {\n        return {\n          value: item.time,\n          name: item.fieldName ? item.fieldName : item.fieldCodeCN\n        };\n      });\n      var opt1 = {\n        title: {\n          text: '部门维修时间比'\n        },\n        grid: {\n          left: '7%',\n          bottom: '0%',\n          containLabel: true\n        },\n        tooltip: {\n          //提示框组件\n          trigger: 'item',\n          //触发类型,'item'数据项图形触发，主要在散点图，饼图等无类目轴的图表中使用。 'axis'坐标轴触发，主要在柱状图，折线图等会使用类目轴的图表中使用。\n          showContent: true,\n          //是否显示提示框浮层\n          formatter: '{b0}: {c0}<br /> {d}%' //提示框浮层内容格式器，支持字符串模板和回调函数两种形式,模板变量有 {a}, {b}，{c}，{d}，{e}，分别表示系列名，数据名，数据值等\n\n        },\n        legend: {\n          right: 100,\n          top: 100,\n          left: 'right',\n          orient: 'vertical',\n          data: pielegendData\n        },\n        series: [{\n          name: '状态',\n          type: 'pie',\n          radius: '65%',\n          center: ['40%', '50%'],\n          data: pieData\n        }]\n      };\n      var opt2 = {\n        title: {\n          text: '部门维修时间'\n        },\n        tooltip: {\n          //提示框组件\n          trigger: 'item',\n          //触发类型,'item'数据项图形触发，主要在散点图，饼图等无类目轴的图表中使用。 'axis'坐标轴触发，主要在柱状图，折线图等会使用类目轴的图表中使用。\n          showContent: true,\n          //是否显示提示框浮层\n          formatter: '{b0}: {c0}' //提示框浮层内容格式器，支持字符串模板和回调函数两种形式,模板变量有 {a}, {b}，{c}，{d}，{e}，分别表示系列名，数据名，数据值等\n\n        },\n        grid: {\n          left: '7%',\n          bottom: '7%',\n          containLabel: true\n        },\n        xAxis: {\n          data: pielegendData\n        },\n        yAxis: {\n          type: 'value'\n        },\n        series: [{\n          type: 'bar',\n          data: pieData\n        }]\n      };\n      var opt3 = {\n        title: {\n          text: '维修时长统计'\n        },\n        tooltip: {\n          //提示框组件\n          trigger: 'item',\n          //触发类型,'item'数据项图形触发，主要在散点图，饼图等无类目轴的图表中使用。 'axis'坐标轴触发，主要在柱状图，折线图等会使用类目轴的图表中使用。\n          showContent: true,\n          //是否显示提示框浮层\n          formatter: '{b0}: {c0}' //提示框浮层内容格式器，支持字符串模板和回调函数两种形式,模板变量有 {a}, {b}，{c}，{d}，{e}，分别表示系列名，数据名，数据值等\n\n        },\n        grid: {\n          left: '20%',\n          right: '20%',\n          bottom: '5%',\n          containLabel: true\n        },\n        xAxis: {\n          type: 'category',\n          data: this.list3.map(function (item) {\n            return item.fieldName ? item.fieldName : item.fieldCodeCN;\n          })\n        },\n        yAxis: {\n          type: 'value'\n        },\n        series: {\n          name: '近七日收益',\n          type: 'line',\n          stack: '总量',\n          data: this.list3.map(function (item) {\n            return item.time;\n          })\n        }\n      };\n      setTimeout(function () {\n        if (document.getElementById('chartOne')) {\n          _this3.chart1 = _this3.$echarts.init(document.getElementById('chartOne'));\n\n          _this3.chart1.setOption(opt1, true);\n        }\n\n        if (document.getElementById('chartTwo')) {\n          _this3.chart2 = _this3.$echarts.init(document.getElementById('chartTwo'));\n\n          _this3.chart2.setOption(opt2, true);\n        }\n\n        if (document.getElementById('chartThree')) {\n          _this3.chart3 = _this3.$echarts.init(document.getElementById('chartThree'));\n\n          _this3.chart3.setOption(opt3, true);\n        }\n      }, 1000);\n    },\n    //表格高度计算\n    setTableHeight: function setTableHeight() {\n      this.theight = this.$myFun.getSingleTbHeight() - 200;\n    },\n    handleQuery: function handleQuery() {\n      //查询\n      this.listQuery.currentPage = 1;\n      this.getList();\n    },\n    selectRow: function selectRow(row) {\n      var _this4 = this;\n\n      this.listQuery2 = JSON.parse(JSON.stringify(this.listQuery));\n\n      switch (this.listQuery.fmStatDimensionality) {\n        case 'FMSD_DEVICE_TYPE':\n          this.listQuery2.deviceType = row.fieldCode;\n          break;\n\n        case 'FMSD_USE_DEPT':\n          this.listQuery2.useDept = row.fieldCode;\n          break;\n\n        case 'FMSD_DEVICE':\n          this.listQuery2.deviceCode = row.fieldCode;\n          break;\n\n        case 'FMSD_MAINTAIN_TYPE':\n          this.listQuery2.maintainType = row.fieldCode;\n          break;\n\n        case 'FMSD_FAULT_TYPE':\n          this.listQuery2.faultTypeCode = row.fieldCode;\n          break;\n\n        case 'FMSD_MAINTAIN_GRADE':\n          this.listQuery2.maintainGrade = row.fieldCode;\n          break;\n      }\n\n      this.listQuery2.fmStatDimensionality = 'FMSD_DATE';\n      api.queryRecords(this.listQuery2).then(function (res) {\n        _this4.list2 = res.data.list;\n        _this4.total2 = res.data.pages.count;\n      });\n    }\n  }\n};",null]}