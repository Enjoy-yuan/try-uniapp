{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js!/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/supplierSelection/optNotice/optNoticeFormation/dialog/dialogRefplan.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/supplierSelection/optNotice/optNoticeFormation/dialog/dialogRefplan.vue","mtime":1599136050889},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport _objectSpread from \"/Users/yuan/Documents/\\u5927\\u5510\\u5E7F\\u7535/dt-web/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// import { createRecords, updateRecords } from \"@/api/productionMaterial/hand_pull_material\";\nimport { DICT_CODE } from '@/utils/constant';\nimport caiGou from '@/components/Select/xtpt/caigou'; //下拉组件\n\nimport dialogGysxz from '@/components/Dialog/dialogsGysxz'; //供应商选择\n\nimport { mapState } from \"vuex\"; // import * as api from \"@/api/project/srm/supplierSelect/optNotice/optNoticeFormation\"\n\nimport * as api from \"@/api/project/srm/supplierSelect/optNotice/optNoticeFormation\"; // import { queryRFQItems, queryRFQRecords } from \"@/api/project/srm/supplierSelect/supplierRFQ/supplierRFQAnswer\"\n\nexport default {\n  name: 'dialogAdd',\n  components: {\n    caiGou: caiGou,\n    dialogGysxz: dialogGysxz\n  },\n  props: ['unMutiple', 'title', 'curdialogStatus'],\n  data: function data() {\n    return {\n      DICT_CODE: DICT_CODE,\n      isEdit: false,\n      iscgEdit: false,\n      //采购是否可编辑\n      tableData: [],\n      formData: {},\n      listSelected: null,\n      //已选项\n      selectRowData: null,\n      dialogVisible: false,\n      rules: {\n        orgCode: [{\n          required: true,\n          message: '请选择',\n          trigger: 'blur'\n        }],\n        materielClassName: [{\n          required: true,\n          message: '请选择',\n          trigger: 'blur'\n        }],\n        remark: [{\n          max: 128,\n          message: '长度应小于128个字符',\n          trigger: 'blur'\n        }]\n      },\n      dialogConfig: [{\n        title: '供应商信息',\n        isRequired: false,\n        unMutiple: false\n      }, {\n        title: '申请人选择',\n        unMutiple: true,\n        propCode: 'creator',\n        propName: 'creatorName'\n      }, {\n        title: '选择物料分类信息',\n        isRequired: false,\n        unMutiple: true\n      }]\n    };\n  },\n  computed: _objectSpread({}, mapState({\n    dt_srm_pc1: function dt_srm_pc1(state) {\n      return state.dict.dt_srm_pc1;\n    } //供应商定位 合作层次\n\n  })),\n  mounted: function mounted() {\n    this.$store.dispatch(\"dict/getDicData\", [\"dt_srm_pc1\"]);\n  },\n  watch: {\n    'rangeDate': function rangeDate(value) {\n      if (value) {\n        this.listQuery.startDate = value[0];\n        this.listQuery.endDate = value[1];\n      }\n    }\n  },\n  methods: {\n    selectName: function selectName(val) {\n      this.formData.orgName = val;\n    },\n    selectMain: function selectMain(selection, row) {\n      console.log(selection, row, 'yyyy'); // this.tableData.forEach((item, indexa) => {\n      //     selection.forEach(val => {\n      //         if (item.rfqNo == val.rfqNo) {\n      //             val.rfqReplyItemVOS.forEach((v, index) => {\n      //                 console.log(v)\n      //                 this.$nextTick(() => {\n      //                     console.log(indexa, index, 'index')\n      //                     this.$refs.tbSub.toggleRowSelection(this.tableData[indexa].rfqReplyItemVOS[index], true)\n      //                 })\n      //             })\n      //         }\n      //     })\n      // })\n      // if (selection.length == 0 && row) {\n      //     this.$refs.tbSub.clearSelection()\n      // }\n    },\n    handleQuery: function handleQuery() {\n      var _this = this;\n\n      if (this.formData.orgCode) {\n        var dto = {\n          orgCode: this.formData.orgCode,\n          selectedState: 1\n        };\n        api.queryRFQRecordsCKBJ(dto).then(function (res) {\n          console.log(res, '987654');\n          _this.tableData = res.data.list.map(function (v) {\n            v.rfqReplyItemVOS.forEach(function (val) {\n              val.supplierCode = v.supplierCode;\n              val.supplierName = v.supplierName;\n              val.planNo = v.planNo;\n            });\n            return v;\n          });\n        });\n      } else {\n        this.$message({\n          title: '警告',\n          message: '请选择组织编码',\n          type: 'warning'\n        });\n      }\n    },\n    handleConfirm: function handleConfirm() {\n      var _this2 = this;\n\n      this.$refs.refForm.validate(function (valid) {\n        if (valid) {\n          _this2.$confirm('确认保存吗?', '提示', {\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n            type: 'warning'\n          }).then(function () {\n            var dto = {\n              businessType: _this2.formData.businessType,\n              content: _this2.formData.content,\n              orgCode: _this2.formData.orgCode,\n              orgName: _this2.formData.orgName,\n              remark: _this2.formData.remark,\n              materialDTOS: []\n            };\n\n            if (_this2.selectlistRow) {\n              console.log(_this2.selectlistRow, 'kkkllll');\n\n              _this2.selectlistRow.forEach(function (val) {\n                val.rfqReplyItemVOS.forEach(function (v) {\n                  dto.materialDTOS.push(v);\n                }); // dto.materialDTOS[index] = val.rfqReplyItemVOS\n              });\n            }\n\n            if (_this2.selectlistRowSub) {\n              _this2.selectlistRowSub.forEach(function (val) {\n                dto.materialDTOS.push(val);\n              });\n            }\n\n            dto.materialDTOS.map(function (v) {\n              v.materialCode = v.materielCode;\n              v.materialName = v.materielName;\n              v.materialClass = v.materielClass;\n              v.materialClassName = v.materielClassName;\n              return v;\n            });\n            console.log(dto, '9999');\n            api.createPlan(dto).then(function () {\n              _this2.$message({\n                title: '成功',\n                message: '保存成功',\n                type: 'success',\n                duration: 2000\n              });\n            });\n            _this2.dialogVisible = false;\n\n            _this2.$emit('refresh');\n          }).catch(function () {\n            _this2.$message({\n              type: 'info',\n              message: '已取消'\n            });\n          });\n        }\n      });\n    },\n    initForm: function initForm(type, row) {\n      console.log(type, row);\n      this.tableData = [{\n        index: 0,\n        orgCode: 1,\n        tableInnerData: [{\n          index: 0,\n          materielCode: '0001',\n          materielName: 'XXX'\n        }]\n      }]; // if (type === 'add') {\n      //     this.$nextTick(() => {\n      //         // this.$refs['refForm'].resetFields()\n      //         // this.$refs['refForm'].clearValidate()\n      //         // this.$set(this.formData, 'proposalItemDTOs', [])\n      //         // this.$set(this.formData, 'creator', this.domainCode)\n      //         // this.$set(this.formData, 'creatorName', this.domainCodeName)\n      //         for (let key in this.formData) {\n      //             for (let par in row) {\n      //                 if (key === par) {\n      //                     this.$set(this.formData, key, row[key])\n      //                 }\n      //             }\n      //         }\n      //     })\n      // } else {\n      //     for (let key in this.formData) {\n      //         for (let par in row) {\n      //             if (key === par) {\n      //                 if (row[key]) {\n      //                     this.$set(this.formData, key, row[key])\n      //                 }\n      //             }\n      //         }\n      //     }\n      // }\n    },\n    showGys: function showGys() {\n      this.$refs.refGys.getList();\n      this.$refs.refGys.dialogVisible = true;\n    },\n    //供应商确认\n    handleGysClick: function handleGysClick(gysRows) {\n      this.$set(this.formData, 'supplierCode', gysRows[0].supplierCode);\n      this.$set(this.formData, 'supplierName', gysRows[0].supplierName);\n    },\n    setOrgName: function setOrgName(name) {\n      this.formData.orgName = name;\n    },\n    // 表格选择框选中 注:参数为选中的所有行的数组\n    selectChange: function selectChange(val) {\n      this.selectlistRow = val;\n    },\n    selectChangeSub: function selectChangeSub(val) {\n      this.selectlistRowSub = val;\n    },\n    resetTemp: function resetTemp() {\n      this.formData = {\n        orgCode: undefined,\n        supplierName: undefined,\n        planNo: undefined,\n        businessType: undefined,\n        content: undefined,\n        remark: undefined,\n        tableData: []\n      };\n    }\n  }\n};",null]}