{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js!/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/contractManage/contractTemplate/supplierFeedback/dialog/addMain.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/contractManage/contractTemplate/supplierFeedback/dialog/addMain.vue","mtime":1596610933614},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"/Users/yuan/Documents/\\u5927\\u5510\\u5E7F\\u7535/dt-web/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport * as api from \"@/api/project/srm/contractManage/specialPaymentMethod\";\nimport { mapState } from \"vuex\";\nimport dialogGysxz from '@/components/Dialog/dialogsGysxz'; //供应商选择\n\nexport default {\n  components: {\n    dialogGysxz: dialogGysxz\n  },\n  data: function data() {\n    return {\n      dialogStatus: '',\n      dialogVisible: false,\n      temp: {\n        rowId: undefined,\n        feedbackPaymentType: undefined,\n        feedbackPaymentPeriod: undefined,\n        feedbackSettlementType: undefined\n      },\n      showIsItem: false,\n      rules: {\n        feedbackSettlementType: [{\n          required: true,\n          message: '结算方式不能为空',\n          trigger: 'blur'\n        }],\n        feedbackPaymentType: [{\n          required: true,\n          message: '付款方式不能为空',\n          trigger: 'blur'\n        }],\n        feedbackPaymentPeriod: [{\n          required: true,\n          message: '付款周期不能为空',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  computed: _objectSpread({}, mapState({\n    dt_srm_pdr: function dt_srm_pdr(state) {\n      return state.dict.dt_srm_pdr;\n    },\n    dt_srm_pdt: function dt_srm_pdt(state) {\n      return state.dict.dt_srm_pdt;\n    },\n    dt_srm_pdu: function dt_srm_pdu(state) {\n      return state.dict.dt_srm_pdu;\n    },\n    dt_srm_pan: function dt_srm_pan(state) {\n      return state.dict.dt_srm_pan;\n    }\n  })),\n  mounted: function mounted() {\n    this.$store.dispatch(\"dict/getDicData\", [\"dt_srm_pdr\", 'dt_srm_pdt', 'dt_srm_pdu', 'dt_srm_pan']);\n  },\n  methods: {\n    handleSupplier: function handleSupplier() {\n      this.$refs.refGys.dialogVisible = true;\n    },\n    //供应商选择确定\n    handleGysClick: function handleGysClick(val) {\n      this.$set(this.temp, 'supplierCode', val[0].supplierCode);\n      this.$set(this.temp, 'supplierName', val[0].supplierName);\n    },\n    //付款方式项是否展示\n    showItem: function showItem() {\n      if (this.temp.feedbackResult === '1') {\n        this.showIsItem = false;\n      } else {\n        this.showIsItem = true;\n      }\n\n      if (this.showIsItem === true) {\n        delete this.temp.feedbackSettlementType;\n        delete this.temp.feedbackPaymentType;\n        delete this.temp.feedbackPaymentPeriod;\n      }\n    },\n    //结算方式\n    getSettlementType: function getSettlementType(val) {\n      var dictList = this.dt_srm_pdt.filter(function (v) {\n        return v.dictItemKey === val;\n      });\n      this.temp.feedbackSettlementTypeCN = dictList[0].dictItemValue;\n    },\n    //付款方式\n    getPaymentType: function getPaymentType(val) {\n      var dictList = this.dt_srm_pdr.filter(function (v) {\n        return v.dictItemKey === val;\n      });\n      this.temp.feedbackPaymentTypeCN = dictList[0].dictItemValue;\n    },\n    //付款周期\n    getPaymentPeriod: function getPaymentPeriod(val) {\n      var dictList = this.dt_srm_pdu.filter(function (v) {\n        return v.dictItemKey === val;\n      });\n      this.temp.feedbackPaymentPeriodCN = dictList[0].dictItemValue;\n    },\n    //编辑弹框确定事件\n    updateData: function updateData() {\n      var _this = this;\n\n      if (this.showIsItem === true) {\n        this.$refs.dataForm.validate(function (valid) {\n          if (valid) {\n            var a = _this.temp.feedbackPaymentTypeCN + '/' + _this.temp.feedbackPaymentPeriodCN + '/' + _this.temp.feedbackSettlementTypeCN;\n\n            if (a !== _this.temp.regularPayment) {\n              var dto = {\n                feedbackExplain: _this.temp.feedbackExplain,\n                feedbackPaymentPeriod: _this.temp.feedbackPaymentPeriod,\n                feedbackPaymentType: _this.temp.feedbackPaymentType,\n                feedbackResult: _this.temp.feedbackResult,\n                feedbackSettlementType: _this.temp.feedbackSettlementType\n              };\n              api.updateRecord(_this.temp.rowId, dto).then(function () {\n                _this.$message({\n                  title: '成功',\n                  message: '编辑成功',\n                  type: 'success',\n                  duration: 2000\n                });\n\n                _this.dialogVisible = false;\n\n                _this.$emit('refresh');\n              });\n            } else {\n              _this.$message({\n                title: '警告',\n                message: '付款方式内容相同请重输',\n                type: 'warning',\n                duration: 2000\n              });\n            }\n          } else {\n            return false;\n          }\n        });\n      } else {\n        var dto = {\n          feedbackExplain: this.temp.feedbackExplain,\n          feedbackPaymentPeriod: this.temp.feedbackPaymentPeriod,\n          feedbackPaymentType: this.temp.feedbackPaymentType,\n          feedbackResult: this.temp.feedbackResult,\n          feedbackSettlementType: this.temp.feedbackSettlementType\n        };\n        console.log(dto, 'kkk');\n        api.updateRecord(this.temp.rowId, dto).then(function () {\n          _this.$message({\n            title: '成功',\n            message: '新增成功',\n            type: 'success',\n            duration: 2000\n          });\n\n          _this.dialogVisible = false;\n\n          _this.$emit('refresh');\n        });\n      }\n    }\n  }\n};",null]}