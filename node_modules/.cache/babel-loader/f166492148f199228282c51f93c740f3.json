{"remainingRequest":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/babel-loader/lib/index.js!/Users/yuan/Documents/大唐广电/cf_web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuan/Documents/大唐广电/cf_web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/cf_web/src/views/data-base/materielTransferType/dialog/dialogAddSub2.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/cf_web/src/views/data-base/materielTransferType/dialog/dialogAddSub2.vue","mtime":1600927611454},{"path":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/cf_web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport _objectSpread from \"/Users/yuan/Documents/\\u5927\\u5510\\u5E7F\\u7535/cf_web/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { createSubLeft, updateSubLeft, getAttrRules, getPIList } from '@/api/data-base/material_transfer_type';\nimport { mapState } from 'vuex';\nexport default {\n  name: 'addSub2',\n  components: {},\n  props: ['statisticTypeList'],\n  data: function data() {\n    return {\n      isEditO: false,\n      booleanValue: [[{\n        value: 1,\n        label: '是'\n      }, {\n        value: 0,\n        label: '否'\n      }], [{\n        value: 1,\n        label: '有效'\n      }, {\n        value: 0,\n        label: '无效'\n      }], [{\n        value: 1,\n        label: '+'\n      }, {\n        value: 0,\n        label: '-'\n      }]],\n      proofList: [],\n      AddSublist: {\n        wareRuleCode: '',\n        wareRuleName: '',\n        targetWareRuleCode: '',\n        status: '',\n        description: '',\n        wareRuleHandleDetails: []\n      },\n      indicateBizTypeList: [],\n      dialogStatus: 0,\n      dialogFormVisible: false,\n      rules: {\n        mainUpdateObject: [{\n          required: true,\n          message: '主体更新对象不能为空',\n          trigger: 'blur'\n        }],\n        detailUpdateObject: [{\n          required: true,\n          message: '明细更新对象不能为空',\n          trigger: 'blur'\n        }],\n        serviceName: [{\n          required: true,\n          message: 'service服务名称不能为空',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  mounted: function mounted() {\n    this.$store.dispatch('dict/getDicData', ['dt_referdata_resource']);\n  },\n  computed: _objectSpread({}, mapState({\n    dt_referdata_resource: function dt_referdata_resource(state) {\n      return state.dict.dt_referdata_resource;\n    }\n  })),\n  methods: {\n    addSubConfirm: function addSubConfirm() {\n      var _this = this;\n\n      console.log(33333, this.AddSublist);\n      createSubLeft(this.AddSublist.wareRuleCode, this.AddSublist, 'i').then(function () {\n        _this.$message({\n          type: 'success',\n          message: '添加成功'\n        });\n\n        _this.$emit('refresh');\n\n        _this.dialogFormVisible = false;\n      });\n    },\n    updateSubConfirm: function updateSubConfirm() {\n      var _this2 = this;\n\n      console.log(44444, this.AddSublist);\n      updateSubLeft(this.AddSublist.wareRuleCode, this.AddSublist.rowId, this.AddSublist, 'i').then(function () {\n        _this2.$message({\n          type: 'success',\n          message: '编辑成功'\n        });\n\n        _this2.$emit('refresh');\n\n        _this2.dialogFormVisible = false;\n      });\n    },\n    setCorAttrName: function setCorAttrName(row) {\n      var _this3 = this;\n\n      var attributeName = '';\n      var rowId = '';\n      this.proofList.forEach(function (item) {\n        if (item.attributeCode === row.sourceConfigCode) {\n          attributeName = item.attributeName;\n          rowId = item.rowId;\n        }\n      });\n      this.AddSublist.wareRuleHandleDetails.forEach(function (item, index) {\n        if (item.targetRefItemRowId === row.targetRefItemRowId) {\n          _this3.AddSublist.wareRuleHandleDetails[index].sourceConfigName = attributeName;\n          _this3.AddSublist.wareRuleHandleDetails[index].sourceRefItemRowId = rowId;\n        }\n      });\n    },\n    //指示凭证变化\n    changeItype: function changeItype() {// this.AddSublist.wareRuleHandleDetails=[];\n      // let refSources = '';\n      // console.log(this.indicateBizTypeList);\n      // this.indicateBizTypeList.forEach((item,index)=>{\n      //     if(item.wareRuleCode===this.AddSublist.targetWareRuleCode){\n      //         refSources = item.refSources;\n      //     }\n      // });\n      // let queryRules = {\n      //     referentType:refSources\n      // }\n      // getAttrRules(queryRules).then(res=>{\n      //     res.forEach(item=>{\n      //         this.setDetail(item.rowId,item.objectType);\n      //     })\n      // })\n    },\n    checkVal: function checkVal() {\n      if (!this.AddSublist.targetWareRuleCode) {\n        return {\n          state: false,\n          info: '请选择指示类型'\n        };\n      }\n\n      if (!this.AddSublist.wareRuleHandleDetails) {\n        return {\n          state: false,\n          info: '请选择对应指示名称'\n        };\n      } else if (this.AddSublist.wareRuleHandleDetails.length) {\n        for (var i = 0; i < this.AddSublist.wareRuleHandleDetails.length; i++) {\n          if (!this.AddSublist.wareRuleHandleDetails[i].sourceConfigCode) {\n            return {\n              state: false,\n              info: '请选择对应指示名称'\n            };\n          }\n        }\n      }\n\n      return {\n        state: true,\n        info: '检验通过'\n      };\n    },\n    setDetail: function setDetail(rowId, objectType) {\n      var _this4 = this;\n\n      console.log(11111, rowId, objectType);\n      getPIList(rowId).then(function (resi) {\n        for (var j = 0; j < resi.data.length; j++) {\n          _this4.AddSublist.wareRuleHandleDetails.push({\n            targetRefRowId: rowId,\n            targetRefItemRowId: resi.data[j].rowId,\n            objectType: objectType,\n            targetConfigCode: resi.data[j].attributeCode,\n            targetConfigName: resi.data[j].attributeName\n          });\n        }\n      });\n    },\n    //选择参照数据来源变化时状态变化\n    changeReferData: function changeReferData(val) {\n      var _this5 = this;\n\n      var queryRules = {\n        referentType: val\n      };\n      getAttrRules(queryRules).then(function (res) {\n        _this5.AddSublist.wareRuleHandleDetails = [];\n        _this5.isEditO = false;\n        res.data.forEach(function (item) {\n          if (item.objectType === 1) {\n            _this5.AddSublist.mainUpdateObject = item.referentObject;\n          } else if (item.objectType === 2) {\n            _this5.AddSublist.detailUpdateObject = item.referentObject;\n          }\n\n          _this5.setDetail(item.rowId, item.objectType);\n        });\n        _this5.isEditO = true;\n      });\n    }\n  }\n};",null]}