{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js!/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/contractManage/contractTemplate/specialPaymentMethod/content/dialog/addMain.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/SRM/contractManage/contractTemplate/specialPaymentMethod/content/dialog/addMain.vue","mtime":1596610933611},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _toConsumableArray from \"/Users/yuan/Documents/\\u5927\\u5510\\u5E7F\\u7535/dt-web/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/Users/yuan/Documents/\\u5927\\u5510\\u5E7F\\u7535/dt-web/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport * as api from \"@/api/project/srm/contractManage/specialPaymentMethod\";\nimport * as api1 from \"@/api/project/srm/contractManage/paymentMethod\";\nimport { queryRecords } from \"@/api/project/srm/procurementDemand/divisionRules\";\nimport { DICT_CODE } from '@/utils/constant';\nimport caiGou from '@/components/Select/xtpt/caigou'; //下拉组件\n\nimport dialogGysxz from '@/components/Dialog/dialogPlatformGys'; //平台供应商选择\n\nimport { mapState } from 'vuex';\nimport throttle from 'lodash/throttle';\nexport default {\n  components: {\n    dialogGysxz: dialogGysxz,\n    caiGou: caiGou\n  },\n  data: function data() {\n    return {\n      DICT_CODE: DICT_CODE,\n      temp: {\n        supplierCode: undefined,\n        regularPaymentPeriod: undefined,\n        regularPaymentType: undefined,\n        regularSettlementType: undefined,\n        createItemDTOList: null\n      },\n      tableKey: 0,\n      list: [],\n      dialogStatus: \"\",\n      dialogVisible: false,\n      Edit: false,\n      rules: {\n        purchaseOrg: [{\n          required: true,\n          message: '采购组织不能为空',\n          trigger: 'blur'\n        }],\n        years: [{\n          required: true,\n          message: '年度不能为空',\n          trigger: 'blur'\n        }],\n        requireFeedbackTime: [{\n          required: true,\n          message: '要求反馈时间不能为空',\n          trigger: 'blur'\n        }],\n        number1: [{\n          required: true,\n          message: '常规付款方式和不能为空',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  computed: _objectSpread({}, mapState({\n    dt_srm_pdr: function dt_srm_pdr(state) {\n      return state.dict.dt_srm_pdr;\n    },\n    dt_srm_pdt: function dt_srm_pdt(state) {\n      return state.dict.dt_srm_pdt;\n    },\n    dt_srm_pdu: function dt_srm_pdu(state) {\n      return state.dict.dt_srm_pdu;\n    },\n    dt_srm_pax: function dt_srm_pax(state) {\n      return state.dict.dt_srm_pax;\n    }\n  })),\n  mounted: function mounted() {\n    this.$store.dispatch(\"dict/getDicData\", ['dt_srm_pdr', 'dt_srm_pdt', 'dt_srm_pdu', 'dt_srm_pax']);\n  },\n  methods: {\n    //供应商选择确定\n    handleGysClick: function handleGysClick(val) {\n      console.log(val);\n      this.list = val;\n    },\n    //获取商务经理名称\n    getBusinessName: function getBusinessName() {\n      var _this = this;\n\n      var dto = {\n        purchaseOrg: this.temp.purchaseOrg,\n        divisionType: 'PBB1',\n        currentPage: 1,\n        pageSize: 15\n      };\n      queryRecords(dto).then(function (res) {\n        _this.temp.businessManagerName = res.data.list[0].assigneeName;\n        _this.temp.businessManager = res.data.list[0].assignee;\n      });\n\n      if (this.temp.purchaseOrg !== undefined) {\n        this.Edit = false;\n      } else {\n        this.Edit = true;\n      }\n    },\n    //获取付款方式\n    getPayment: function getPayment() {\n      var _this2 = this;\n\n      if (this.temp.purchaseOrg !== undefined) {\n        console.log(1);\n        var dto = {\n          purchaseOrg: this.temp.purchaseOrg,\n          year: this.temp.years\n        };\n        api1.queryRecords(dto).then(function (res) {\n          var options = [_this2.dt_srm_pdr, _this2.dt_srm_pdt, _this2.dt_srm_pdu];\n          res.data.list = _this2.$myFun.srmCodeToName(res.data.list, options, ['paymentType', 'settlementType', 'paymentPeriod']);\n          var dto = res.data.list;\n\n          if (res.data.pages.count > 0) {\n            _this2.temp.number1 = dto[0].paymentTypeCN + '/' + dto[0].paymentPeriodCN + '/' + dto[0].settlementTypeCN;\n            _this2.temp.regularPaymentType = dto[0].paymentType; //付款方式\n\n            _this2.temp.regularPaymentPeriod = dto[0].paymentPeriod; //付款周期\n\n            _this2.temp.regularSettlementType = dto[0].settlementType; //结算方式\n\n            console.log(_this2.temp.regularPaymentType, dto[0].paymentType, 'pp');\n          } else {\n            _this2.temp.number1 = undefined;\n          }\n        });\n      } else {\n        this.$message({\n          title: '警告',\n          message: '请先选择采购组织',\n          type: 'warning',\n          duration: 2000\n        });\n      }\n    },\n    //获取采购组织名称\n    selectName: function selectName(val) {\n      this.temp.purchaseOrgName = val;\n    },\n    handleDelete: function handleDelete(index, val) {\n      var _this3 = this;\n\n      this.$confirm(\"确认要删除该数据项吗?\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(function () {\n        _this3.list = _this3.list.filter(function (item) {\n          var isD = true;\n\n          if (val.rowId === item.rowId) {\n            isD = false;\n          }\n\n          return isD;\n        });\n\n        _this3.$message({\n          type: \"success\",\n          message: \"删除成功\"\n        });\n      }).catch(function () {\n        _this3.$message({\n          type: \"info\",\n          message: \"已取消\"\n        });\n      });\n    },\n    handleCreate: function handleCreate() {\n      var _this4 = this;\n\n      this.$refs.refGys.dialogVisible = true;\n      this.$nextTick(function () {\n        _this4.$refs.refGys.listSelected = _toConsumableArray(_this4.list);\n\n        _this4.$refs.refGys.getList();\n      });\n    },\n    createData: throttle(function () {\n      var _this5 = this;\n\n      var options = [this.dt_srm_pax];\n      this.list = this.$myFun.srmCodeToName(this.list, options, ['supplyClassification']);\n      var createItemDTOList = this.list.map(function (v) {\n        var a = {\n          isArrivalPrinting: v.isArrivalPrinting,\n          partsUse: v.partsUse,\n          supplierCode: v.supplierCode,\n          supplierName: v.supplierName,\n          supplyClassification: v.supplyClassification,\n          supplyClassificationName: v.supplyClassificationCN\n        };\n        return a;\n      });\n      this.temp.createItemDTOList = createItemDTOList;\n      this.$refs.dataForm.validate(function (valid) {\n        if (valid) {\n          if (_this5.list.length > 0) {\n            api.addRecord(_this5.temp).then(function () {\n              _this5.$message({\n                title: '成功',\n                message: '新增成功',\n                type: 'success',\n                duration: 2000\n              });\n\n              _this5.dialogVisible = false;\n\n              _this5.$emit('refresh');\n            });\n          } else {\n            _this5.$message({\n              title: '警告',\n              message: '请先选择供应商信息',\n              type: 'warning',\n              duration: 2000\n            });\n          }\n        } else {\n          return false;\n        }\n      });\n    }, 2000, {\n      leading: true,\n      trailing: false\n    }),\n    handleClose: function handleClose() {\n      this.resetTemp();\n      this.$refs.dataForm.resetFields();\n    },\n    resetTemp: function resetTemp() {\n      this.temp = {\n        purchaseOrg: undefined,\n        years: undefined,\n        requireFeedbackTime: undefined,\n        number1: undefined\n      };\n    }\n  }\n};",null]}