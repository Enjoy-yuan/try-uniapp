{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js!/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/EAS/database/deviceType/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/EAS/database/deviceType/index.vue","mtime":1596610933477},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Pagination from '@/components/Pagination'; // Secondary package based on el-pagination\n\nimport * as api from '@/api/project/eas/database/eqmt';\nexport default {\n  name: 'eqmt',\n  components: {\n    Pagination: Pagination\n  },\n  data: function data() {\n    return {\n      tableKey: 0,\n      defaultProps: {\n        rowId: 'rowId',\n        // 父级唯一标识\n        children: 'children',\n        label: 'typeName'\n      },\n      contentStyleObj: {\n        height: null\n      },\n      list: [],\n      list2: [],\n      treeData: [],\n      theight: 0,\n      //表格高度\n      total: 0,\n      total1: 0,\n      listLoading: true,\n      listQuery: {\n        currentPage: 1,\n        pageSize: 10,\n        typeCode: undefined,\n        typeName: undefined\n      },\n      temp: {\n        typeName: undefined,\n        typeCode: undefined,\n        superiorCode: undefined,\n        remark: undefined\n      },\n      temp2: {\n        partName: undefined,\n        rowId: undefined\n      },\n      dialogStatus: '',\n      dialogStatus2: '',\n      dialogFormVisible: false,\n      partStatus: 'create',\n      selectlistRow: [],\n      partName: undefined\n    };\n  },\n  created: function created() {\n    this.getList();\n    this.getTree();\n    this.getHeight();\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    this.setTableHeight(); //表格高度自适应\n\n    window.onresize = function () {\n      _this.setTableHeight();\n\n      _this.setTreeHeight();\n    };\n\n    this.getList();\n    this.setTreeHeight();\n  },\n  methods: {\n    getHeight: function getHeight() {\n      //自适应高度\n      this.contentStyleObj.height = document.body.scrollHeight - 110 + 'px';\n    },\n    //表格高度计算\n    setTableHeight: function setTableHeight() {\n      this.theight = this.$myFun.getSingleTbHeight() / 2.2;\n    },\n    //树高度设置\n    setTreeHeight: function setTreeHeight() {\n      this.contentStyleObj.height = this.$myFun.getTreehHeight();\n    },\n    destroyed: function destroyed() {\n      //自适应窗体大小\n      window.removeEventListener('resize', this.getHeight);\n    },\n    resetTemp: function resetTemp() {\n      this.temp = {\n        typeName: undefined,\n        typeCode: undefined,\n        superiorCode: undefined,\n        remark: undefined\n      };\n    },\n    getList: function getList() {\n      var _this2 = this;\n\n      //获取数据\n      api.queryRecords(this.listQuery).then(function (res) {\n        _this2.list = res.data.list.filter(function (item) {\n          return item.typeName != '设备类型';\n        });\n        _this2.total = res.data.pages.count;\n\n        if (_this2.list.length) {\n          _this2.$nextTick(function () {\n            _this2.$refs.tb_a.toggleRowSelection(_this2.list[0]);\n          });\n        } else {\n          _this2.list2 = [];\n        } // this.list2 = []\n\n      });\n    },\n    getList2: function getList2() {\n      var _this3 = this;\n\n      //获取数据\n      api.queryRecords2(this.selectlistRow[0].typeCode).then(function (res) {\n        _this3.list2 = res.data;\n      });\n    },\n    getTree: function getTree() {\n      var _this4 = this;\n\n      //获取树数据\n      api.queryRecords().then(function (res) {\n        _this4.treeData = _this4.$myFun.buildTree(res.data, 'typeCode', 'superiorCode');\n        setTimeout(function () {\n          _this4.listLoading = false;\n        }, 1.5 * 100);\n      });\n    },\n    handleEdit: function handleEdit() {\n      //更新弹窗调用\n      if (this.selectlistRow.length) {\n        this.temp = this.selectlistRow[0]; // copy obj\n\n        this.dialogStatus = 'update';\n        this.dialogFormVisible = true;\n      } else {\n        this.$message({\n          title: '警告',\n          message: '请选择一条信息',\n          type: 'warning'\n        });\n      }\n    },\n    handleCreate: function handleCreate() {\n      //新增弹窗调用\n      if (this.listQuery.superiorCode) {\n        this.resetTemp();\n        this.temp.superiorCode = this.listQuery.superiorCode;\n        this.dialogStatus = 'create';\n        this.dialogFormVisible = true;\n      } else {\n        this.$message({\n          title: '警告',\n          message: '请选择左侧上级菜单',\n          type: 'warning'\n        });\n      }\n    },\n    handleCreateFrom: function handleCreateFrom() {\n      var _this5 = this;\n\n      //新增部件弹窗调用\n      if (!this.selectlistRow.length) {\n        this.$message({\n          title: '警告',\n          message: '请选择设备类型',\n          type: 'warning'\n        });\n        return false;\n      }\n\n      if (!this.temp2.partName) {\n        this.$message({\n          title: '警告',\n          message: '请输入部位名称',\n          type: 'warning'\n        });\n        return false;\n      }\n\n      api.addRecords2({\n        partName: this.temp2.partName,\n        typeCode: this.selectlistRow[0].typeCode\n      }).then(function (res) {\n        if (res.status == 201) {\n          _this5.getList2();\n\n          _this5.dialogFormVisible2 = false;\n\n          _this5.$message({\n            title: '成功',\n            message: '添加成功',\n            type: 'success',\n            duration: 2000\n          });\n\n          _this5.temp2.partName = undefined;\n        }\n      });\n    },\n    createFrom: function createFrom() {\n      var _this6 = this;\n\n      api.addRecords(this.temp).then(function (res) {\n        if (res.status == 201) {\n          _this6.getList();\n\n          _this6.getTree();\n\n          _this6.dialogFormVisible = false;\n\n          _this6.$message({\n            title: '成功',\n            message: '新增成功',\n            type: 'success',\n            duration: 2000\n          });\n        }\n      });\n    },\n    handleEditRow: function handleEditRow(scope) {\n      this.partStatus = 'update';\n      this.dialogFormVisible2 = true;\n      this.temp2 = scope.row;\n    },\n    editForm: function editForm() {\n      var _this7 = this;\n\n      api.patchRecords(this.temp).then(function (res) {\n        if (res.status == 201) {\n          _this7.getList();\n\n          _this7.getTree();\n\n          _this7.dialogFormVisible = false;\n\n          _this7.$message({\n            title: '成功',\n            message: '修改成功',\n            type: 'success',\n            duration: 2000\n          });\n        }\n      });\n    },\n    editForm2: function editForm2() {\n      var _this8 = this;\n\n      api.patchRecords2(this.temp2).then(function (res) {\n        if (res.status == 201) {\n          _this8.temp2.partName = undefined;\n          _this8.partStatus = 'create';\n          _this8.dialogFormVisible2 = false;\n\n          _this8.$message({\n            title: '成功',\n            message: '修改成功',\n            type: 'success',\n            duration: 2000\n          });\n\n          _this8.getList2();\n        }\n      });\n    },\n    cancelEdit: function cancelEdit() {\n      this.temp2.partName = undefined;\n      this.partStatus = 'create';\n      this.getList2();\n    },\n    handleDelete: function handleDelete() {\n      var _this9 = this;\n\n      api.deleteRecords(this.selectlistRow[0].typeCode).then(function (res) {\n        if (res.status == 204) {\n          _this9.getList();\n\n          _this9.getTree();\n\n          _this9.dialogFormVisible = false;\n\n          _this9.$message({\n            title: '成功',\n            message: '删除成功',\n            type: 'success',\n            duration: 2000\n          });\n        }\n      });\n    },\n    handleFilter: function handleFilter() {\n      this.listQuery.superiorCode = undefined;\n      this.listQuery.currentPage = 1; //查询\n\n      this.getList();\n    },\n    handleCreateRow: function handleCreateRow() {\n      var _this10 = this;\n\n      if (!this.selectlistRow.length) {\n        this.$message({\n          title: '警告',\n          message: '请选择设备',\n          type: 'warning'\n        });\n        return false;\n      }\n\n      api.addRecords2({\n        partName: this.temp2.partName,\n        typeCode: this.selectlistRow[0].typeCode\n      }).then(function (res) {\n        if (res.status == 201) {\n          _this10.getList2();\n\n          _this10.dialogFormVisible2 = false;\n\n          _this10.$message({\n            title: '成功',\n            message: '添加成功',\n            type: 'success',\n            duration: 2000\n          });\n        }\n      });\n    },\n    handleDeleteRow: function handleDeleteRow(row) {\n      var _this11 = this;\n\n      this.$confirm('是否对' + row.partName + '部位进行删除?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        //删除\n        api.deleteRecords2(row.rowId).then(function (res) {\n          if (res.status == 204) {\n            _this11.getList2();\n\n            _this11.dialogFormVisible = false;\n\n            _this11.$message({\n              title: '成功',\n              message: '删除成功',\n              type: 'success',\n              duration: 2000\n            });\n          }\n        });\n      }).catch(function () {\n        _this11.$message({\n          type: 'info',\n          message: '已取消'\n        });\n      });\n    },\n    // 获取表格选中时的数据\n    selectRow: function selectRow(val) {\n      this.$refs.tb_a.toggleRowSelection(val, 'selected');\n    },\n    rowClick: function rowClick(val) {\n      this.selectlistRow = val;\n\n      if (val.length == 0) {\n        this.selectlistRow = []; // this.list2 = []\n\n        return false;\n      }\n\n      if (val.length > 1) {\n        this.$refs.tb_a.clearSelection();\n        this.$refs.tb_a.toggleRowSelection(val[val.length - 1]);\n      }\n\n      this.$refs.tb_a.setCurrentRow(this.selectlistRow[0]);\n\n      if (this.selectlistRow.length) {\n        this.getList2();\n      }\n    },\n    handleNodeClick: function handleNodeClick(data) {\n      //点击树查询\n      this.listQuery.superiorCode = data.typeCode; // this.listQuery.typeCode = data.typeCode\n\n      this.getList();\n    }\n  }\n};",null]}