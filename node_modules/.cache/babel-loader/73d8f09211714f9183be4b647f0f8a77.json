{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js!/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/IOT/MOM/projectCenter/subMain.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/IOT/MOM/projectCenter/subMain.vue","mtime":1597995949044},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"/Users/yuan/Documents/\\u5927\\u5510\\u5E7F\\u7535/dt-web/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport * as api from \"@/api/project/iot/IOT/em\";\nimport { queryRecords } from \"@/api/project/iot/PM/equipmentProducts\";\nimport Pagination from \"@/components/Pagination\";\nimport throttle from 'lodash/throttle';\nimport { mapState } from 'vuex';\nexport default {\n  name: \"GPSubMain\",\n  props: ['code', 'manufacturersList'],\n  components: {\n    Pagination: Pagination\n  },\n  data: function data() {\n    return {\n      listLoading: false,\n      theight: 0,\n      //表格高度\n      list: null,\n      total: 0,\n      listQuery: {\n        page: true,\n        currentPage: 1,\n        pageSize: 15,\n        typeCode: undefined,\n        typeName: undefined,\n        deviceName: undefined,\n        iotState: undefined\n      },\n      deviceTypeList: null,\n      tableKey: 0 //表格索引\n\n    };\n  },\n  watch: {\n    'listQuery.typeName': function listQueryTypeName(val) {\n      if (!val) {\n        this.listQuery.typeCode = undefined;\n      }\n    }\n  },\n  computed: _objectSpread({}, mapState({\n    iot_state_device: function iot_state_device(state) {\n      return state.iotDict.iot_state_device;\n    },\n    iot_project_type: function iot_project_type(state) {\n      return state.iotDict.iot_project_type;\n    }\n  })),\n  mounted: function mounted() {\n    var _this = this;\n\n    this.setTableHeight(); //表格高度自适应\n\n    window.onresize = function () {\n      _this.setTableHeight();\n    };\n\n    this.getList();\n    this.getDeviceTypeList();\n  },\n  methods: {\n    stateClass: function stateClass(state) {\n      if (state == '0') {\n        return 'iot-warning';\n      } else if (state == '1') {\n        return 'iot-success';\n      } else if (state == '2') {\n        return 'iot-info';\n      }\n    },\n    //表格高度计算\n    setTableHeight: function setTableHeight() {\n      this.theight = this.$myFun.getSingleTbHeight();\n    },\n    toInfo: function toInfo(row) {\n      this.$emit('setRow', row);\n      this.$emit('setPage', 'info');\n    },\n    getDeviceTypeList: function getDeviceTypeList() {\n      var _this2 = this;\n\n      var listQuery = {\n        currentPage: 1,\n        pageSize: 1000,\n        page: 1\n      };\n      queryRecords(listQuery).then(function (response) {\n        _this2.deviceTypeList = response.data.list;\n      });\n    },\n    //获取表格数据\n    getList: function getList() {\n      var _this3 = this;\n\n      this.listLoading = true;\n      api.queryProjectCodes(this.code, this.listQuery).then(function (response) {\n        _this3.list = response.data.list;\n        var options = [_this3.iot_state_device];\n        _this3.list = _this3.$myFun.srmCodeToName(response.data.list, options, ['iotState']);\n\n        if (response.data.list && _this3.manufacturersList) {\n          for (var i = 0; i < response.data.list.length; i++) {\n            for (var j = 0; j < _this3.manufacturersList.length; j++) {\n              if (response.data.list[i].manufacturersCode == _this3.manufacturersList[j].manufacturersCode) {\n                response.data.list[i].manufacturersName = _this3.manufacturersList[j].manufacturersName;\n                break;\n              }\n            }\n          }\n        }\n\n        _this3.total = response.data.pages.count;\n        setTimeout(function () {\n          _this3.listLoading = false;\n        }, 1.5 * 100);\n      });\n    },\n    //表格查询\n    handleQuery: throttle(function () {\n      this.listQuery.currentPage = 1;\n      this.getList();\n    }, 2000, {\n      leading: true,\n      trailing: false\n    }),\n    querySearch: function querySearch(queryString, cb) {\n      var restaurants = this.deviceTypeList;\n      var results = queryString ? restaurants.filter(this.createFilter(queryString)) : restaurants;\n      cb(results);\n    },\n    createFilter: function createFilter(queryString) {\n      return function (restaurant) {\n        return restaurant.typeName.toLowerCase().indexOf(queryString.toLowerCase()) !== -1;\n      };\n    },\n    handleSelect: function handleSelect(item) {\n      this.listQuery.typeCode = item ? item.typeCode : undefined;\n      this.listQuery.typeName = item ? item.typeName : undefined;\n    }\n  }\n};",null]}