{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js!/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/system/processManage/processStart/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/system/processManage/processStart/index.vue","mtime":1596610934259},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport * as api from '@/api/system/process/processStart';\nimport tabSelect from '@/components/Select/tabSelect';\nimport testUrl from \"@/views/data-base/dict\";\nexport default {\n  name: 'processStart',\n  components: {\n    testUrl: testUrl,\n    tabSelect: tabSelect\n  },\n  data: function data() {\n    return {\n      activeNames: ['1', '2', '3', '4'],\n      src: '',\n      memo: null,\n      //说明\n      linkurl: '',\n      activityId: null,\n      formData: {\n        oprate: \"1\",\n        businessKey: null,\n        processTitle: null,\n        remark: '',\n        readers: '' // info: '说明'\n\n      },\n      setPerTitle: [{\n        prop: 'activityid',\n        label: '任务编号',\n        width: null\n      }, {\n        prop: 'name',\n        label: '任务名称',\n        width: null\n      }, {\n        prop: 'defuserNames',\n        label: '执行人',\n        width: null\n      }, {\n        prop: 'defroleNames',\n        label: '执行组',\n        width: null\n      }],\n      settingList: [],\n      unMutiple: false,\n      selectIndex: null,\n      dialogIndex: 0\n    };\n  },\n  mounted: function mounted() {\n    console.log(this.$route.params);\n    this.initView();\n  },\n  methods: {\n    initView: function initView() {\n      var _this = this;\n\n      this.src = this.$route.params.src;\n      this.memo = this.$route.params.formData.memo;\n      this.activityId = this.$route.params.formData.activityId;\n      this.formData.businessKey = this.$route.params.formData.businessKey;\n      this.formData.variables = this.$route.params.formData.variables;\n      this.formData.processTitle = this.$route.params.formData.processTitle;\n      this.formData.processDefinitionKey = this.$route.params.formData.processDefinitionKey;\n      api.getViewData({\n        key: this.formData.processDefinitionKey\n      }).then(function (res) {\n        res = res.data;\n        console.log(res, 11111);\n        res.activityViewDTOList.forEach(function (item, index) {\n          if (item.type === 'UserTask') {\n            var data = {\n              activityid: item.activityid,\n              name: item.name,\n              defusers: item.defusers,\n              defuserNames: item.defuserNames,\n              defroles: item.defroles,\n              defroleNames: item.defroleNames\n            };\n            _this.settingList[index] = {};\n            console.log(data, index);\n\n            _this.$set(_this.settingList, index, data);\n          }\n        });\n        _this.settingList = _this.settingList.filter(function (item) {\n          return item;\n        });\n\n        _this.settingList.forEach(function (item, index) {\n          _this.$set(_this.settingList, index, item);\n        });\n\n        console.log(_this.settingList);\n      });\n    },\n    //提交操作\n    submitOprate: function submitOprate() {\n      var activityStartDTOS = [];\n      this.settingList.forEach(function (item) {\n        var dataDto = {\n          activityId: item.activityid,\n          assignees: item.defuserNames,\n          name: item.name,\n          roles: item.defroleNames\n        };\n        activityStartDTOS.push(dataDto);\n      });\n      this.formData.activityStartDTOS = activityStartDTOS;\n      console.log('提交', this.formData);\n      api.processStart(this.activityId, this.formData).then(function (res) {\n        console.log(res);\n      });\n    },\n    handleTabConfirm: function handleTabConfirm(val) {\n      switch (val[1]) {\n        case 0:\n          {\n            var defusersArr = [];\n            var defuserNamesArr = [];\n\n            if (val[0]) {\n              val[0].forEach(function (item) {\n                defusersArr.push(item.employeeCode);\n                defuserNamesArr.push(item.employeeName);\n              });\n              this.$set(this.settingList[this.selectIndex], 'defusers', defusersArr.join(\",\"));\n              this.$set(this.settingList[this.selectIndex], 'defuserNames', defuserNamesArr.join(\",\"));\n            } else {\n              this.$set(this.settingList[this.selectIndex], 'defusers', '');\n              this.$set(this.settingList[this.selectIndex], 'defuserNames', '');\n            }\n\n            break;\n          }\n\n        case 1:\n          {\n            var defrolesArr = [];\n            var defroleNamesArr = [];\n\n            if (val[0]) {\n              val[0].forEach(function (item) {\n                defrolesArr.push(item.roleCode);\n                defroleNamesArr.push(item.roleName);\n              });\n              this.$set(this.settingList[this.selectIndex], 'defroles', defrolesArr.join(\",\"));\n              this.$set(this.settingList[this.selectIndex], 'defroleNames', defroleNamesArr.join(\",\"));\n            } else {\n              this.$set(this.settingList[this.selectIndex], 'defroles', '');\n              this.$set(this.settingList[this.selectIndex], 'defroleNames', '');\n            }\n\n            break;\n          }\n\n        case 2:\n          {\n            var _defusersArr = [];\n            var _defuserNamesArr = [];\n\n            if (val[0]) {\n              val[0].forEach(function (item) {\n                _defusersArr.push(item.employeeCode);\n\n                _defuserNamesArr.push(item.employeeName);\n              });\n              this.$set(this.formData, 'readers', _defuserNamesArr.join(\",\"));\n            } else {\n              this.$set(this.formData, 'readers', _defuserNamesArr.join(\",\"));\n            }\n\n            break;\n          }\n      }\n    },\n    handleSelectP: function handleSelectP(row, index) {\n      if (row.assigneetype === '1') {\n        this.unMutiple = false;\n      } else {\n        this.unMutiple = true;\n      }\n\n      this.selectIndex = index;\n      this.$refs.perRef.dialogVisible = true;\n    },\n    handleSelectR: function handleSelectR(row, index) {\n      if (row.assigneetype === '1') {\n        this.unMutiple = false;\n      } else {\n        this.unMutiple = true;\n      }\n\n      this.selectIndex = index;\n      this.$refs.groupRef.dialogVisible = true;\n    },\n    selectReader: function selectReader() {\n      this.selectIndex = 2;\n      this.$refs.perRef1.dialogVisible = true;\n    }\n  }\n};",null]}