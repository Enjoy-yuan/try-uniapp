{"remainingRequest":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js!/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuan/Documents/大唐广电/dt-web/src/views/project/EAS/EL/equipmentRequisition/dialog/entryAccount.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuan/Documents/大唐广电/dt-web/src/views/project/EAS/EL/equipmentRequisition/dialog/entryAccount.vue","mtime":1596610933380},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuan/Documents/大唐广电/dt-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.match\";\nimport \"core-js/modules/es6.regexp.constructor\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport _objectSpread from \"/Users/yuan/Documents/\\u5927\\u5510\\u5E7F\\u7535/dt-web/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// import * as api from \"@/api/project/srm/dataBase/specialDistinction\"\nimport * as api from '@/api/project/eas/el/equipmentRequisition';\nimport { DICT_CODE } from '@/utils/constant';\nimport { mapState } from 'vuex';\nimport vendorMainSelect from '@/components/Select/vendorMainSelect.vue'; //厂家\n\nimport personSelect from '@/components/Select/personSelect.vue';\nimport { getDomainCode, getDomainCodeName } from '@/utils/auth';\nexport default {\n  components: {\n    vendorMainSelect: vendorMainSelect,\n    personSelect: personSelect\n  },\n  data: function data() {\n    return {\n      DICT_CODE: DICT_CODE,\n      temp: {\n        rowId: undefined,\n        acceptanceDate: undefined,\n        acceptorName: getDomainCodeName(),\n        acceptor: getDomainCode()\n      },\n      dialogStatus: '',\n      dialogVisible: false,\n      rules: {\n        deviceCodes: [{\n          required: true,\n          message: '设备编号不能为空',\n          trigger: 'blur'\n        }]\n      },\n      dialogVisibleVendorMain: false,\n      dialogVisiblePerson: false,\n      parentRows: [],\n      parentRowsperson: []\n    };\n  },\n  computed: _objectSpread({}, mapState({\n    dt_device_state: function dt_device_state(state) {\n      return state.eamDict.dt_device_state;\n    }\n  })),\n  mounted: function mounted() {\n    this.$store.dispatch('eamDict/getDicData', ['dt_device_state']);\n  },\n  methods: {\n    handleClose: function handleClose() {\n      this.resetTemp();\n      this.$refs.dataForm.resetFields();\n    },\n    //获取采购组织名称\n    selectName: function selectName(val) {\n      this.temp.purchaseOrgName = val;\n    },\n    handleEquipment: function handleEquipment() {\n      this.dialogVisibleVendorMain = true;\n    },\n    handleVendorMain: function handleVendorMain(val) {\n      this.parentRows = val;\n    },\n    confirmVendorMain: function confirmVendorMain() {\n      if (this.parentRows) {\n        this.$set(this.temp, 'manufacturersCode', this.parentRows.manufacturersCode);\n        this.$set(this.temp, 'manufacturersName', this.parentRows.manufacturersName);\n        this.dialogVisibleVendorMain = false;\n      } else {\n        this.$message({\n          title: '警告',\n          message: '请选择一条信息',\n          type: 'warning'\n        });\n      }\n    },\n    //请购人选择\n    handlePerson: function handlePerson() {\n      this.dialogVisiblePerson = true;\n    },\n    //请购人选择\n    person: function person(val) {\n      this.parentRowsperson = val;\n    },\n    //请购人确定\n    confirmPerson: function confirmPerson() {\n      if (this.parentRowsperson && this.parentRowsperson.length === 1) {\n        this.$set(this.temp, 'acceptor', this.parentRowsperson[0].employeeCode);\n        this.$set(this.temp, 'acceptorName', this.parentRowsperson[0].employeeName);\n        this.dialogVisiblePerson = false;\n      } else {\n        this.$message({\n          title: '警告',\n          message: '请选择一条信息',\n          type: 'warning'\n        });\n      }\n    },\n    //过滤标签\n    removeTAG: function removeTAG(str) {\n      var a = str.replace(/\\n/g, ',');\n      a = a.replace(new RegExp(',+', 'gm'), ','); // var reg = /,$/gi\n\n      return a.replace(/^,+/, '').replace(/,+$/, '');\n    },\n    createData: function createData() {\n      var _this = this;\n\n      this.$refs.dataForm.validate(function (valid) {\n        if (valid) {\n          var dto = {\n            acceptanceDate: _this.temp.acceptanceDate,\n            acceptor: _this.temp.acceptor,\n            acceptorName: _this.temp.acceptorName,\n            accountQuantity: parseInt(_this.temp.accountQuantity),\n            arrivalQuantity: _this.temp.arrivalQuantity,\n            category: _this.temp.category,\n            deviceCodes: _this.removeTAG(_this.temp.deviceCodes),\n            deviceName: _this.temp.deviceName,\n            manufacturersCode: _this.temp.manufacturersCode,\n            modelNumber: _this.temp.modelNumber,\n            state: _this.temp.stateSub,\n            typeCode: _this.temp.typeCode\n          };\n\n          if (dto.deviceCodes.match(/,/g) !== null) {\n            if (dto.deviceCodes.match(/,/g).length == dto.accountQuantity - 1) {\n              api.account(_this.temp.requisitionsOrderCode, _this.temp.rowNo, dto).then(function () {\n                _this.$message({\n                  title: '成功',\n                  message: '到货成功',\n                  type: 'success',\n                  duration: 2000\n                });\n\n                _this.dialogVisible = false;\n\n                _this.$emit('refresh');\n              });\n            } else {\n              _this.$message({\n                title: '警告',\n                message: '设备编号数量需与入台账数量一致',\n                type: 'warning'\n              });\n            }\n          } else {\n            if (dto.deviceCodes !== null && dto.deviceCodes !== '') {\n              api.account(_this.temp.requisitionsOrderCode, _this.temp.rowNo, dto).then(function () {\n                _this.$message({\n                  title: '成功',\n                  message: '到货成功',\n                  type: 'success',\n                  duration: 2000\n                });\n\n                _this.dialogVisible = false;\n\n                _this.$emit('refresh');\n              });\n            } else {\n              _this.$message({\n                title: '警告',\n                message: '设备编号不能为空，设备编号数量需与入台账数量一致',\n                type: 'warning'\n              });\n            }\n          }\n        } else {\n          return false;\n        }\n      });\n    },\n    updateData: function updateData() {// api.updateRecord(this.temp.rowId, this.temp).then(() => {\n      //     this.$message({\n      //         title: '成功',\n      //         message: '编辑成功',\n      //         type: 'success',\n      //         duration: 2000\n      //     })\n      //     this.dialogVisible = false\n      //     this.$emit('refresh')\n      // })\n    },\n    resetTemp: function resetTemp() {\n      this.temp = {\n        purchaseOrg: undefined,\n        distinctionCode: undefined,\n        distinctionName: undefined,\n        remark: undefined,\n        acceptanceDate: undefined,\n        acceptorName: getDomainCodeName(),\n        acceptor: getDomainCode()\n      };\n    }\n  }\n};",null]}